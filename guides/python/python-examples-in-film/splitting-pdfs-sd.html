<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-176158185-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176158185-1');
</script>

		<title>Splitting Large PDFs - S.D. Payslips | StarBase </title>
		<!-- link to website tab icon -->
		<link rel="shortcut icon" type="image/x-icon" href="/../docs/assets/images/alt-logo-star-tilted.png">
		<!-- link to Main Stylesheets -->
		<link rel="stylesheet" type="text/css" href="/../docs/assets/css/styles.css">
		<!-- link to Google Fonts -->
		<link href='https://fonts.googleapis.com/css?family=Zilla Slab' rel='stylesheet'>
		<link href="https://fonts.googleapis.com/css2?family=Marcellus&display=swap" rel="stylesheet"> 
		<link href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro&display=swap" rel="stylesheet"> 
		<link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@200..400&display=swap" rel="stylesheet">
		<!-- link to Font awesome -->
		<script src="https://kit.fontawesome.com/378306bc97.js" crossorigin="anonymous"></script>
		<!-- link to Material Icons -->
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<!-- link to Iconify CDN -->
		<script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
		<!-- link to UUID -->	
		<script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.1.0/uuidv5.min.js"></script>
	</head>
	<body>
		<a id="top"></a>
			<!-- Header Holder --> 

<div class="header-holder has-default-focus"
  
  >
    <div class="nav-bar">
        <!---->
        <a class="nav-bar-button has-padding-left-medium has-padding-left-none-tablet" href="https://sachin1882.wixsite.com/startechenterprises/guides" title="Go to parent site: StarTech Enterprises">
            <div class="nav-bar-logo has-background-image">
                <img src="https://fontmeme.com/permalink/200623/587d8aec23ed76c10e0b1ec43bc85f23.png" class="alt-logo has-background-image" width="180" height ="70">
                <div class="overlay">
                    <img src="/../docs/assets/images/starbase_logo.png" class="nav-bar-logo">
                </div>
            </div>
        </a>
        <nav class="nav-bar-nav">
            <ul class="nav-bar-nav-list">
                <li class="nav-bar-item is-category has-spacing">
                    <a class = "nav-bar-button title has-hover-underline is-6 
                    
                    
                    " href="/docs/">
                        <span>
                            <!---->
                            Docs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    underline
                    
                    " href="/docs/">
                        <span>
                            <!---->
                            Guides
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    
                    " href="/docs/articles-and-blogs/article-search.html">
                        <span>
                            <!---->
                            Articles & Blogs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/videos/">
                        <span>
                            <!---->
                            Videos
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    
                    " href="/docs/about/about.html">
                        <span>
                            <!---->
                            About
                            <!---->
                        </span>
                    </a>
                </li>
            </ul>
        </nav>
        <span class = "nav-bar-spacer i-hidden-mobile"></span>
        <!---->
    </div>
</div>


<div class="header-holder transparent has-default-focus" style="position: sticky; top: 0; left: 0; right: 0;">
    <div class="content-header uhf-container has-padding has-default-focus is-flexbox" style="padding-top: 0px; padding-bottom: 1px;">
        
<!-- Get correct Breadcrumb Links from Front Matter of loaded page-->

<!-- Liquid Code -->
    <!-- Page Root -->
    

    <!-- Page Type -->
    

    <!-- Page Category -->
    

    <!-- Page Series -->
    
<!-- / End of Liquid Code -->


<!-- Breadcrumb Links --> 
<nav class = "has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop has-flex-grow">
    <ul id="page-breadcrumbs" class="breadcrumbs">
        <li><a href="/docs/"><span class ="">Docs</span></a></li>
        <li><a href="/docs/"><span class ="">Guides</span></a></li>
        <li><a href="/docs/guides/python/python.html"><span class="">Python</span></a></li>
        <li><a href=/docs/guides/python/python-examples-in-film/python-intro.html><span class="">Python - Examples in Media & Entertainment</span></a></li>

        <!-- This part needs to be generated by JavaScript-->

    </ul>
</nav>
<!-- end of / Breadcrumb links -->




        <!-- Page Functions --> 

<div class="has-padding-none-tablet has-padding-medium is-size-7 is-flex-touch has-flex-justify-content-space-between-touch has-flex-grow">
    <ul class="is-hidden-mobile action-list has-flex-justify-content-end-tablet is-flex is-flex-row has-flex-wrap has-flex-grow is-unstyled">
        <li>
            <button class="print button is-text has-inner-focus is-small is-icon-only-touch colorfill" type="button" title="Print this page" onclick="window.print()">
                <span class="icon">
                    <span class="iconify extra-small" data-icon="el:print" data-inline="false"></span>                </span>
                <span class="is-visually-hidden-touch is-hidden-portrait">Print</span>
            </button>
        </li>
        <li>
            <button class="button is-text has-inner-focus is-small is-icon-only-touch colorfill" title="Send feedback about this page" onclick="location.href='#feedback'">
                <span class="icon">
                    <i class="fas fa-comments"></i>
                </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Feedback</span>
            </button>
        </li>
        <li id="share-menu-link">
            <div class = "sharing dropdown has-caret">
                <button class="dropdown-trigger button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small is-icon-only-touch colorfill" title="Share This Document">
                    <span class="icon">
                        <span class="iconify extra-small" data-icon="ls:share" data-inline="false"></span>
                    </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
                </button>
                <div id="sharing-menu" class="sharing-menu has-padding-small is-hidden">
                    <ul>
                        <li id="twitter-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-twitter" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-twitter colorfill"></i>
                                </span>
                                <span>Twitter</span>
                            </a>
                        </li>
                        <li id="linkedin-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-linkedin" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-linkedin-in colorfill"></i>
                                </span>
                                <span>LinkedIn</span>
                            </a>
                        </li>
                        <li id="facebook-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-facebook" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-facebook-f colorfill"></i>
                                </span>
                                <span>Facebook</span>
                            </a>
                        </li>
                        <li id="email-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-email" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fas fa-envelope colorfill"></i>
                                </span>
                                <span>Email</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </li>
    </ul>
</div>

<!-- end of / Page Functions -->
    </div>
    <div class="progress-container">
        <div class="progress-bar-scroll" id="myBar"></div>
    </div>
</div>

<!-- end of /.header-holder -->
			<!-- Main Container --> 
<div class="mainContainer uhf-container  has-top-padding ">
    <div class="columns has-large-gaps is-gapless-mobile ">

        
        <!-- Left Hand Side Tree-->
        <div class="left-sidebar column is-hidden-mobile 
         
        is-one-third-tablet is-one-quarter-desktop 
        ">
            <nav class ="is-fixed is-flex is-flex-column" id="affixed-left-sidebar">

                <!-- Include LHS Menu -->
                
                <form class = "has-margin-bottom-small" action="javascript:" role="search">
                    <label class="visually-hidden">Search</label>
                    <div class="searchFilter is-block">
                        <div class="control has-icons-left">
                            <input id="searchFilter" class="searchFilter-input input control has-icons-left is-full-width is-small" role="combobox" maxlength="100" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" placeholder="Filter by title" type="text">
                            <span class="icon is-small is-left">
                                <img src="/../docs/assets/images/filter.png" class="filter-icon">
                            </span>
                        </div>
                        <ul class="searchFilter-suggestions is-vertically-scrollable is-hidden"></ul>
                    </div>
                </form>

                <ul class="toc is-vertically-scrollable has-flex-grow has-flex-shrink">
                    <!-- Menu Series -->
                    
                    
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/python/python-examples-in-film/python-intro.html">Overview</a></li>
    
          
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Spliting Large PDFs</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/python/python-examples-in-film/splitting-pdfs-sd.html">S.D. Payslips</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Creating Folders</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/python/python-examples-in-film/folders-from-excel.html">From M.S. Excel</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Moving Files & Folders</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/python/python-examples-in-film/move-files-to-folders.html">Files into Folders</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
</ul>
                </ul>

                <!-- Include the Correct Back Button -->
                
            </nav>
        </div>
         <!-- end of /left hand side tree -->
        

        <!-- Primary Holder -->    
        <div class="primary-holder column 
          
        is-two-thirds-tablet is-three-quarters-desktop 
        ">
            <div class="columns has-large-gaps is-gapless-mobile 
            
            ">

                 <!-- Main Column -->
                <div id="main-column" class="column 
                 
                is-full is-four-fifths-desktop 
                ">
                    <main id="main" class ="
                    
                        content docs
                    " lang="eng-us">
                        <h1 id="splitting-large-pdfs---sd-payslips">Splitting Large PDFs - S.D. Payslips</h1>
<time class="metadata" style="text-alstyleign:left"> Guides • Python • 30/01/2022</time>

<h2 id="overview">Overview</h2>

<p>This particular example shows how a medium length Python Script can be used, together with the <strong><em>pyPDF2</em></strong> and <strong><em>pathlib</em></strong> libraries, to split a large PDF file you might have received, into smaller individual files.</p>

<p>The example shown below works on Payslip PDFs (specifically those from <em>Sargent Disc</em> - a small to medium sized payroll vendor that operates in the U.K. Film &amp; Entertainment space) - the kind of data files I used to work a lot with in a previous industry role.</p>

<p>As with all Scripts, it can be modified to suit your needs (that’s the great benefit of Scripting Languages - they are extremely flexible, and can be easily adapted to work with any particular system)</p>

<h2 id="python-script">Python Script</h2>

<p>The following shows the full script</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: Python">Python</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
import re, os
from pathlib import Path
from PyPDF2 import PdfFileReader, PdfFileWriter

# Specify Input and Output Locations
pdf_file_path = &#39;Payslips.pdf&#39;
file_base_name = pdf_file_path.replace(&#39;.pdf&#39;, &#39;&#39;)
working_directory = Path.cwd()
output_folder = Path(&#39;Output&#39;)
output_folder_path = working_directory / output_folder
pdf = PdfFileReader(pdf_file_path)

# Split Files
count = 0
for page_num in range(pdf.numPages):

    # Skip Parent Loop if needed
    if count &gt; 0:
        count -= count
        continue
         
    # Setup Objects &amp; Classes
    pdfWriter = PdfFileWriter()
    pageObj = pdf.getPage(page_num)
    pdfWriter.addPage(pageObj)

    # Search on Current Page
    Text = pageObj.extractText() 
    MatchedNameArray = re.findall(&quot;Name:[^0-9]+?\s&quot;, Text)
    MatchedName = (MatchedNameArray[0].replace(&#39;Name:&#39;, &#39;&#39;)).replace(&#39;\n&#39;, &#39;&#39;)
    MatchedEmpNoArray = re.findall(&quot;Emp.No:\w*&quot;, Text)
    if MatchedEmpNoArray:
        MatchedEmpNo = (MatchedEmpNoArray[0].replace(&#39;Emp.No:&#39;, &#39;&#39;)).replace(&#39;\n&#39;, &#39;&#39;)
    else:
        MatchedEmpNo = &#39;empty&#39;

    # Search on following Pages
    i = page_num + 1
    while i &lt; pdf.numPages:
        pageObjNext = pdf.getPage(i)
        TextNext = pageObjNext.extractText() 
        MatchedNameArrayNext = re.findall(&quot;Name:[^0-9]+?\s&quot;, TextNext)
        MatchedNameNext = (MatchedNameArrayNext[0].replace(&#39;Name:&#39;, &#39;&#39;)).replace(&#39;\n&#39;, &#39;&#39;)

        if MatchedName == MatchedNameNext:
            i += 1
            count += 1
            pdfWriter.addPage(pageObjNext)
        else:
            break

    # Split MatchedText on UpperCase
    res_pos = [j for j, e in enumerate(MatchedName+&#39;A&#39;) if e.isupper()]
    res_list = [MatchedName[res_pos[k]:res_pos[k + 1]] for k in range(len(res_pos)-1)]

    # Extract Firstname
    firstname = res_list[1]

    # Extract Surname
    surname = &#39;&#39;
    del res_list[0:2]
    if len(res_list) == 1:
        surname = surname + res_list[0]
    else:
        surname = surname + res_list[0]
        for l in (m+1 for m in range(len(res_list)-1)):
            if res_list[l-1][-1] == &quot;-&quot; or res_list[l-1][-1] == &quot;&#39;&quot; :
                surname = surname + res_list[l]
            else:
                surname = surname + &quot; &quot; + res_list[l]
 
    # Write PDF File
    with open(
        Path(output_folder_path / f&quot;{surname.upper()}, {firstname.upper()} ({MatchedEmpNo.upper()})&quot;), &#39;wb&#39;) as f:
        pdfWriter.write(f)
        f.close()

# Rename Files in Output Directory
files = os.listdir(str(output_folder_path))
for file in files:
    os.rename(os.path.join(str(output_folder_path), file), 
    os.path.join(str(output_folder_path), &#39;PAYSLIP - WE 25JAN 2022 - &#39; + file + &#39;.pdf&#39;))

">
  </button>
</div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">re</span><span class="p">,</span> <span class="n">os</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">PyPDF2</span> <span class="kn">import</span> <span class="n">PdfFileReader</span><span class="p">,</span> <span class="n">PdfFileWriter</span>

<span class="c1"># Specify Input and Output Locations
</span><span class="n">pdf_file_path</span> <span class="o">=</span> <span class="s">'Payslips.pdf'</span>
<span class="n">file_base_name</span> <span class="o">=</span> <span class="n">pdf_file_path</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'.pdf'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
<span class="n">working_directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">cwd</span><span class="p">()</span>
<span class="n">output_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s">'Output'</span><span class="p">)</span>
<span class="n">output_folder_path</span> <span class="o">=</span> <span class="n">working_directory</span> <span class="o">/</span> <span class="n">output_folder</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">PdfFileReader</span><span class="p">(</span><span class="n">pdf_file_path</span><span class="p">)</span>

<span class="c1"># Split Files
</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">page_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pdf</span><span class="p">.</span><span class="n">numPages</span><span class="p">):</span>

    <span class="c1"># Skip Parent Loop if needed
</span>    <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">count</span> <span class="o">-=</span> <span class="n">count</span>
        <span class="k">continue</span>
         
    <span class="c1"># Setup Objects &amp; Classes
</span>    <span class="n">pdfWriter</span> <span class="o">=</span> <span class="n">PdfFileWriter</span><span class="p">()</span>
    <span class="n">pageObj</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">.</span><span class="n">getPage</span><span class="p">(</span><span class="n">page_num</span><span class="p">)</span>
    <span class="n">pdfWriter</span><span class="p">.</span><span class="n">addPage</span><span class="p">(</span><span class="n">pageObj</span><span class="p">)</span>

    <span class="c1"># Search on Current Page
</span>    <span class="n">Text</span> <span class="o">=</span> <span class="n">pageObj</span><span class="p">.</span><span class="n">extractText</span><span class="p">()</span> 
    <span class="n">MatchedNameArray</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="s">"Name:[^0-9]+?\s"</span><span class="p">,</span> <span class="n">Text</span><span class="p">)</span>
    <span class="n">MatchedName</span> <span class="o">=</span> <span class="p">(</span><span class="n">MatchedNameArray</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">replace</span><span class="p">(</span><span class="s">'Name:'</span><span class="p">,</span> <span class="s">''</span><span class="p">)).</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
    <span class="n">MatchedEmpNoArray</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="s">"Emp.No:\w*"</span><span class="p">,</span> <span class="n">Text</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">MatchedEmpNoArray</span><span class="p">:</span>
        <span class="n">MatchedEmpNo</span> <span class="o">=</span> <span class="p">(</span><span class="n">MatchedEmpNoArray</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">replace</span><span class="p">(</span><span class="s">'Emp.No:'</span><span class="p">,</span> <span class="s">''</span><span class="p">)).</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">MatchedEmpNo</span> <span class="o">=</span> <span class="s">'empty'</span>

    <span class="c1"># Search on following Pages
</span>    <span class="n">i</span> <span class="o">=</span> <span class="n">page_num</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">pdf</span><span class="p">.</span><span class="n">numPages</span><span class="p">:</span>
        <span class="n">pageObjNext</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">.</span><span class="n">getPage</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">TextNext</span> <span class="o">=</span> <span class="n">pageObjNext</span><span class="p">.</span><span class="n">extractText</span><span class="p">()</span> 
        <span class="n">MatchedNameArrayNext</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="s">"Name:[^0-9]+?\s"</span><span class="p">,</span> <span class="n">TextNext</span><span class="p">)</span>
        <span class="n">MatchedNameNext</span> <span class="o">=</span> <span class="p">(</span><span class="n">MatchedNameArrayNext</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">replace</span><span class="p">(</span><span class="s">'Name:'</span><span class="p">,</span> <span class="s">''</span><span class="p">)).</span><span class="n">replace</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">MatchedName</span> <span class="o">==</span> <span class="n">MatchedNameNext</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">pdfWriter</span><span class="p">.</span><span class="n">addPage</span><span class="p">(</span><span class="n">pageObjNext</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c1"># Split MatchedText on UpperCase
</span>    <span class="n">res_pos</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">MatchedName</span><span class="o">+</span><span class="s">'A'</span><span class="p">)</span> <span class="k">if</span> <span class="n">e</span><span class="p">.</span><span class="n">isupper</span><span class="p">()]</span>
    <span class="n">res_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">MatchedName</span><span class="p">[</span><span class="n">res_pos</span><span class="p">[</span><span class="n">k</span><span class="p">]:</span><span class="n">res_pos</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res_pos</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>

    <span class="c1"># Extract Firstname
</span>    <span class="n">firstname</span> <span class="o">=</span> <span class="n">res_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Extract Surname
</span>    <span class="n">surname</span> <span class="o">=</span> <span class="s">''</span>
    <span class="k">del</span> <span class="n">res_list</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">surname</span> <span class="o">=</span> <span class="n">surname</span> <span class="o">+</span> <span class="n">res_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">surname</span> <span class="o">=</span> <span class="n">surname</span> <span class="o">+</span> <span class="n">res_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res_list</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">res_list</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">"-"</span> <span class="ow">or</span> <span class="n">res_list</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">"'"</span> <span class="p">:</span>
                <span class="n">surname</span> <span class="o">=</span> <span class="n">surname</span> <span class="o">+</span> <span class="n">res_list</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">surname</span> <span class="o">=</span> <span class="n">surname</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">res_list</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
 
    <span class="c1"># Write PDF File
</span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span>
        <span class="n">Path</span><span class="p">(</span><span class="n">output_folder_path</span> <span class="o">/</span> <span class="s">f"</span><span class="si">{</span><span class="n">surname</span><span class="p">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">firstname</span><span class="p">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s"> (</span><span class="si">{</span><span class="n">MatchedEmpNo</span><span class="p">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s">)"</span><span class="p">),</span> <span class="s">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">pdfWriter</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Rename Files in Output Directory
</span><span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">listdir</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_folder_path</span><span class="p">))</span>
<span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="n">os</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_folder_path</span><span class="p">),</span> <span class="nb">file</span><span class="p">),</span> 
    <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">output_folder_path</span><span class="p">),</span> <span class="s">'PAYSLIP - WE 25JAN 2022 - '</span> <span class="o">+</span> <span class="nb">file</span> <span class="o">+</span> <span class="s">'.pdf'</span><span class="p">))</span>

</code></pre></div></div>

<h2 id="how-to-use-it">How to Use it</h2>

<ul>
  <li>
    <p>The input file is called <em>Payslips.pdf</em>. This should be stored in the same folder as this script.</p>
  </li>
  <li>
    <p>The script can be given any meaningful name but should have a file extension <em>.py</em> to tell the operating system it is a Python Script</p>
  </li>
  <li>
    <p>The split PDFs are saved in a folder called <em>Output</em>. This folder should sit along side the input PDF file and python script, within the same working directory</p>
  </li>
  <li>
    <p>The name given to each new file saved can be modified by editing the last line of the Script</p>
  </li>
  <li>
    <p>The script can be run easily from any Python compiler on a Mac or Windows computer (<em>Visual Studio Code</em> is recommended!)</p>
  </li>
  <li>
    <p>The script takes less than 5 seconds to process 500 payslips!</p>
  </li>
</ul>

<div class="alert alert-info alerts-font" role="alert">
  <p><i class="fa fa-info-circle"></i> <b>Note: </b>
<br />
  Re-running the script will overwrite any files already in the <em>Output</em> folder with the same name, so don’t forget to clear out the folder everytime the script is run</p>
</div>

<h2 id="how-it-works">How it Works</h2>

<p>The script works by:</p>

<ul>
  <li>Scanning through each page of the input PDF file</li>
  <li>Then finding out when the name written after the ‘<em>Name:</em> ‘ field changes, from one page to another.</li>
  <li>When it does, it then extracts all the relevant pages upto that point into a PDF object</li>
  <li>The PDF object is then written out as a new PDF file and saved into the folder called ‘<em>Output</em>’.</li>
</ul>

<p>For example, if a name repeats across several pages in the input file, the Script will loop through each page, adding each page to the same PDF object, until the name on the page changes. When the name does changes, the PDF object is then written out and saved as a new PDF file, after which the process repeats.</p>

<ul>
  <li>Finally, the firstname and surname are intelligently extracted from the detected name, and automatically included in the filename of each new generated PDF.</li>
</ul>

<h2 id="bonus-feature">Bonus Feature!</h2>

<p>The script also extracts the Employee No. from each page (along with the firstname and surname). This is useful as on some productions, Crew Members can have the same name (it does happen on large Crews!), so including the Employee No. in the filename allows for better identification.</p>

<div class="alert alert-warning alerts-font" role="alert">
  <p><i class="fa fa-warning"></i> <b>Important: </b>
<br />
Unforunately not all Payslips have a Employee No. on them - (a bug Sargent Disc, presumably, are working to resolve…?). On pages where there is no Employee No., the word ‘<em>empty</em>’ is used instead as a replacement.</p>
</div>

<p>That’s really all there is to it!</p>

<h2 id="extensions">Extensions</h2>

<p>The basic methods and concepts illustrated here can be extended to any text readble PDF (e.g. <em>V.A.T. Invoices</em>, <em>Digital Timesheets</em>, <em>Purchase Orders</em>, <em>Contracts</em>, <em>Start Forms</em>, etc.)</p>

<p>Furthermore, Python also has libraries that can work with applications like <em>MS Excel</em>, and various <em>Email Clients</em>, so the above workflows can, with some effort, be extended out even further!</p>

<p>The sky is the limit!</p>


                        
                            <div id="mainNavBottom">
    <a class="no_icon" href="">
        <span id="previousPage" class="">
            <span class="iconify medium" data-icon="ic-sharp-arrow-back" data-inline="false"></span>
        </span>
    </a>
    <a class="no_icon" href="">
        <span id="nextPage" class="">
            <span class="iconify medium" data-icon="ic-sharp-arrow-forward" data-inline="false"></span>					
        </span>
    </a>
</div>
                        
                    </main>	
                    
                        <!-- Start of Feedback section -->
<section class="feedback-section is-relative">
    <h2 id="feedback" class="is-size-2 has-margin-top-large has-padding-top-medium"> Feedback </h2>
    <div class="feedback has-margin-top-small has-margin-bottom-none">
        <p id="send-feedback-about" class="has-margin-top-none has-margin-bottom-none">
            Submit and view feedback
        </p>
        <div id="feedback-section-link" class="has-margin-top-large has-margin-bottom-none">
            <a class="button has-margin-bottom-small" href="" target="_blank">
                <span class="icon">
                    <span class=github>
                        <i class="fab fa-github"></i>
                    </span>
                </span>
                <span>This page</span>
            </a>
        </div>
    </div>
    <div id="viewallfeedback-section-link" class="is-flex has-flex-justify-content-end has-margin-top-small has-margin-bottom-medium">
        <a class="view-on-github" href="" target="_blank">
            <span class="icon">
                <span class=github>
                    <i class="fab fa-github"></i>
                </span>
            </span><span>View all page feedback</span>
        </a>
    </div>
</section>

<!-- End of Feedback section -->
                    
                </div>

                
                 <!-- Right Hand Side Toc-->
                 <div class="right-sidebar column is-one-quarter is-one-fifth-desktop is-hidden-mobile is-hidden-tablet-only">
                    <nav class="doc-outline is-fixed is-vertically-scrollable", id="affixed-right-sidebar">
                        <nav id="side-doc-outline">
                            <header id="side-doc-title" class = "is-flex is-flex-row">
                                <div>
                                    <a href="#top">
                                        <h3 title="Go to Top of Page">
                                            <i class="fas fa-file-alt" style="color:#e82127;">&nbsp;</i>
                                            In this article
                                        </h3>
                                    </a>
                                </div>
                            </header>
                            <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#overview">Overview</a></li>
<li class="toc-entry toc-h2"><a href="#python-script">Python Script</a></li>
<li class="toc-entry toc-h2"><a href="#how-to-use-it">How to Use it</a></li>
<li class="toc-entry toc-h2"><a href="#how-it-works">How it Works</a></li>
<li class="toc-entry toc-h2"><a href="#bonus-feature">Bonus Feature!</a></li>
<li class="toc-entry toc-h2"><a href="#extensions">Extensions</a></li>
</ul>
                        </nav>

                        <!-- Fixed Element-->
                        <div>
                            <a class="top-link hide" href="" id="js-top" title="Go to Top of Page">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg>
                            </a>
                        </div>
                    </nav>
                </div>
                
            </div>
            <!-- end of /.columns -->
        </div>	
        <!-- end of /primary holder -->

    </div>
    <!-- end of /.columns -->
</div>
<!-- end of /.mainContainer -->
			<!-- Footer Container --> 
<div class="footerContainer">

    
    

    <footer id="footer" class=" footer-layout   uhf-container has-padding">
        <div class="">
            <a href="https://startech-enterprises.github.io/docs/">
                <img src="/../docs/assets/images/starbase_logo.png" class="footer-bar-logo">
            </a>
        </div>
        <div class="is-flex is-full-height has-padding-right-extra-large-desktop has-padding-left-extra-large-desktop">
            <a class="locale-selector-link has-flex-shrink-none" href="/../">
                <span class="icon">
                    <span><i class="fas fa-globe"></i></span>
                </span>
                <span class="locale-selector-link-text">English (United Kingdom)</span>
            </a>
        </div>
        <ul class="links">
            <li>
                <a href="/docs/">Docs</a>
            </li>
            <li>
                <a href="/docs/">Guides</a>
            </li>
            <li>
                <a href="/docs/articles-and-blogs/article-search.html">Articles & Blogs</a>
            </li>
            <li>
                <a href="/docs/videos/">Videos</a>
            </li>
            <li>
                <a href="/docs/about/about.html">About</a>
            </li>
            <li>
                <a href="https://www.linkedin.com/company/startech-enterprises/" target="_blank">LinkedIn</a>
            </li>
            <li style="color: #e82127;">
                <span class="icon">
                    <span> <i class="fas fa-star"></i></span>
                </span>Star Base 2020
            </li>
        </ul>
    </footer>
</div>
<!-- end of / footerContainer -->
	</body>
		<!-- Reference to main JavaScript Files -->
<script src="/../docs/assets/js/library.js" type="application/javascript"></script>
<script src="/../docs/assets/js/breadCrumb.js" type="application/javascript"></script>
<script src="/../docs/assets/js/navbar.js" type="application/javascript"></script>
<script src="/../docs/assets/js/affix.js" type="application/javascript"></script>
<script src="/../docs/assets/js/rhsToc.js" type="application/javascript"></script>


    <script src="/../docs/assets/js/lhsTree.js" type="application/javascript"></script>
    <script src="/../docs/assets/js/searchFilter.js" type="application/javascript"></script>


<script src="/../docs/assets/js/scrollTop.js" type="application/javascript"></script>
<script src="/../docs/assets/js/gitFeedback.js" type="application/javascript"></script>
<script src="/../docs/assets/js/copyCode.js" type="application/javascript"></script>
</html>
