<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-176158185-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176158185-1');
</script>

		<title>Building a Matrix with Asymmetrical Columns and Rows | StarBase </title>
		<!-- link to website tab icon -->
		<link rel="shortcut icon" type="image/x-icon" href="/../docs/assets/images/alt-logo-star-tilted.png" />
		<!-- link to Main Stylesheets -->
		<link rel="stylesheet" type="text/css" href="/../docs/assets/css/styles.css">
		<!-- link to Google Fonts -->
		<link href='https://fonts.googleapis.com/css?family=Zilla Slab' rel='stylesheet'>
		<link href="https://fonts.googleapis.com/css2?family=Marcellus&display=swap" rel="stylesheet"> 
		<link href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro&display=swap" rel="stylesheet"> 
		<link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@200..400&display=swap" rel="stylesheet"> 
		<!-- link to Font awesome -->
		<script src="https://kit.fontawesome.com/378306bc97.js" crossorigin="anonymous"></script>
		<!-- link to Material Icons -->
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<!-- link to Iconify CDN -->
		<script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
		<!-- link to UUID -->	
		<script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.1.0/uuidv5.min.js"></script>
	</head>
	<body>
		<a id="top"></a>
			<!-- Header Holder --> 

<div class="header-holder has-default-focus"
  
  >
    <div class="nav-bar">
        <!---->
        <a class="nav-bar-button has-padding-left-medium has-padding-left-none-tablet" href="https://sachin1882.wixsite.com/startechenterprises/guides" title="Go to parent site: StarTech Enterprises">
            <div class="nav-bar-logo has-background-image">
                <img src="https://fontmeme.com/permalink/200623/587d8aec23ed76c10e0b1ec43bc85f23.png" class="alt-logo has-background-image" width="180" height ="70">
                <div class="overlay">
                    <img src="/../docs/assets/images/starbase_logo.png" class="nav-bar-logo">
                </div>
            </div>
        </a>
        <nav class="nav-bar-nav">
            <ul class="nav-bar-nav-list">
                <li class="nav-bar-item is-category has-spacing">
                    <a class = "nav-bar-button title has-hover-underline is-6 
                    
                    
                    " href="/docs/">
                        <span>
                            <!---->
                            Docs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    underline
                    
                    " href="/docs/">
                        <span>
                            <!---->
                            Guides
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    
                    " href="/docs/articles-and-blogs/article-search.html">
                        <span>
                            <!---->
                            Articles & Blogs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/videos/">
                        <span>
                            <!---->
                            Videos
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    
                    " href="/docs/about/">
                        <span>
                            <!---->
                            About
                            <!---->
                        </span>
                    </a>
                </li>
            </ul>
        </nav>
        <span class = "nav-bar-spacer i-hidden-mobile"></span>
        <!---->
    </div>
</div>


<div class="header-holder transparent has-default-focus" style="position: sticky; top: 0; left: 0; right: 0;">
    <div class="content-header uhf-container has-padding has-default-focus is-flexbox" style="padding-top: 0px; padding-bottom: 1px;">
        
<!-- Get correct Breadcrumb Links from Front Matter of loaded page-->

<!-- Liquid Code -->
    <!-- Page Root -->
    

    <!-- Page Type -->
    

    <!-- Page Category -->
    

    <!-- Page Series -->
    
<!-- / End of Liquid Code -->


<!-- Breadcrumb Links --> 
<nav class = "has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop has-flex-grow">
    <ul id="page-breadcrumbs" class="breadcrumbs">
        <li><a href="/docs/"><span class ="">Docs</span></a></li>
        <li><a href="/docs/"><span class ="">Guides</span></a></li>
        <li><a href="/docs/guides/data-analytics/data-analytics.html"><span class="">Data Analytics</span></a></li>
        <li><a href=/docs/guides/data-analytics/data-analytics.html><span class="">DAX Samples</span></a></li>

        <!-- This part needs to be generated by JavaScript-->

    </ul>
</nav>
<!-- end of / Breadcrumb links -->




        <!-- Page Functions --> 

<div class="has-padding-none-tablet has-padding-medium is-size-7 is-flex-touch has-flex-justify-content-space-between-touch has-flex-grow">
    <ul class="is-hidden-mobile action-list has-flex-justify-content-end-tablet is-flex is-flex-row has-flex-wrap has-flex-grow is-unstyled">
        <li>
            <button class="print button is-text has-inner-focus is-small is-icon-only-touch colorfill" type="button" title="Print this page" onclick="window.print()">
                <span class="icon">
                    <span class="iconify extra-small" data-icon="el:print" data-inline="false"></span>                </span>
                <span class="is-visually-hidden-touch is-hidden-portrait">Print</span>
            </button>
        </li>
        <li>
            <button class="button is-text has-inner-focus is-small is-icon-only-touch colorfill" title="Send feedback about this page" onclick="location.href='#feedback'">
                <span class="icon">
                    <i class="fas fa-comments"></i>
                </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Feedback</span>
            </button>
        </li>
        <li id="share-menu-link">
            <div class = "sharing dropdown has-caret">
                <button class="dropdown-trigger button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small is-icon-only-touch colorfill" title="Share This Document">
                    <span class="icon">
                        <span class="iconify extra-small" data-icon="ls:share" data-inline="false"></span>
                    </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
                </button>
                <div id="sharing-menu" class="sharing-menu has-padding-small is-hidden">
                    <ul>
                        <li id="twitter-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-twitter" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-twitter colorfill"></i>
                                </span>
                                <span>Twitter</span>
                            </a>
                        </li>
                        <li id="linkedin-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-linkedin" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-linkedin-in colorfill"></i>
                                </span>
                                <span>LinkedIn</span>
                            </a>
                        </li>
                        <li id="facebook-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-facebook" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-facebook-f colorfill"></i>
                                </span>
                                <span>Facebook</span>
                            </a>
                        </li>
                        <li id="email-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-email" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fas fa-envelope colorfill"></i>
                                </span>
                                <span>Email</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </li>
    </ul>
</div>

<!-- end of / Page Functions -->
    </div>
    <div class="progress-container">
        <div class="progress-bar-scroll" id="myBar"></div>
    </div>
</div>

<!-- end of /.header-holder -->
			<!-- Main Container --> 
<div class="mainContainer uhf-container  has-top-padding ">
    <div class="columns has-large-gaps is-gapless-mobile ">

        
        <!-- Left Hand Side Tree-->
        <div class="left-sidebar column is-hidden-mobile 
         
        is-one-fifth-tablet is-one-seventh-desktop 
        ">
            <nav class ="is-fixed is-flex is-flex-column" id="affixed-left-sidebar">

                <!-- Include LHS Menu -->
                
                <a href="../data-analytics.html">
                    <span id="earlierPage" class="is-primary">
                        <span class="iconify medium" data-icon="ic-sharp-arrow-back" data-inline="false"></span>
                    </span>
                </a>
                
            </nav>
        </div>
         <!-- end of /left hand side tree -->
        

        <!-- Primary Holder -->    
        <div class="primary-holder column 
        
         is-four-fifths-tablet is-six-sevenths-desktop 
        ">
            <div class="columns has-large-gaps is-gapless-mobile 
            
            ">

                 <!-- Main Column -->
                <div id="main-column" class="column 
                 
                is-full is-four-fifths-desktop 
                ">
                    <main id="main" class ="
                    
                        content docs
                    " lang="eng-us">
                        <h1 id="building-a-matrix-with-asymmetrical-columns-and-rows">Building a Matrix with Asymmetrical Columns and Rows</h1>
<time class="metadata" style="text-alstyleign:left"> Guides • Data Analytics • 01/12/2020</time>

<div class="has-margin-top-medium">
  <p><a class="button is-small is-primary no_icon" href="https://1drv.ms/u/s!Ahu8OSSAtOMzmDsUjvP_Pq9SmIpU?e=bRtQQT" target="_blank">
    <span>
        Download Sample
    </span>
    <span class=" has-margin-left-small material-icons">
        cloud_download
    </span>
</a></p>
</div>

<!-- ************************************************ -->

<!-- The Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <div class="modal-header">
      <h4>Asymmetrical Visuals</h4>
      <p><span class="close">
×
</span></p>
    </div>
    <div class="modal-body">
      <!-- image inserted with JavaScript -->
    </div>
    <div class="modal-footer"></div>
  </div>
</div>

<!-- ************************************************ -->

<h2 id="overview">Overview</h2>

<p>This article explains the stand alone concept of how to build a visual with asymmetrical columns and rows in Power BI, using both standard DAX measures, and the more flexible, Calculation Groups.</p>

<h2 id="how-a-visual-works-by-default">How a Visual Works by Default</h2>

<figure>
    
        <img class="docimage" src="images/asymmetric-rows-columns-1.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<p>This matrix in the image above is built using the Adventure Works database. Category (#1), Sub Category (#2) and Year (#3) are <strong>all columns coming from dimension tables in the model</strong>. The values section of this matrix (the numbers) come from the measure <em>[Total Sales]</em>. Power BI is designed to work this way. <strong>You use Columns to slice and dice the data, and measures to do the calculations</strong>. The columns “filter” the data tables, then <strong>the measure is calculated on the data that remains after the filter is applied</strong>. The example above is a matrix, but it is exactly the same for pie charts, column charts, tree maps, etc.</p>

<h2 id="need-for-asymmetric-visuals">Need for Asymmetric Visuals</h2>

<p>Not every report you build may have simple layout requirements as in the one above. When using an Excel Pivot Table, there is a feature called “<em>Field, Items and Sets</em>” that makes the process of creating asymmetric pivot tables relatively easy, but this doesn’t exist in Power BI. To help better understand this, here is an example of an asymmetric visual (Power BI matrix in this case).</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('asymmetric-rows-columns-2.png');" src="images/asymmetric-rows-columns-2.png" alt="" style="width: 100%; max-width: 89%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i>Sales</i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>In the example above, the first 4 years come from the year column, just like before, but now there are 2 additional columns at the end of the matrix that are not simply the addition of the other columns. To create the last 2 columns above, Measures need to be written, but, currently, you can’t have both Measures and Columns from a model showing like this, in the same Power BI matrix. Rather, you need to build a solution that leverages a separate table to generate the columns needed, and then to generate the results you need in each column.</p>

<p>Below we understand how to build an asymmetric matrix like this.</p>

<h2 id="why-not-just-use-measures">Why Not Just Use Measures?</h2>

<p>Below is a simplified version of the concept being demonstrated (a combination of columns and measures on a visual).  If you needed a simple visual like the one above, it would of course be possible to write 6 measures and place them all in a single Matrix. This will produce the visual above. But there are many use-cases where that won’t work. For example, if you wanted to have a slicer like the one shown below instead of an asymmetric table. You can’t do that with just measures.</p>

<figure>
    
        <img class="docimage" src="images/asymmetric-rows-columns-3.png" alt="" style="width: 100%; max-width: 36.3%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<p>Also, if you wanted a collapsible header/sub header like shown on the rows of the matrix below, where the sales by year are additive and the variance numbers are grouped together, you can’t do that with just measures.</p>

<figure>
    
        <img class="docimage" src="images/asymmetric-rows-columns-4.png" alt="" style="width: 100%; max-width: 85.7%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<p>This is a simplified version of the header table technique that you can use when you can’t just use measures, for whatever reason. If you can solve your problem by simply using measures, then of course you can do that without this technique.</p>

<h2 id="overview-of-how-to-build-such-a-matrix">Overview of How to Build Such a Matrix</h2>

<p>Here is <strong>pseudo code</strong> table that conceptually explains what needs to be done to solve this problem.</p>

<figure>
    
        <img class="docimage" src="images/asymmetric-rows-columns-5.png" alt="" style="width: 100%; max-width: 59.3%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<p>Note that the first 4 rows (2017 – 2020) are just standard Power BI behaviours. You can do this just by dragging the year column and the <em>[Total Sales]</em> measure. But if you want the change in sales and % change in sale too, then you need to use a different approach from the standard method.</p>

<p>There are currently 2 ways to do this:</p>

<ol class="numbered-list">
  <li>SWITCH Measures with Header Tables (connected or disconnected)</li>
  <li>Calculation Groups</li>
</ol>

<p>Both approaches are covered in more detail below.</p>

<h2 id="1-switch-measures-with-header-tables">1. SWITCH Measures with Header Tables</h2>

<p>You can use a Header Table and a SWITCH measure to obtain the required results in a Matrix.</p>

<p><strong>Here are the steps:</strong></p>

<ul>
  <li>Create and load a Header table with the layout you want.</li>
  <li>Create a Relationship between the Header Table and the Calendar Table (if required).</li>
  <li>Write a SWITCH Measure to generate the result for each column item.</li>
  <li>Use the SWITCH Measure in your Report.</li>
</ul>

<h3 id="create-a-header-table">Create a Header Table</h3>

<ul>
  <li>
    <p>Create the following Header Table and name it <strong>HeaderTable</strong> in Excel. It has the following columns:</p>

    <ul>
      <li><strong>Display Name</strong> for the column headers of the Matrix</li>
      <li><strong>Sort Order</strong> that will be used in the SWITCH measure and also to control the sort order of the display value.</li>
    </ul>
  </li>
</ul>

<figure>
    
        <img class="docimage" src="images/asymmetric-rows-columns-6.png" alt="" style="width: 100%; max-width: 33%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<h3 id="load-the-header-table-into-power-bi">Load the Header Table into Power BI</h3>

<ul>
  <li>Load the <strong>HeaderTable</strong> from Excel workbook into a Power BI workbook.</li>
</ul>

<h3 id="create-a-relationship-between-the-header-table-and-calendar-table">Create a Relationship between the Header Table and Calendar Table</h3>

<ul>
  <li>Create a relationship between the HeaderTable and Calendar Table using the <em>Year</em> column from the Calendar table and <em>Display Name</em> from the HeaderTable.</li>
</ul>

<p>Note, the first 4 values in the <em>Display Name</em> column <strong>will find a match in the Calendar table</strong>. But the last 2 rows in that column <strong>will not match any record in the Calendar table</strong>. But that doesn’t matter because the SWITCH measure will leverage this relationship when it is useful (the first 4 rows) and it will override the relationship when it is not useful – explained further below.</p>

<p>Technically, this model is now a <strong>Snowflake Schema</strong> and this is a good example of a time when it is OK to step away from the recommended <strong>Star Schema</strong>.</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('asymmetric-rows-columns-7.png');" src="images/asymmetric-rows-columns-7.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<h3 id="write-a-switch-measure-to-generate-the-result">Write a SWITCH Measure to generate the result</h3>

<ul>
  <li>Next write the SWITCH measure that determines what result to display based on the displayed value:</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Values to Display =
   VAR DisplayItem = SELECTEDVALUE ( HeaderTable[Sort Order] )
   VAR Sales2020 = CALCULATE([Total Sales],all(HeaderTable),HeaderTable[Display Name]=&quot;2017&quot;)
   VAR Sales2019 = CALCULATE([Total Sales],all(HeaderTable),HeaderTable[Display Name]=&quot;2020&quot;)
   VAR Chg = Sales2020 - Sales2019
   VAR ChgPct = DIVIDE(Chg,Sales2019)

   RETURN
     SWITCH (
        TRUE (),
        DisplayItem &lt;= 4, [Total Sales],
        DisplayItem = 5, Chg,
        DisplayItem = 6, FORMAT(ChgPct,&quot;#.0%&quot;)
     )
">
  </button>
</div>
<pre><code class="language-DAX">Values to Display =
   VAR DisplayItem = SELECTEDVALUE ( HeaderTable[Sort Order] )
   VAR Sales2020 = CALCULATE([Total Sales],all(HeaderTable),HeaderTable[Display Name]="2017")
   VAR Sales2019 = CALCULATE([Total Sales],all(HeaderTable),HeaderTable[Display Name]="2020")
   VAR Chg = Sales2020 - Sales2019
   VAR ChgPct = DIVIDE(Chg,Sales2019)

   RETURN
     SWITCH (
        TRUE (),
        DisplayItem &lt;= 4, [Total Sales],
        DisplayItem = 5, Chg,
        DisplayItem = 6, FORMAT(ChgPct,"#.0%")
     )
</code></pre>

<p>In the measure the last display item (line 13) is formatted as a percentage using the <strong><em>FORMAT</em></strong> function. This is actually a text format and not a numeric format. The consequences of this are that you cannot use this technique in a chart of any kind, only visuals that simple display the numbers (or text in this case).</p>

<h3 id="use-the-switch-measure-in-your-report">Use the SWITCH Measure in your Report</h3>

<ul>
  <li>Next, create the matrix. Place the column <em>HeaderTable[Display Value]</em> (#1 below) on Columns and the SWITCH measure <em>[Values to Display]</em> (#2 below) on Values. The Display Value column has been sorted by the sort order column.</li>
</ul>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('asymmetric-rows-columns-8.png');" src="images/asymmetric-rows-columns-8.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>There are some blank rows in the matrix for <em>Lights</em>, and <em>Panniers</em>. This is caused by the format string mentioned above. When there are no sales, the percentage change will return <strong><em>BLANK( )</em></strong>. When the result is blank, it is hidden in the visual. The <strong><em>FORMAT</em></strong> function has the effect of turning that blank into an empty string. Empty strings are not hidden automatically, so that is why the blank line now appears. This can be fixed the following code modification.</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Values to Display =
   VAR DisplayItem = SELECTEDVALUE ( HeaderTable[Sort Order] )
   VAR Sales2020 = CALCULATE([Total Sales],all(HeaderTable),HeaderTable[Display Name]=&quot;2020&quot;)
   VAR Sales2019 = CALCULATE([Total Sales],all(HeaderTable),HeaderTable[Display Name]=&quot;2019&quot;)
   VAR Chg = Sales2020 - Sales2019
   VAR ChgPct = DIVIDE(Chg,Sales2019)

   RETURN
     SWITCH (
        TRUE (),
        DisplayItem &lt;= 4, [Total Sales],
        DisplayItem = 5, Chg,
        DisplayItem = 6, IF( ISBLANK(ChgPct), BLANK(), FORMAT(ChgPct,&quot;#.0%&quot;) )
     )
">
  </button>
</div>
<pre><code class="language-DAX">Values to Display =
   VAR DisplayItem = SELECTEDVALUE ( HeaderTable[Sort Order] )
   VAR Sales2020 = CALCULATE([Total Sales],all(HeaderTable),HeaderTable[Display Name]="2020")
   VAR Sales2019 = CALCULATE([Total Sales],all(HeaderTable),HeaderTable[Display Name]="2019")
   VAR Chg = Sales2020 - Sales2019
   VAR ChgPct = DIVIDE(Chg,Sales2019)

   RETURN
     SWITCH (
        TRUE (),
        DisplayItem &lt;= 4, [Total Sales],
        DisplayItem = 5, Chg,
        DisplayItem = 6, IF( ISBLANK(ChgPct), BLANK(), FORMAT(ChgPct,"#.0%") )
     )
</code></pre>

<p>Here, the single line of code inside the <strong><em>SWITCH</em></strong> essentially says “<strong>As long as it is one of the first 4 items, just give the normal result to [Total Sales]</strong>”. This effectively is leveraging the relationship between the header table and the calendar table for the first 4 items to do what it would do automatically without the header table.</p>

<h3 id="relationships-or-no-relationships">Relationships or No Relationships</h3>

<p>Technically, it is not a requirement to use a relationship with a header table. This was done in this case because 4 out of the 6 results can be simply extracted from the base model automatically. A relationship did not have to be created; instead, the 6 results could have been hardcoded directly into the SWITCH measure.</p>

<p>There are 2 disadvantages of this <strong><em>SWITCH</em></strong> Measure/Header Table approach, shown above:</p>

<ul>
  <li>Any formatting variations from the base measure must be formatted as Text as shown, with the implications that it can’t be used in a chart.</li>
  <li>One <strong><em>SWITCH</em></strong> measure has to be written for every base measure you want to do this with, e.g. <em>[Total Sales]</em>, <em>[Total Quantity]</em>, etc. (As an aside, you could do some tricky nesting of a second switch measure and another disconnected header table to control the input base measure if you wanted to, but we save that for another day).</li>
</ul>

<h2 id="2-calculation-groups">2. Calculation Groups</h2>

<p>The second, newer way to solve this problem is to use calculation groups. The main benefits of using calculation groups are:</p>

<ul>
  <li>You can vary the number formatting depending on the column.</li>
  <li>You can generalise it to work on any measure – not just [Total Sales].</li>
</ul>

<p>The main downside is (as of now), you have to use Tabular Editor (a third party external tool) to create the calculation group. But this is a great opportunity to learn how to do that!</p>

<p>Here are the steps to complete this task in Tabular Editor</p>

<ul>
  <li>Go to Tabular Editor</li>
  <li>Create a calculation group and name it, say, Sales Horizon</li>
  <li>Create calculation items in the calculation group</li>
  <li>Assign the ordinal values (sort order) for the calculation items</li>
  <li>Assign the format for each calculation item</li>
  <li>Save the model and switch back to Power BI Desktop</li>
  <li>Use the calculation group in your Report</li>
</ul>

<p>Below, we go through each of these steps.</p>

<h3 id="create-a-calculation-group">Create a Calculation Group</h3>

<ul>
  <li>Go to Tabular Editor. You can find the tables in the data model in the left panel under the Tables folder. Right-click on the Tables folder to create a new calculation group. Name it as Sales Horizon (#1 below).</li>
</ul>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('asymmetric-rows-columns-9.png');" src="images/asymmetric-rows-columns-9.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<h3 id="create-calculation-items-in-the-calculation-group">Create Calculation Items in the Calculation Group</h3>

<p>This is where you will create the calculation items as shown in the table below:</p>

<style>
table th {
  padding-top: 12px;
  padding-bottom: 12px;
  text-align: left;
  background-color: #e40707;
  color: white;
}
table th:first-of-type {
    width: 50%;
}
table th:nth-of-type(2) {
    width: 50%;
}
table tr:hover {background-color: #f5f5f5;}
table {
    width: 80% !important;
    margin-top: 0.5rem;
    padding: 1.2rem;
    -moz-border-radius: 5px !important;
    border-radius: 5px;
    transition-property: all;
    transition-duration: 120ms;
    transition-timing-function: linear;
    transition-delay: 0s;
    margin-left: 10%;
    margin-right: 10%;
}

table:hover{
    border-radius: 5px;
    -webkit-box-shadow:0 0px 24px 0 rgba(0,0,0,0.3);
    box-shadow:0 0px 24px 0 rgba(0,0,0,0.3);
}
</style>

<table>
  <thead>
    <tr>
      <th>Calculation Item</th>
      <th>Result Required</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2017</td>
      <td>Total Sales in 2017</td>
    </tr>
    <tr>
      <td>2018</td>
      <td>Total Sales in 2018</td>
    </tr>
    <tr>
      <td>2019</td>
      <td>Total Sales in 2019</td>
    </tr>
    <tr>
      <td>2020</td>
      <td>Total Sales in 2020</td>
    </tr>
    <tr>
      <td>Chg 2020 vs 2019</td>
      <td>Chg in Total Sales 2020 vs 2019</td>
    </tr>
    <tr>
      <td>% Chg</td>
      <td>% Chg</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>To do this, first create the calculation items, as follows (right click on the Sales Horizon “table” and select “new calculation item”. Call the first calculation item 2017 (#1 below) and write the DAX formula (#2 below).</li>
</ul>

<p>There are different ways you could write the DAX formula for this calculation item. For example, you could hardcode <em>[Total Sales]</em> instead of SELECTEDMEASURE(), but the latter allows a lot more flexibility in the use of this calculation group (explained later).</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('asymmetric-rows-columns-10.png');" src="images/asymmetric-rows-columns-10.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>Next, create the calculation items for 2018, 2019, and 2020 (#1 below) by simply copying 2017 and pasting it 3 times, then changing the name and the formula accordingly (#2 below).</li>
</ul>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('asymmetric-rows-columns-11.png');" src="images/asymmetric-rows-columns-11.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>Next, create the calculation item Chg 2020 vs 2019 as shown below. The reason you can see question marks next to the calculation items above is that the calculation group does not get validated by Power BI until it is saved. So click on the Save button. Click also on the DAX Formatter button to format the formulas.</li>
</ul>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('asymmetric-rows-columns-12.png');" src="images/asymmetric-rows-columns-12.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>The last calculation item required is the % Chg. The measure is shown below. The code from above can reused.</li>
</ul>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('asymmetric-rows-columns-13.png');" src="images/asymmetric-rows-columns-13.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<h3 id="assign-the-ordinal-values-for-the-calculation-items">Assign the Ordinal Values for the Calculation Items</h3>

<p>The ordinal values of the calculated items define the sort order of the values in the visual. The ordinal numbers start from 0.</p>

<ul>
  <li>Change the ordinal parameter for 2017 to 0 as shown below (#1 below).</li>
</ul>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('asymmetric-rows-columns-14.png');" src="images/asymmetric-rows-columns-14.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>Next change the ordinal numbers for 2018, 2019, 2020, Chg 2020 vs 2019, and % Chg to 1,2,3,4, and 5 respectively.</li>
</ul>

<h3 id="assign-the-format-for-each-calculation-item">Assign the Format for Each Calculation Item</h3>

<ul>
  <li>This is the last step in creating the calculation group and calculation items. It is possible to define the format of each calculation item separately as relevant. This is done in the property “Format String Expression” of the calculation item (#1 below). This has only been done for the last item in the list – the % Chg calculation. By not setting the format for the other items, the base measure formatting will be used instead.</li>
</ul>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('asymmetric-rows-columns-15.png');" src="images/asymmetric-rows-columns-15.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>Save the work in Tabular Editor and switched to Power BI Desktop. Power BI should prompt a message to refresh the calculation group  - click on the button Refresh Now.</li>
</ul>

<h3 id="using-the-calculation-group-in-a-report">Using the Calculation Group in a Report</h3>

<p>After creating a calculation group, you should find a new table called “<em>Sales Horizon</em>” in the data model as shown below:</p>

<figure>
    
        <img class="docimage" src="images/asymmetric-rows-columns-16.png" alt="" style="width: 100%; max-width: 89%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>

<p>As shown above, there is a column “<em>Name</em>” with the calculation items as values and the “<em>Ordinal</em>” column.</p>

<ul>
  <li>
    <p>To build the visual below, remove ‘<em>Calendar’[Year]</em> from columns in the visual and added <em>Sales Horizon[Name]</em>. Then, add the measure <em>[Total Quantity]</em> to values in the visual. The correct number format should display for the quantity columns and the % column.</p>
  </li>
  <li>
    <p>You can remove the <em>[Total Quantity]</em> measure and replace it with any other measure (such as <em>[Total Sales]</em>, <em>[Total Cost]</em>) and those will work too. This is the benefit of using SELECTEDMEASURE() in the calculation group vs hard coding one specific measure.</p>
  </li>
</ul>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('asymmetric-rows-columns-17.png');" src="images/asymmetric-rows-columns-17.png" alt="" style="width: 100%; max-width: 89%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i>Quantity</i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<h2 id="final-comments">Final Comments</h2>

<p>This article shows a simple example starting with 4 regular Column Values, followed by 2 calculations made from Measures. In reality you can do whatever you like, including more complex P&amp;Ls.</p>


                        
                        
                    </main>	
                    
                        <!-- Start of Feedback section -->
<section class="feedback-section is-relative">
    <h2 id="feedback" class="is-size-2 has-margin-top-large has-padding-top-medium"> Feedback </h2>
    <div class="feedback has-margin-top-small has-margin-bottom-none">
        <p id="send-feedback-about" class="has-margin-top-none has-margin-bottom-none">
            Submit and view feedback
        </p>
        <div id="feedback-section-link" class="has-margin-top-large has-margin-bottom-none">
            <a class="button has-margin-bottom-small" href="" target="_blank">
                <span class="icon">
                    <span class=github>
                        <i class="fab fa-github"></i>
                    </span>
                </span>
                <span>This page</span>
            </a>
        </div>
    </div>
    <div id="viewallfeedback-section-link" class="is-flex has-flex-justify-content-end has-margin-top-small has-margin-bottom-medium">
        <a class="view-on-github" href="" target="_blank">
            <span class="icon">
                <span class=github>
                    <i class="fab fa-github"></i>
                </span>
            </span><span>View all page feedback</span>
        </a>
    </div>
</section>

<!-- End of Feedback section -->
                    
                </div>

                
                 <!-- Right Hand Side Toc-->
                 <div class="right-sidebar column is-one-quarter is-one-fifth-desktop is-hidden-mobile is-hidden-tablet-only">
                    <nav class="doc-outline is-fixed is-vertically-scrollable", id="affixed-right-sidebar">
                        <nav id="side-doc-outline">
                            <header id="side-doc-title" class = "is-flex is-flex-row">
                                <div>
                                    <a href="#top">
                                        <h3 title="Go to Top of Page">
                                            <i class="fas fa-file-alt" style="color:#e82127;">&nbsp;</i>
                                            In this article
                                        </h3>
                                    </a>
                                </div>
                            </header>
                            <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#overview">Overview</a></li>
<li class="toc-entry toc-h2"><a href="#how-a-visual-works-by-default">How a Visual Works by Default</a></li>
<li class="toc-entry toc-h2"><a href="#need-for-asymmetric-visuals">Need for Asymmetric Visuals</a></li>
<li class="toc-entry toc-h2"><a href="#why-not-just-use-measures">Why Not Just Use Measures?</a></li>
<li class="toc-entry toc-h2"><a href="#overview-of-how-to-build-such-a-matrix">Overview of How to Build Such a Matrix</a></li>
<li class="toc-entry toc-h2"><a href="#1-switch-measures-with-header-tables">1. SWITCH Measures with Header Tables</a>
<ul>
<li class="toc-entry toc-h3"><a href="#create-a-header-table">Create a Header Table</a></li>
<li class="toc-entry toc-h3"><a href="#load-the-header-table-into-power-bi">Load the Header Table into Power BI</a></li>
<li class="toc-entry toc-h3"><a href="#create-a-relationship-between-the-header-table-and-calendar-table">Create a Relationship between the Header Table and Calendar Table</a></li>
<li class="toc-entry toc-h3"><a href="#write-a-switch-measure-to-generate-the-result">Write a SWITCH Measure to generate the result</a></li>
<li class="toc-entry toc-h3"><a href="#use-the-switch-measure-in-your-report">Use the SWITCH Measure in your Report</a></li>
<li class="toc-entry toc-h3"><a href="#relationships-or-no-relationships">Relationships or No Relationships</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#2-calculation-groups">2. Calculation Groups</a>
<ul>
<li class="toc-entry toc-h3"><a href="#create-a-calculation-group">Create a Calculation Group</a></li>
<li class="toc-entry toc-h3"><a href="#create-calculation-items-in-the-calculation-group">Create Calculation Items in the Calculation Group</a></li>
<li class="toc-entry toc-h3"><a href="#assign-the-ordinal-values-for-the-calculation-items">Assign the Ordinal Values for the Calculation Items</a></li>
<li class="toc-entry toc-h3"><a href="#assign-the-format-for-each-calculation-item">Assign the Format for Each Calculation Item</a></li>
<li class="toc-entry toc-h3"><a href="#using-the-calculation-group-in-a-report">Using the Calculation Group in a Report</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#final-comments">Final Comments</a></li>
</ul>
                        </nav>

                        <!-- Fixed Element-->
                        <div>
                            <a class="top-link hide" href="" id="js-top" title="Go to Top of Page">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg>
                            </a>
                        </div>
                    </nav>
                </div>
                
            </div>
            <!-- end of /.columns -->
        </div>	
        <!-- end of /primary holder -->

    </div>
    <!-- end of /.columns -->
</div>
<!-- end of /.mainContainer -->
			<!-- Footer Container --> 
<div class="footerContainer">

    
    

    <footer id="footer" class=" footer-layout   uhf-container has-padding">
        <div class="">
            <a href="https://startech-enterprises.github.io/docs/">
                <img src="/../docs/assets/images/starbase_logo.png" class="footer-bar-logo">
            </a>
        </div>
        <div class="is-flex is-full-height has-padding-right-extra-large-desktop has-padding-left-extra-large-desktop">
            <a class="locale-selector-link has-flex-shrink-none" href="/../">
                <span class="icon">
                    <span><i class="fas fa-globe"></i></span>
                </span>
                <span class="locale-selector-link-text">English (United Kingdom)</span>
            </a>
        </div>
        <ul class="links">
            <li>
                <a href="/docs/">Docs</a>
            </li>
            <li>
                <a href="/docs/">Guides</a>
            </li>
            <li>
                <a href="/docs/articles-and-blogs/article-search.html">Articles & Blogs</a>
            </li>
            <li>
                <a href="/docs/videos/">Videos</a>
            </li>
            <li>
                <a href="/docs/about/">About</a>
            </li>
            <li>
                <a href="https://www.linkedin.com/company/startech-enterprises/" target="_blank">LinkedIn</a>
            </li>
            <li style="color: #e82127;">
                <span class="icon">
                    <span> <i class="fas fa-star"></i></span>
                </span>Star Base 2020
            </li>
        </ul>
    </footer>
</div>
<!-- end of / footerContainer -->
	</body>
		<!-- Reference to main JavaScript Files -->
<script src="/../docs/assets/js/library.js" type="application/javascript"></script>
<script src="/../docs/assets/js/breadCrumb.js" type="application/javascript"></script>
<script src="/../docs/assets/js/navbar.js" type="application/javascript"></script>
<script src="/../docs/assets/js/affix.js" type="application/javascript"></script>
<script src="/../docs/assets/js/rhsToc.js" type="application/javascript"></script>




<script src="/../docs/assets/js/scrollTop.js" type="application/javascript"></script>
<script src="/../docs/assets/js/gitFeedback.js" type="application/javascript"></script>
<script src="/../docs/assets/js/copyCode.js" type="application/javascript"></script>
</html>
