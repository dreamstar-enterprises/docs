<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-176158185-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176158185-1');
</script>

		<title>HR - Metrics Report - Monthly Salaries, Pro-Rated Salaries, Average Salaries, Running Average Salaries, Total To Date Salaries, and Annual Compensation Ratios | StarBase </title>
		<!-- link to website tab icon -->
		<link rel="shortcut icon" type="image/x-icon" href="/../docs/assets/images/alt-logo-star-tilted.png">
		<!-- link to Main Stylesheets -->
		<link rel="stylesheet" type="text/css" href="/../docs/assets/css/styles.css">
		<!-- link to Google Fonts -->
		<link href='https://fonts.googleapis.com/css?family=Zilla Slab' rel='stylesheet'>
		<link href="https://fonts.googleapis.com/css2?family=Marcellus&display=swap" rel="stylesheet"> 
		<link href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro&display=swap" rel="stylesheet"> 
		<link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@200..400&display=swap" rel="stylesheet">
		<!-- link to Font awesome -->
		<script src="https://kit.fontawesome.com/378306bc97.js" crossorigin="anonymous"></script>
		<!-- link to Material Icons -->
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<!-- link to Iconify CDN -->
		<script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
		<!-- link to UUID -->	
		<script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.1.0/uuidv5.min.js"></script>
	</head>
	<body>
		<a id="top"></a>
			<!-- Header Holder --> 

<div class="header-holder has-default-focus"
  
  >
    <div class="nav-bar">
        <!---->
        <a class="nav-bar-button has-padding-left-medium has-padding-left-none-tablet" href="https://sachin1882.wixsite.com/startechenterprises/guides" title="Go to parent site: StarTech Enterprises">
            <div class="nav-bar-logo has-background-image">
                <img src="https://fontmeme.com/permalink/200623/587d8aec23ed76c10e0b1ec43bc85f23.png" class="alt-logo has-background-image" width="180" height ="70">
                <div class="overlay">
                    <img src="/../docs/assets/images/starbase_logo.png" class="nav-bar-logo">
                </div>
            </div>
        </a>
        <nav class="nav-bar-nav">
            <ul class="nav-bar-nav-list">
                <li class="nav-bar-item is-category has-spacing">
                    <a class = "nav-bar-button title has-hover-underline is-6 
                    
                    
                    " href="/docs/">
                        <span>
                            <!---->
                            Docs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    underline
                    
                    " href="/docs/">
                        <span>
                            <!---->
                            Guides
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    
                    " href="/docs/articles-and-blogs/article-search.html">
                        <span>
                            <!---->
                            Articles & Blogs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/videos/">
                        <span>
                            <!---->
                            Videos
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    
                    " href="/docs/about/about.html">
                        <span>
                            <!---->
                            About
                            <!---->
                        </span>
                    </a>
                </li>
            </ul>
        </nav>
        <span class = "nav-bar-spacer i-hidden-mobile"></span>
        <!---->
    </div>
</div>


<div class="header-holder transparent has-default-focus" style="position: sticky; top: 0; left: 0; right: 0;">
    <div class="content-header uhf-container has-padding has-default-focus is-flexbox" style="padding-top: 0px; padding-bottom: 1px;">
        
<!-- Get correct Breadcrumb Links from Front Matter of loaded page-->

<!-- Liquid Code -->
    <!-- Page Root -->
    

    <!-- Page Type -->
    

    <!-- Page Category -->
    

    <!-- Page Series -->
    
<!-- / End of Liquid Code -->


<!-- Breadcrumb Links --> 
<nav class = "has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop has-flex-grow">
    <ul id="page-breadcrumbs" class="breadcrumbs">
        <li><a href="/docs/"><span class ="">Docs</span></a></li>
        <li><a href="/docs/"><span class ="">Guides</span></a></li>
        <li><a href="/docs/guides/data-analytics/data-analytics.html"><span class="">Data Analytics</span></a></li>
        <li><a href=/docs/guides/data-analytics/data-analytics.html><span class="">DAX Samples</span></a></li>

        <!-- This part needs to be generated by JavaScript-->

    </ul>
</nav>
<!-- end of / Breadcrumb links -->




        <!-- Page Functions --> 

<div class="has-padding-none-tablet has-padding-medium is-size-7 is-flex-touch has-flex-justify-content-space-between-touch has-flex-grow">
    <ul class="is-hidden-mobile action-list has-flex-justify-content-end-tablet is-flex is-flex-row has-flex-wrap has-flex-grow is-unstyled">
        <li>
            <button class="print button is-text has-inner-focus is-small is-icon-only-touch colorfill" type="button" title="Print this page" onclick="window.print()">
                <span class="icon">
                    <span class="iconify extra-small" data-icon="el:print" data-inline="false"></span>                </span>
                <span class="is-visually-hidden-touch is-hidden-portrait">Print</span>
            </button>
        </li>
        <li>
            <button class="button is-text has-inner-focus is-small is-icon-only-touch colorfill" title="Send feedback about this page" onclick="location.href='#feedback'">
                <span class="icon">
                    <i class="fas fa-comments"></i>
                </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Feedback</span>
            </button>
        </li>
        <li id="share-menu-link">
            <div class = "sharing dropdown has-caret">
                <button class="dropdown-trigger button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small is-icon-only-touch colorfill" title="Share This Document">
                    <span class="icon">
                        <span class="iconify extra-small" data-icon="ls:share" data-inline="false"></span>
                    </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
                </button>
                <div id="sharing-menu" class="sharing-menu has-padding-small is-hidden">
                    <ul>
                        <li id="twitter-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-twitter" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-twitter colorfill"></i>
                                </span>
                                <span>Twitter</span>
                            </a>
                        </li>
                        <li id="linkedin-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-linkedin" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-linkedin-in colorfill"></i>
                                </span>
                                <span>LinkedIn</span>
                            </a>
                        </li>
                        <li id="facebook-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-facebook" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-facebook-f colorfill"></i>
                                </span>
                                <span>Facebook</span>
                            </a>
                        </li>
                        <li id="email-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-email" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fas fa-envelope colorfill"></i>
                                </span>
                                <span>Email</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </li>
    </ul>
</div>

<!-- end of / Page Functions -->
    </div>
    <div class="progress-container">
        <div class="progress-bar-scroll" id="myBar"></div>
    </div>
</div>

<!-- end of /.header-holder -->
			<!-- Main Container --> 
<div class="mainContainer uhf-container  has-top-padding ">
    <div class="columns has-large-gaps is-gapless-mobile ">

        
        <!-- Left Hand Side Tree-->
        <div class="left-sidebar column is-hidden-mobile 
         
        is-one-fifth-tablet is-one-seventh-desktop 
        ">
            <nav class ="is-fixed is-flex is-flex-column" id="affixed-left-sidebar">

                <!-- Include LHS Menu -->
                
                <a href="../data-analytics.html">
                    <span id="earlierPage" class="is-primary">
                        <span class="iconify medium" data-icon="ic-sharp-arrow-back" data-inline="false"></span>
                    </span>
                </a>
                
            </nav>
        </div>
         <!-- end of /left hand side tree -->
        

        <!-- Primary Holder -->    
        <div class="primary-holder column 
        
         is-four-fifths-tablet is-six-sevenths-desktop 
        ">
            <div class="columns has-large-gaps is-gapless-mobile 
            
            ">

                 <!-- Main Column -->
                <div id="main-column" class="column 
                 
                is-full is-four-fifths-desktop 
                ">
                    <main id="main" class ="
                    
                        content docs
                    " lang="eng-us">
                        <h1 id="hr---metrics-report---monthly-salaries-pro-rated-salaries-average-salaries-running-average-salaries-total-to-date-salaries-and-annual-compensation-ratios">HR - Metrics Report - Monthly Salaries, Pro-Rated Salaries, Average Salaries, Running Average Salaries, Total To Date Salaries, and Annual Compensation Ratios</h1>
<time class="metadata" style="text-alstyleign:left"> Guides • Data Analytics • 30/09/2020</time>

<div class="has-margin-top-medium">
  <p><a class="button is-small is-primary no_icon" href="https://1drv.ms/u/s!Ahu8OSSAtOMzlT1on9ZYOxaqcsYm?e=rWBhOs" target="_blank">
    <span>
        Download Sample
    </span>
    <span class=" has-margin-left-small material-icons">
        cloud_download
    </span>
</a></p>
</div>

<h2 id="hr---metrics-report-monthly-salaries-pro-rated-salaries-average-salaries-running-average-salaries-total-to-date-salaries-and-annual-compensation-ratios">HR - Metrics Report: Monthly Salaries, Pro-Rated Salaries, Average Salaries, Running Average Salaries, Total To Date Salaries, and Annual Compensation Ratios</h2>

<p>This sample takes the following salary and benchmarking data:…</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-metrics-report-salaries-1-data.png');" src="images/hr-metrics-report-salaries-1-data.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-metrics-report-salaries-2-data.png');" src="images/hr-metrics-report-salaries-2-data.png" alt="" style="width: 100%; max-width: 59.3%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<h3 id="hr-salary-metrics">HR Salary Metrics</h3>

<p>…and shows the following HR Salary metrics:</p>

<ol class="lower-roman">
  <li><strong>Actual Salaries</strong> paid: by <em>Job Grade</em>, by Month</li>
  <li><strong>Actual Salaries</strong> paid: by <em>Job Grade</em>, by <em>Full / Part time status</em> for a particular Month</li>
  <li><strong>Running Average Pro-Rated Salaries</strong> for a particular Month</li>
  <li><strong>Department Salaries</strong> as <strong>% of Total Salaries</strong>, each Month</li>
  <li><strong>Average Salaries of each Person</strong>: by <em>Department</em>, each Month</li>
  <li><strong>Average Salaries</strong> by <em>Department</em>, and <strong>Average Salaries</strong> by <em>Dept.</em> &amp; <em>Job Grade</em>, for a particular Month</li>
  <li><strong>Average Actual Salaries of each Person</strong>: by <em>Department, by *Gender</em>, for a particular Month</li>
  <li><strong>Average Pro-Rated Salaries of each Person</strong>: by <em>Department</em>, by <em>Gender</em>, for a particular Month</li>
  <li><strong>Average Actual Salaries of each Person</strong>: by <em>Age Group</em>, by <em>Gender</em>, for a particular Month</li>
  <li><strong>Average Pro-Rated Salaries of each Person</strong>: by <em>Age Group</em>, by <em>Gender</em>, for a particular Month</li>
  <li><strong>Total To Date Department Salaries</strong> as <strong>% of Total Salaries</strong>, each Month</li>
  <li><strong>Average of Running Average Actual Salaries</strong> for each Person: by <em>Department</em>, each Month</li>
  <li><strong>Average of Running Average Actual Salaries</strong> of each Person: by <em>Department</em>, by <em>Gender</em>, for a particular Month</li>
  <li><strong>Average of Running Average Pro-Rated Salaries</strong> of each Person: by <em>Department</em>, by <em>Gender</em>, for a particular Month</li>
  <li><strong>Average of Running Average Actual Salaries</strong> of each Person: by <em>Age Group</em>, by <em>Gender</em>, for a particular Month</li>
  <li><strong>Average of Running Average Pro-Rated Salaries</strong> of each Person: by <em>Age Group</em>, by <em>Gender</em>, for a particular Month</li>
  <li><strong>Annual Compensation Ratios</strong> of each Person: by <em>Gender</em>, each Month</li>
  <li><strong>Annual Compensation Ratios</strong> of each Person: by <em>Department</em>, each Month</li>
  <li><strong>Annual Compensation Ratios</strong> vs <strong>Annual FTE Salary</strong>, for each person, for a particular month: by <em>Gender</em></li>
  <li><strong>Annual Compensation Ratios</strong> vs <strong>Annual FTE Salary</strong>, for each person, for a particular month: by <em>Department</em></li>
</ol>

<p>Measures are also filterable by: <em>Office</em>, <em>Department</em>, <em>Job Grade</em>, <em>Full &amp; Part Time working status</em>, and <em>Month</em>.</p>

<h3 id="enhancements">Enhancements</h3>

<p>Similar to the salary example here: <em>DAX article:</em> <a href="../dax-samples/hr-salary-inventory-table.html"><strong>HR - Showing Employee Salaries &amp; analysing trends in Actual and Average Running (Pro-Rated) Salaries over time</strong></a>, enhancements to make the calculations in this report more accurate, include:</p>

<ul>
  <li>Ignoring the affect of Weekends in any day count calculations (e.g. when computing any <em>Weighted Average</em>, <em>Actual</em>, or <em>Pro-Rated</em> Salaries)</li>
  <li>Reducing any <strong>Weighted Average Salary</strong> calculations, in any given month, for any Working days not worked when at the same Job Grade. Working days not worked that fall in between Job Grades (e.g. due to Secondments), however, do not reduce this calculation</li>
  <li>The Weighted Average calculations for: (i) <strong>Annual Compensation Ratio</strong>, and (ii) <strong>Annual FTE Salary</strong>, are not affected by any days not worked. They depend only on the Days in Service worked in a particular month (which exclude Weekends)</li>
</ul>

<div class="alert alert-danger alerts-font" role="alert">
  <p><i class="fa fa-exclamation-circle"></i> <b>Warning: </b>
<br />
Public Holidays are not considered in this report. Only Weekends, which are assumed to fall on every Saturday, and Sunday.</p>
</div>

<h2 id="model-extensions">Model Extensions</h2>

<p>Possible extensions to this model, could include:</p>

<ul>
  <li>Adding ‘<strong><em>Freelance or Permanent</em></strong>’ as an extra field to distinguish between amounts paid to these different staff types</li>
  <li>Separating the calculations for <em>Freelancers</em> and <em>Permanent Staff</em> so that the <strong>Running Salary</strong> and <strong>Weighted Average Salary</strong> calculations only consider the time when a person was a <em>Freelancer</em>, or only when they were <em>Permanent Staff</em>, or both.</li>
  <li>Freelance records could be automatically linked and created from their agency Timesheet submissions.</li>
  <li>Consideration of Public Holidays</li>
</ul>

<h2 id="dashboard---snippet">Dashboard - Snippet</h2>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-metrics-report-salaries-1-db.png');" src="images/hr-metrics-report-salaries-1-db.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<!-- ************************************************ -->

<!-- Trigger/Open The Modal -->
<p><button id="modalBtn-2" onclick="window.open('https://app.powerbi.com/view?r=eyJrIjoiYTZiNzNiYjAtYzJhNS00ZDdlLTk5OWItZjA5ZDZjMzk1N2VmIiwidCI6ImE1MzNjNTc0LWNiYjMtNDBiNi04OGI4LTkzMDkyZjMyYzc0OSJ9','_blank')">Open interactive version - 10 pgs</button></p>

<!-- The Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <div class="modal-header">
      <h4>HR - Metrics Report: Monthly Salaries, Pro-Rated Salaries, Average Salaries, Running Average Salaries, Total To Date Salaries, and Annual Compensation Ratios</h4>
      <p><span class="close">
×
</span></p>
    </div>
    <div class="modal-body">
      <!-- image inserted with JavaScript -->
    </div>
    <div class="modal-footer"></div>
  </div>
</div>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-metrics-report-salaries-2-db.png');" src="images/hr-metrics-report-salaries-2-db.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-metrics-report-salaries-3-db.png');" src="images/hr-metrics-report-salaries-3-db.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-metrics-report-salaries-3b-db.png');" src="images/hr-metrics-report-salaries-3b-db.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-metrics-report-salaries-4-db.png');" src="images/hr-metrics-report-salaries-4-db.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-metrics-report-salaries-5-db.png');" src="images/hr-metrics-report-salaries-5-db.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-metrics-report-salaries-6-db.png');" src="images/hr-metrics-report-salaries-6-db.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-metrics-report-salaries-7-db.png');" src="images/hr-metrics-report-salaries-7-db.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-metrics-report-salaries-8-db.png');" src="images/hr-metrics-report-salaries-8-db.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-metrics-report-salaries-9-db.png');" src="images/hr-metrics-report-salaries-9-db.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-metrics-report-salaries-10-db.png');" src="images/hr-metrics-report-salaries-10-db.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<div class="alert alert-warning alerts-font" role="alert">
  <p><i class="fa fa-warning"></i> <b>Important: </b>
<br />
In this report, in order to show the correct results, most tables and charts have additional Page filters applied to them too. Click the red filter bar on the side of each page, to see which filters have been applied to each table and chart.</p>
</div>

<!-- ************************************************ -->

<h2 id="data-model---snippet">Data Model - Snippet</h2>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-metrics-report-salaries-1-dm.png');" src="images/hr-metrics-report-salaries-1-dm.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-metrics-report-salaries-2-dm.png');" src="images/hr-metrics-report-salaries-2-dm.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<h2 id="measures">Measures</h2>

<h3 id="average-comp-ratio-by-person-">Average Comp Ratio by Person %</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Average Comp Ratio by Person % = 
VAR AverageAnnualCompRatio =
    CALCULATE (
        AVERAGE ( &#39;Cross Joined Staff Table (DAX)&#39;[Weighted Annual Compensation Ratio] ),
        FILTER (
            &#39;Cross Joined Staff Table (DAX)&#39;,
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                = MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
        )
    )
RETURN
    IF (
        ISFILTERED ( &#39;Cross Joined Staff Table (DAX)&#39;[User ID] ),
        AverageAnnualCompRatio,
        AVERAGEX (
            SUMMARIZE (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month],
                &quot;Average Annual Comp Ratio&quot;,
                    CALCULATE (
                        AVERAGE ( &#39;Cross Joined Staff Table (DAX)&#39;[Weighted Annual Compensation Ratio] ),
                        FILTER (
                            &#39;Cross Joined Staff Table (DAX)&#39;,
                            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                                = MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                        )
                    )
            ),
            [Average Annual Comp Ratio]
        )
    )
">
  </button>
</div>
<pre><code class="language-DAX">Average Comp Ratio by Person % = 
VAR AverageAnnualCompRatio =
    CALCULATE (
        AVERAGE ( 'Cross Joined Staff Table (DAX)'[Weighted Annual Compensation Ratio] ),
        FILTER (
            'Cross Joined Staff Table (DAX)',
            'Cross Joined Staff Table (DAX)'[Start Date]
                = MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
        )
    )
RETURN
    IF (
        ISFILTERED ( 'Cross Joined Staff Table (DAX)'[User ID] ),
        AverageAnnualCompRatio,
        AVERAGEX (
            SUMMARIZE (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month],
                "Average Annual Comp Ratio",
                    CALCULATE (
                        AVERAGE ( 'Cross Joined Staff Table (DAX)'[Weighted Annual Compensation Ratio] ),
                        FILTER (
                            'Cross Joined Staff Table (DAX)',
                            'Cross Joined Staff Table (DAX)'[Start Date]
                                = MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                        )
                    )
            ),
            [Average Annual Comp Ratio]
        )
    )
</code></pre>

<h3 id="average-salary-by-person-actual-gbp">Average Salary by Person (Actual) GBP</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Average Salary by Person (Actual) GBP = 
AVERAGEX (
    SUMMARIZE (
        &#39;Cross Joined Staff Table (DAX)&#39;,
        &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
        &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
    ),
    CALCULATE ( SUM ( &#39;Cross Joined Staff Table (DAX)&#39;[Salary in Month GBP] ) )
)
">
  </button>
</div>
<pre><code class="language-DAX">Average Salary by Person (Actual) GBP = 
AVERAGEX (
    SUMMARIZE (
        'Cross Joined Staff Table (DAX)',
        'Cross Joined Staff Table (DAX)'[User ID],
        'Cross Joined Staff Table (DAX)'[Start of Month]
    ),
    CALCULATE ( SUM ( 'Cross Joined Staff Table (DAX)'[Salary in Month GBP] ) )
)
</code></pre>

<h3 id="average-salary-by-person-annual-fte-gbp">Average Salary by Person (Annual FTE) GBP</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Average Salary by Person (Annual FTE) GBP = 
VAR AverageAnnualFTESalary =
    CALCULATE (
        AVERAGE(&#39;Cross Joined Staff Table (DAX)&#39;[Weighted Annual FTE Salary]),
        FILTER (
            &#39;Cross Joined Staff Table (DAX)&#39;,
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                = MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
        )
    )
RETURN
    IF (
        ISFILTERED ( &#39;Cross Joined Staff Table (DAX)&#39;[User ID] ),
        AverageAnnualFTESalary,
        AVERAGEX (
            SUMMARIZE (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month],
                &quot;Average Annual FTE Salary&quot;,
                    CALCULATE (
                        AVERAGE(&#39;Cross Joined Staff Table (DAX)&#39;[Weighted Annual FTE Salary]),
                        FILTER (
                            &#39;Cross Joined Staff Table (DAX)&#39;,
                            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                                = MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                        )
                    )
            ),
            [Average Annual FTE Salary]
        )
    )
">
  </button>
</div>
<pre><code class="language-DAX">Average Salary by Person (Annual FTE) GBP = 
VAR AverageAnnualFTESalary =
    CALCULATE (
        AVERAGE('Cross Joined Staff Table (DAX)'[Weighted Annual FTE Salary]),
        FILTER (
            'Cross Joined Staff Table (DAX)',
            'Cross Joined Staff Table (DAX)'[Start Date]
                = MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
        )
    )
RETURN
    IF (
        ISFILTERED ( 'Cross Joined Staff Table (DAX)'[User ID] ),
        AverageAnnualFTESalary,
        AVERAGEX (
            SUMMARIZE (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month],
                "Average Annual FTE Salary",
                    CALCULATE (
                        AVERAGE('Cross Joined Staff Table (DAX)'[Weighted Annual FTE Salary]),
                        FILTER (
                            'Cross Joined Staff Table (DAX)',
                            'Cross Joined Staff Table (DAX)'[Start Date]
                                = MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                        )
                    )
            ),
            [Average Annual FTE Salary]
        )
    )
</code></pre>

<h3 id="average-salary-by-person-pro-rated-gbp">Average Salary by Person (Pro-Rated) GBP</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Average Salary by Person (Pro-Rated) GBP = 
VAR AverageMonthlySalary =
    CALCULATE (
        AVERAGE ( &#39;Cross Joined Staff Table (DAX)&#39;[Weighted Salary in Month GBP (Pro Rated)] ),
        FILTER (
            &#39;Cross Joined Staff Table (DAX)&#39;,
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                = MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
        )
    )
RETURN
    IF (
        ISFILTERED ( &#39;Cross Joined Staff Table (DAX)&#39;[User ID] ),
        AverageMonthlySalary,
        AVERAGEX (
            SUMMARIZE (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month],
                &quot;Average Monthly Salary&quot;,
                    CALCULATE (
                        AVERAGE ( &#39;Cross Joined Staff Table (DAX)&#39;[Weighted Salary in Month GBP (Pro Rated)] ),
                        FILTER (
                            &#39;Cross Joined Staff Table (DAX)&#39;,
                            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                                = MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                        )
                    )
            ),
            [Average Monthly Salary]
        )
    )
">
  </button>
</div>
<pre><code class="language-DAX">Average Salary by Person (Pro-Rated) GBP = 
VAR AverageMonthlySalary =
    CALCULATE (
        AVERAGE ( 'Cross Joined Staff Table (DAX)'[Weighted Salary in Month GBP (Pro Rated)] ),
        FILTER (
            'Cross Joined Staff Table (DAX)',
            'Cross Joined Staff Table (DAX)'[Start Date]
                = MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
        )
    )
RETURN
    IF (
        ISFILTERED ( 'Cross Joined Staff Table (DAX)'[User ID] ),
        AverageMonthlySalary,
        AVERAGEX (
            SUMMARIZE (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month],
                "Average Monthly Salary",
                    CALCULATE (
                        AVERAGE ( 'Cross Joined Staff Table (DAX)'[Weighted Salary in Month GBP (Pro Rated)] ),
                        FILTER (
                            'Cross Joined Staff Table (DAX)',
                            'Cross Joined Staff Table (DAX)'[Start Date]
                                = MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                        )
                    )
            ),
            [Average Monthly Salary]
        )
    )
</code></pre>

<h3 id="running-avg-salary-by-person-actual-gbp">Running Avg. Salary by Person (Actual) GBP</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Running Avg. Salary by Person (Actual) GBP = 
VAR RunningTotalMonthlySalary =
    CALCULATE (
        AVERAGE ( &#39;Cross Joined Staff Table (DAX)&#39;[Running Total Salary in Month GBP (Actual)] ),
        FILTER (
            &#39;Cross Joined Staff Table (DAX)&#39;,
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                = MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
        )
    )
VAR CountOfMonths =
    MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Count of Months with Salary] )
VAR RunningAverageMonthlySalary =
    DIVIDE ( RunningTotalMonthlySalary, CountOfMonths, BLANK () )
RETURN
    IF (
        ISFILTERED ( &#39;Cross Joined Staff Table (DAX)&#39;[User ID] ),
        RunningAverageMonthlySalary,
        AVERAGEX (
            SUMMARIZE (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month],
                &quot;Running Average Monthly Salary&quot;,
                    DIVIDE (
                        CALCULATE (
                            AVERAGE ( &#39;Cross Joined Staff Table (DAX)&#39;[Running Total Salary in Month GBP (Actual)] ),
                            FILTER (
                                &#39;Cross Joined Staff Table (DAX)&#39;,
                                &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                                    = MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                            )
                        ),
                        MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Count of Months with Salary] ),
                        BLANK ()
                    )
            ),
            [Running Average Monthly Salary]
        )
    )
">
  </button>
</div>
<pre><code class="language-DAX">Running Avg. Salary by Person (Actual) GBP = 
VAR RunningTotalMonthlySalary =
    CALCULATE (
        AVERAGE ( 'Cross Joined Staff Table (DAX)'[Running Total Salary in Month GBP (Actual)] ),
        FILTER (
            'Cross Joined Staff Table (DAX)',
            'Cross Joined Staff Table (DAX)'[Start Date]
                = MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
        )
    )
VAR CountOfMonths =
    MAX ( 'Cross Joined Staff Table (DAX)'[Count of Months with Salary] )
VAR RunningAverageMonthlySalary =
    DIVIDE ( RunningTotalMonthlySalary, CountOfMonths, BLANK () )
RETURN
    IF (
        ISFILTERED ( 'Cross Joined Staff Table (DAX)'[User ID] ),
        RunningAverageMonthlySalary,
        AVERAGEX (
            SUMMARIZE (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month],
                "Running Average Monthly Salary",
                    DIVIDE (
                        CALCULATE (
                            AVERAGE ( 'Cross Joined Staff Table (DAX)'[Running Total Salary in Month GBP (Actual)] ),
                            FILTER (
                                'Cross Joined Staff Table (DAX)',
                                'Cross Joined Staff Table (DAX)'[Start Date]
                                    = MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                            )
                        ),
                        MAX ( 'Cross Joined Staff Table (DAX)'[Count of Months with Salary] ),
                        BLANK ()
                    )
            ),
            [Running Average Monthly Salary]
        )
    )
</code></pre>

<h3 id="running-avg-salary-by-person-pro-rated-gbp">Running Avg. Salary by Person (Pro Rated) GBP</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Running Avg. Salary by Person (Pro Rated) GBP = 
VAR RunningAverageMonthlySalary =
    CALCULATE (
        AVERAGE ( &#39;Cross Joined Staff Table (DAX)&#39;[Running Average Salary in Month GBP] ),
        FILTER (
            &#39;Cross Joined Staff Table (DAX)&#39;,
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                = MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
        )
    )
RETURN
    IF (
        ISFILTERED ( &#39;Cross Joined Staff Table (DAX)&#39;[User ID] ),
        RunningAverageMonthlySalary,
        AVERAGEX (
            SUMMARIZE (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month],
                &quot;Running Average Monthly Salary&quot;,
                    CALCULATE (
                        AVERAGE ( &#39;Cross Joined Staff Table (DAX)&#39;[Running Average Salary in Month GBP] ),
                        FILTER (
                            &#39;Cross Joined Staff Table (DAX)&#39;,
                            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                                = MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                        )
                    )
            ),
            [Running Average Monthly Salary]
        )
    )
">
  </button>
</div>
<pre><code class="language-DAX">Running Avg. Salary by Person (Pro Rated) GBP = 
VAR RunningAverageMonthlySalary =
    CALCULATE (
        AVERAGE ( 'Cross Joined Staff Table (DAX)'[Running Average Salary in Month GBP] ),
        FILTER (
            'Cross Joined Staff Table (DAX)',
            'Cross Joined Staff Table (DAX)'[Start Date]
                = MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
        )
    )
RETURN
    IF (
        ISFILTERED ( 'Cross Joined Staff Table (DAX)'[User ID] ),
        RunningAverageMonthlySalary,
        AVERAGEX (
            SUMMARIZE (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month],
                "Running Average Monthly Salary",
                    CALCULATE (
                        AVERAGE ( 'Cross Joined Staff Table (DAX)'[Running Average Salary in Month GBP] ),
                        FILTER (
                            'Cross Joined Staff Table (DAX)',
                            'Cross Joined Staff Table (DAX)'[Start Date]
                                = MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                        )
                    )
            ),
            [Running Average Monthly Salary]
        )
    )
</code></pre>

<h3 id="salary-actual-gbp">Salary (Actual) GBP</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Salary (Actual) GBP = 
VAR MonthlySalaryGBP =
    CALCULATE ( SUM ( &#39;Cross Joined Staff Table (DAX)&#39;[Salary in Month GBP] ) )
RETURN
    IF ( MonthlySalaryGBP = 0, BLANK (), MonthlySalaryGBP )
">
  </button>
</div>
<pre><code class="language-DAX">Salary (Actual) GBP = 
VAR MonthlySalaryGBP =
    CALCULATE ( SUM ( 'Cross Joined Staff Table (DAX)'[Salary in Month GBP] ) )
RETURN
    IF ( MonthlySalaryGBP = 0, BLANK (), MonthlySalaryGBP )
</code></pre>

<h3 id="ttd-salary-actual-gbp">TTD Salary (Actual) GBP</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
TTD Salary (Actual) GBP = 
CALCULATE (
    SUM ( &#39;Cross Joined Staff Table (DAX)&#39;[Salary in Month GBP] ),
    FILTER (
        ALL ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] ),
        &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
            &lt;= MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
    ),
    FILTER (
        ALL ( &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month] ),
        &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
            &lt;= MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month] )
            &amp;&amp; MAX(&#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]) &lt;= TODAY ()
    )
)
">
  </button>
</div>
<pre><code class="language-DAX">TTD Salary (Actual) GBP = 
CALCULATE (
    SUM ( 'Cross Joined Staff Table (DAX)'[Salary in Month GBP] ),
    FILTER (
        ALL ( 'Cross Joined Staff Table (DAX)'[Start Date] ),
        'Cross Joined Staff Table (DAX)'[Start Date]
            &lt;= MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
    ),
    FILTER (
        ALL ( 'Cross Joined Staff Table (DAX)'[Start of Month] ),
        'Cross Joined Staff Table (DAX)'[Start of Month]
            &lt;= MAX ( 'Cross Joined Staff Table (DAX)'[Start of Month] )
            &amp;&amp; MAX('Cross Joined Staff Table (DAX)'[Start of Month]) &lt;= TODAY ()
    )
)
</code></pre>

<h3 id="today">Today</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Today = TODAY()
">
  </button>
</div>
<pre><code class="language-DAX">Today = TODAY()
</code></pre>

<h2 id="tables">Tables</h2>

<h3 id="calendar">Calendar</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Calendar = 
VAR MinDate =
    MIN ( Min_Date[Min_Date] )
VAR MaxDate =
    MAX ( Max_Date[Max_Date] )
RETURN
    CALENDAR ( EOMONTH ( MinDate, - 1 ) + 1, EOMONTH ( MaxDate, 0 ) )
">
  </button>
</div>
<pre><code class="language-DAX">Calendar = 
VAR MinDate =
    MIN ( Min_Date[Min_Date] )
VAR MaxDate =
    MAX ( Max_Date[Max_Date] )
RETURN
    CALENDAR ( EOMONTH ( MinDate, - 1 ) + 1, EOMONTH ( MaxDate, 0 ) )
</code></pre>

<h3 id="cross-joined-staff-table-dax">Cross Joined Staff Table (DAX)</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Cross Joined Staff Table (DAX) = 
CROSSJOIN(&#39;Monthly Calendar&#39;, Inventory_Salary_Table)
">
  </button>
</div>
<pre><code class="language-DAX">Cross Joined Staff Table (DAX) = 
CROSSJOIN('Monthly Calendar', Inventory_Salary_Table)
</code></pre>

<h2 id="calculated-columns">Calculated Columns</h2>

<h3 id="weekend">Weekend</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Weekend = 
SWITCH ( WEEKDAY ( [Date] ), 1, 1, 7, 1, 0 )
">
  </button>
</div>
<pre><code class="language-DAX">Weekend = 
SWITCH ( WEEKDAY ( [Date] ), 1, 1, 7, 1, 0 )
</code></pre>

<h3 id="age-years">Age (Years)</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Age (Years) = (TODAY() - &#39;Cross Joined Staff Table (DAX)&#39;[DoB] + 1) / 365.25
">
  </button>
</div>
<pre><code class="language-DAX">Age (Years) = (TODAY() - 'Cross Joined Staff Table (DAX)'[DoB] + 1) / 365.25
</code></pre>

<h3 id="age-group">Age Group</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Age Group = 
SWITCH (
    TRUE (),
    AND ( 0 &lt; [Age (Years)], [Age (Years)] &lt;= 25 ), &quot;0+ to 25&quot;,
    AND ( 25 &lt; [Age (Years)], [Age (Years)] &lt;= 30 ), &quot;25+ to 30&quot;,
    AND ( 30 &lt; [Age (Years)], [Age (Years)] &lt;= 35 ), &quot;30+ to 35&quot;,
    AND ( 35 &lt; [Age (Years)], [Age (Years)] &lt;= 40 ), &quot;35+ to 40&quot;,
    AND ( 40 &lt; [Age (Years)], [Age (Years)] &lt;= 45 ), &quot;40+ to 45&quot;,
    AND ( 45 &lt; [Age (Years)], [Age (Years)] &lt;= 50 ), &quot;45+ to 50&quot;,
    AND ( 50 &lt; [Age (Years)], [Age (Years)] &lt;= 55 ), &quot;50+ to 55&quot;,
    AND ( 55 &lt; [Age (Years)], [Age (Years)] &lt;= 60 ), &quot;55+ to 60&quot;,
    &quot;60+&quot;
)
">
  </button>
</div>
<pre><code class="language-DAX">Age Group = 
SWITCH (
    TRUE (),
    AND ( 0 &lt; [Age (Years)], [Age (Years)] &lt;= 25 ), "0+ to 25",
    AND ( 25 &lt; [Age (Years)], [Age (Years)] &lt;= 30 ), "25+ to 30",
    AND ( 30 &lt; [Age (Years)], [Age (Years)] &lt;= 35 ), "30+ to 35",
    AND ( 35 &lt; [Age (Years)], [Age (Years)] &lt;= 40 ), "35+ to 40",
    AND ( 40 &lt; [Age (Years)], [Age (Years)] &lt;= 45 ), "40+ to 45",
    AND ( 45 &lt; [Age (Years)], [Age (Years)] &lt;= 50 ), "45+ to 50",
    AND ( 50 &lt; [Age (Years)], [Age (Years)] &lt;= 55 ), "50+ to 55",
    AND ( 55 &lt; [Age (Years)], [Age (Years)] &lt;= 60 ), "55+ to 60",
    "60+"
)
</code></pre>

<h3 id="annual-compensation-ratio">Annual Compensation Ratio</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Annual Compensation Ratio = 
VAR CompRatio =
    DIVIDE (
        &#39;Cross Joined Staff Table (DAX)&#39;[FTE Salary GBP],
        &#39;Cross Joined Staff Table (DAX)&#39;[Benchmark Salary],
        BLANK ()
    )
RETURN
    IF (
        &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service in Month (excl W/E)] = 0,
        BLANK (),
        CompRatio
    )
">
  </button>
</div>
<pre><code class="language-DAX">Annual Compensation Ratio = 
VAR CompRatio =
    DIVIDE (
        'Cross Joined Staff Table (DAX)'[FTE Salary GBP],
        'Cross Joined Staff Table (DAX)'[Benchmark Salary],
        BLANK ()
    )
RETURN
    IF (
        'Cross Joined Staff Table (DAX)'[Days in Service in Month (excl W/E)] = 0,
        BLANK (),
        CompRatio
    )
</code></pre>

<h3 id="annual-salary-gbp">Annual Salary GBP</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Annual Salary GBP = 
&#39;Cross Joined Staff Table (DAX)&#39;[Ratio] * &#39;Cross Joined Staff Table (DAX)&#39;[FTE Salary GBP]
">
  </button>
</div>
<pre><code class="language-DAX">Annual Salary GBP = 
'Cross Joined Staff Table (DAX)'[Ratio] * 'Cross Joined Staff Table (DAX)'[FTE Salary GBP]
</code></pre>

<h3 id="benchmark-salary">Benchmark Salary</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Benchmark Salary = 
LOOKUPVALUE (
    Salary_Benchmark_Table[Benchmark Rate],
    Salary_Benchmark_Table[Start of Month], &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month],
    Salary_Benchmark_Table[Title], &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade]
)
">
  </button>
</div>
<pre><code class="language-DAX">Benchmark Salary = 
LOOKUPVALUE (
    Salary_Benchmark_Table[Benchmark Rate],
    Salary_Benchmark_Table[Start of Month], 'Cross Joined Staff Table (DAX)'[Start of Month],
    Salary_Benchmark_Table[Title], 'Cross Joined Staff Table (DAX)'[Job Grade]
)
</code></pre>

<h3 id="count-of-months-with-salary">Count of Months with Salary</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Count of Months with Salary = 
VAR CountofMonthswithSalary =
    CALCULATE (
        DISTINCTCOUNT ( &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month] ),
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID]
            ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
                &lt;= EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month] )
                &amp;&amp; &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service in Month (excl W/E)] &lt;&gt; 0
                &amp;&amp; &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                    &lt;= EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
        )
    )
RETURN
IF(&#39;Cross Joined Staff Table (DAX)&#39;[Days in Service (excl W/E)] = 0, BLANK(), CountofMonthswithSalary)
">
  </button>
</div>
<pre><code class="language-DAX">Count of Months with Salary = 
VAR CountofMonthswithSalary =
    CALCULATE (
        DISTINCTCOUNT ( 'Cross Joined Staff Table (DAX)'[Start of Month] ),
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID]
            ),
            'Cross Joined Staff Table (DAX)'[Start of Month]
                &lt;= EARLIER ( 'Cross Joined Staff Table (DAX)'[Start of Month] )
                &amp;&amp; 'Cross Joined Staff Table (DAX)'[Days in Service in Month (excl W/E)] &lt;&gt; 0
                &amp;&amp; 'Cross Joined Staff Table (DAX)'[Start Date]
                    &lt;= EARLIER ( 'Cross Joined Staff Table (DAX)'[Start Date] )
        )
    )
RETURN
IF('Cross Joined Staff Table (DAX)'[Days in Service (excl W/E)] = 0, BLANK(), CountofMonthswithSalary)
</code></pre>

<h3 id="days-in-service-excl-we">Days in Service (excl W/E)</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Days in Service (excl W/E) = 
VAR StartDate = [Start Date]
VAR EndDate =
    IF ( ISBLANK ( [End Date] ), TODAY (), [End Date] )
RETURN
    IF (
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] ) &lt; StartDate,
        BLANK (),
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] ) - StartDate + 1 - [Weekend Days in Service]
    )
">
  </button>
</div>
<pre><code class="language-DAX">Days in Service (excl W/E) = 
VAR StartDate = [Start Date]
VAR EndDate =
    IF ( ISBLANK ( [End Date] ), TODAY (), [End Date] )
RETURN
    IF (
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] ) &lt; StartDate,
        BLANK (),
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] ) - StartDate + 1 - [Weekend Days in Service]
    )
</code></pre>

<h3 id="days-in-service-in-month-excl-we">Days in Service in Month (excl W/E)</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Days in Service in Month (excl W/E) = 
VAR StartDate =
    MAX ( [Start Date], [Start of Month] )
VAR EndDate =
    IF ( ISBLANK ( [End Date] ), TODAY (), [End Date] )
RETURN
    IF (
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] ) &lt; StartDate,
        BLANK (),
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] ) - StartDate + 1 - [Weekend Days in Service in Month]
    )
">
  </button>
</div>
<pre><code class="language-DAX">Days in Service in Month (excl W/E) = 
VAR StartDate =
    MAX ( [Start Date], [Start of Month] )
VAR EndDate =
    IF ( ISBLANK ( [End Date] ), TODAY (), [End Date] )
RETURN
    IF (
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] ) &lt; StartDate,
        BLANK (),
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] ) - StartDate + 1 - [Weekend Days in Service in Month]
    )
</code></pre>

<h3 id="end-date-fill">End Date Fill</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
End Date Fill = 
IF ( ISBLANK ( [End Date] ), 2958100, [End Date] )
">
  </button>
</div>
<pre><code class="language-DAX">End Date Fill = 
IF ( ISBLANK ( [End Date] ), 2958100, [End Date] )
</code></pre>

<h3 id="external-join">External Join</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
External Join = 
IF(([Start Date] - [Previous End Date]) &gt; 30, &quot;Y&quot;, &quot;N&quot;)
">
  </button>
</div>
<pre><code class="language-DAX">External Join = 
IF(([Start Date] - [Previous End Date]) &gt; 30, "Y", "N")
</code></pre>

<h3 id="external-leave">External Leave</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
External Leave = 
IF(([Next Start Date] - [End Date Fill]) &gt; 30, &quot;Y&quot;, &quot;N&quot;)
">
  </button>
</div>
<pre><code class="language-DAX">External Leave = 
IF(([Next Start Date] - [End Date Fill]) &gt; 30, "Y", "N")
</code></pre>

<h3 id="internal-join">Internal Join</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Internal Join = 
IF([External Join] = &quot;Y&quot;, &quot;N&quot;, &quot;Y&quot;)
">
  </button>
</div>
<pre><code class="language-DAX">Internal Join = 
IF([External Join] = "Y", "N", "Y")
</code></pre>

<h3 id="internal-leave">Internal Leave</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Internal Leave = 
IF([External Leave] = &quot;Y&quot;, &quot;N&quot;, &quot;Y&quot;)
">
  </button>
</div>
<pre><code class="language-DAX">Internal Leave = 
IF([External Leave] = "Y", "N", "Y")
</code></pre>

<h3 id="left-in-month-">Left in Month ?</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Left in Month ? = 
IF (
    AND ( [End Date Fill] &gt;= [Start of Month], [End Date Fill] &lt;= [End of Month] ),
    &quot;Y&quot;,
    &quot;N&quot;
)
">
  </button>
</div>
<pre><code class="language-DAX">Left in Month ? = 
IF (
    AND ( [End Date Fill] &gt;= [Start of Month], [End Date Fill] &lt;= [End of Month] ),
    "Y",
    "N"
)
</code></pre>

<h3 id="next-start-date">Next Start Date</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Next Start Date =
IF (
    ISBLANK (
        CALCULATE (
            MIN ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] ),
            FILTER (
                ALLEXCEPT (
                    &#39;Cross Joined Staff Table (DAX)&#39;,
                    &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                    &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
                ),
                &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                    &gt; EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
            )
        )
    ),
    2958465,
    CALCULATE (
        MIN ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] ),
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
            ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                &gt; EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
        )
    )
)
">
  </button>
</div>
<pre><code class="language-DAX">Next Start Date =
IF (
    ISBLANK (
        CALCULATE (
            MIN ( 'Cross Joined Staff Table (DAX)'[Start Date] ),
            FILTER (
                ALLEXCEPT (
                    'Cross Joined Staff Table (DAX)',
                    'Cross Joined Staff Table (DAX)'[User ID],
                    'Cross Joined Staff Table (DAX)'[Start of Month]
                ),
                'Cross Joined Staff Table (DAX)'[Start Date]
                    &gt; EARLIER ( 'Cross Joined Staff Table (DAX)'[Start Date] )
            )
        )
    ),
    2958465,
    CALCULATE (
        MIN ( 'Cross Joined Staff Table (DAX)'[Start Date] ),
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month]
            ),
            'Cross Joined Staff Table (DAX)'[Start Date]
                &gt; EARLIER ( 'Cross Joined Staff Table (DAX)'[Start Date] )
        )
    )
)
</code></pre>

<h3 id="part-of-headcount-at-end-of-month">Part of HeadCount at End of Month</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Part of HeadCount at End of Month = 
IF (
    AND ( [Start Date] &lt;= [End of Month], [End Date Fill] &gt; [End of Month] ),
    &quot;Y&quot;,
    &quot;N&quot;
)
">
  </button>
</div>
<pre><code class="language-DAX">Part of HeadCount at End of Month = 
IF (
    AND ( [Start Date] &lt;= [End of Month], [End Date Fill] &gt; [End of Month] ),
    "Y",
    "N"
)
</code></pre>

<h3 id="part-of-headcount-at-start-of-month">Part of HeadCount at Start of Month</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Part of HeadCount at Start of Month = 
IF (
    AND ( [Start Date] &lt; [Start of Month], [End Date Fill] &gt;= [Start of Month] ),
    &quot;Y&quot;,
    &quot;N&quot;
)
">
  </button>
</div>
<pre><code class="language-DAX">Part of HeadCount at Start of Month = 
IF (
    AND ( [Start Date] &lt; [Start of Month], [End Date Fill] &gt;= [Start of Month] ),
    "Y",
    "N"
)
</code></pre>

<h3 id="part-of-headcount-start-or-end-of-month">Part of HeadCount Start or End of Month</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Part of HeadCount Start or End of Month = 
IF (
    OR (
        [Part of HeadCount at Start of Month] = &quot;Y&quot;,
        [Part of HeadCount at End of Month] = &quot;Y&quot;
    ),
    &quot;Y&quot;,
    &quot;N&quot;
)
">
  </button>
</div>
<pre><code class="language-DAX">Part of HeadCount Start or End of Month = 
IF (
    OR (
        [Part of HeadCount at Start of Month] = "Y",
        [Part of HeadCount at End of Month] = "Y"
    ),
    "Y",
    "N"
)
</code></pre>

<h3 id="previous-end-date">Previous End Date</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Previous End Date = 
IF (
    ISBLANK (
        CALCULATE (
            MAX ( [End Date Fill] ),
            FILTER (
                ALLEXCEPT (
                    &#39;Cross Joined Staff Table (DAX)&#39;,
                    &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                    &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
                ),
                [End Date Fill] &lt; EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[End Date Fill] )
            )
        )
    ),
    0,
    CALCULATE (
        MAX ( [End Date Fill] ),
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
            ),
            [End Date Fill] &lt; EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[End Date Fill] )
        )
    )
)
">
  </button>
</div>
<pre><code class="language-DAX">Previous End Date = 
IF (
    ISBLANK (
        CALCULATE (
            MAX ( [End Date Fill] ),
            FILTER (
                ALLEXCEPT (
                    'Cross Joined Staff Table (DAX)',
                    'Cross Joined Staff Table (DAX)'[User ID],
                    'Cross Joined Staff Table (DAX)'[Start of Month]
                ),
                [End Date Fill] &lt; EARLIER ( 'Cross Joined Staff Table (DAX)'[End Date Fill] )
            )
        )
    ),
    0,
    CALCULATE (
        MAX ( [End Date Fill] ),
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month]
            ),
            [End Date Fill] &lt; EARLIER ( 'Cross Joined Staff Table (DAX)'[End Date Fill] )
        )
    )
)
</code></pre>

<h3 id="running-average-salary-in-month-gbp">Running Average Salary in Month GBP</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Running Average Salary in Month GBP = 
DIVIDE (
    &#39;Cross Joined Staff Table (DAX)&#39;[Running Total Salary in Month GBP (Pro Rated)],
    &#39;Cross Joined Staff Table (DAX)&#39;[Count of Months with Salary],
    0
)
">
  </button>
</div>
<pre><code class="language-DAX">Running Average Salary in Month GBP = 
DIVIDE (
    'Cross Joined Staff Table (DAX)'[Running Total Salary in Month GBP (Pro Rated)],
    'Cross Joined Staff Table (DAX)'[Count of Months with Salary],
    0
)
</code></pre>

<h3 id="running-total-salary-in-month-gbp-actual">Running Total Salary in Month GBP (Actual)</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Running Total Salary in Month GBP (Actual) = 
VAR RunningTotalSalary =
    CALCULATE (
        SUM ( &#39;Cross Joined Staff Table (DAX)&#39;[Salary in Month GBP] ),
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID]
            ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
                &lt;= EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month] )
                &amp;&amp; &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                    &lt;= EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                &amp;&amp; &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service in Month (excl W/E)] &lt;&gt; 0
        )
    )
RETURN
    IF (
        &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service (excl W/E)] = 0,
        BLANK (),
        RunningTotalSalary
    )
">
  </button>
</div>
<pre><code class="language-DAX">Running Total Salary in Month GBP (Actual) = 
VAR RunningTotalSalary =
    CALCULATE (
        SUM ( 'Cross Joined Staff Table (DAX)'[Salary in Month GBP] ),
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID]
            ),
            'Cross Joined Staff Table (DAX)'[Start of Month]
                &lt;= EARLIER ( 'Cross Joined Staff Table (DAX)'[Start of Month] )
                &amp;&amp; 'Cross Joined Staff Table (DAX)'[Start Date]
                    &lt;= EARLIER ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                &amp;&amp; 'Cross Joined Staff Table (DAX)'[Days in Service in Month (excl W/E)] &lt;&gt; 0
        )
    )
RETURN
    IF (
        'Cross Joined Staff Table (DAX)'[Days in Service (excl W/E)] = 0,
        BLANK (),
        RunningTotalSalary
    )
</code></pre>

<h3 id="running-total-salary-in-month-gbp-pro-rated">Running Total Salary in Month GBP (Pro Rated)</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Running Total Salary in Month GBP (Pro Rated) = 
VAR FilteredTable =
    CALCULATETABLE (
        &#39;Cross Joined Staff Table (DAX)&#39;,
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID]
            ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
                &lt; EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month] )
                &amp;&amp; &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                    &lt;= EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                &amp;&amp; &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service in Month (excl W/E)] &lt;&gt; 0
        )
    )
VAR RunningTotalSalaryinMonth =
    SUMX (
        SUMMARIZE (
            FilteredTable,
            &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
            &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month],
            &quot;ValueMaxDate&quot;,
                CALCULATE (
                    AVERAGE ( &#39;Cross Joined Staff Table (DAX)&#39;[Weighted Salary in Month GBP (Pro Rated)] ),
                    FILTER (
                        &#39;Cross Joined Staff Table (DAX)&#39;,
                        &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                            = MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                    )
                )
        ),
        [ValueMaxDate]
    )
RETURN
    IF (
        &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service (excl W/E)] = 0,
        BLANK (),
        RunningTotalSalaryinMonth + &#39;Cross Joined Staff Table (DAX)&#39;[Weighted Salary in Month GBP (Pro Rated)]
    )
">
  </button>
</div>
<pre><code class="language-DAX">Running Total Salary in Month GBP (Pro Rated) = 
VAR FilteredTable =
    CALCULATETABLE (
        'Cross Joined Staff Table (DAX)',
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID]
            ),
            'Cross Joined Staff Table (DAX)'[Start of Month]
                &lt; EARLIER ( 'Cross Joined Staff Table (DAX)'[Start of Month] )
                &amp;&amp; 'Cross Joined Staff Table (DAX)'[Start Date]
                    &lt;= EARLIER ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                &amp;&amp; 'Cross Joined Staff Table (DAX)'[Days in Service in Month (excl W/E)] &lt;&gt; 0
        )
    )
VAR RunningTotalSalaryinMonth =
    SUMX (
        SUMMARIZE (
            FilteredTable,
            'Cross Joined Staff Table (DAX)'[User ID],
            'Cross Joined Staff Table (DAX)'[Start of Month],
            "ValueMaxDate",
                CALCULATE (
                    AVERAGE ( 'Cross Joined Staff Table (DAX)'[Weighted Salary in Month GBP (Pro Rated)] ),
                    FILTER (
                        'Cross Joined Staff Table (DAX)',
                        'Cross Joined Staff Table (DAX)'[Start Date]
                            = MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                    )
                )
        ),
        [ValueMaxDate]
    )
RETURN
    IF (
        'Cross Joined Staff Table (DAX)'[Days in Service (excl W/E)] = 0,
        BLANK (),
        RunningTotalSalaryinMonth + 'Cross Joined Staff Table (DAX)'[Weighted Salary in Month GBP (Pro Rated)]
    )
</code></pre>

<h3 id="salary-in-month-gbp">Salary in Month GBP</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Salary in Month GBP = 
VAR DaysinMonth = [End of Month] - [Start of Month] + 1
VAR WeekendDaysinMonth =
    CALCULATE (
        SUM ( &#39;Calendar&#39;[Weekend] ),
        DATESBETWEEN (
            &#39;Calendar&#39;[Date],
            &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month],
            &#39;Cross Joined Staff Table (DAX)&#39;[End of Month]
        )
    )
RETURN
    [Annual Salary GBP] * ( 1 / 12 )
        * DIVIDE (
            [Days in Service in Month (excl W/E)],
             ( DaysinMonth - WeekendDaysinMonth ),
            0
        )
">
  </button>
</div>
<pre><code class="language-DAX">Salary in Month GBP = 
VAR DaysinMonth = [End of Month] - [Start of Month] + 1
VAR WeekendDaysinMonth =
    CALCULATE (
        SUM ( 'Calendar'[Weekend] ),
        DATESBETWEEN (
            'Calendar'[Date],
            'Cross Joined Staff Table (DAX)'[Start of Month],
            'Cross Joined Staff Table (DAX)'[End of Month]
        )
    )
RETURN
    [Annual Salary GBP] * ( 1 / 12 )
        * DIVIDE (
            [Days in Service in Month (excl W/E)],
             ( DaysinMonth - WeekendDaysinMonth ),
            0
        )
</code></pre>

<h3 id="salary-in-month-gbp-pro-rated">Salary in Month GBP (Pro Rated)</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Salary in Month GBP (Pro Rated) = 
VAR DaysinMonth = [End of Month] - [Start of Month] + 1
VAR WeekendDaysinMonth =
    CALCULATE (
        SUM ( &#39;Calendar&#39;[Weekend] ),
        DATESBETWEEN (
            &#39;Calendar&#39;[Date],
            &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month],
            &#39;Cross Joined Staff Table (DAX)&#39;[End of Month]
        )
    )
VAR SalaryinMonth =
    &#39;Cross Joined Staff Table (DAX)&#39;[Salary in Month GBP]
        * DIVIDE (
             ( DaysinMonth - WeekendDaysinMonth ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service in Month (excl W/E)],
            0
        )
RETURN
    IF (
        &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service in Month (excl W/E)] = 0,
        BLANK (),
        SalaryinMonth
    )
">
  </button>
</div>
<pre><code class="language-DAX">Salary in Month GBP (Pro Rated) = 
VAR DaysinMonth = [End of Month] - [Start of Month] + 1
VAR WeekendDaysinMonth =
    CALCULATE (
        SUM ( 'Calendar'[Weekend] ),
        DATESBETWEEN (
            'Calendar'[Date],
            'Cross Joined Staff Table (DAX)'[Start of Month],
            'Cross Joined Staff Table (DAX)'[End of Month]
        )
    )
VAR SalaryinMonth =
    'Cross Joined Staff Table (DAX)'[Salary in Month GBP]
        * DIVIDE (
             ( DaysinMonth - WeekendDaysinMonth ),
            'Cross Joined Staff Table (DAX)'[Days in Service in Month (excl W/E)],
            0
        )
RETURN
    IF (
        'Cross Joined Staff Table (DAX)'[Days in Service in Month (excl W/E)] = 0,
        BLANK (),
        SalaryinMonth
    )
</code></pre>

<h3 id="started-in-month-">Started in Month ?</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Started in Month ? = 
IF (
    AND ( [Start Date] &gt;= [Start of Month], [Start Date] &lt;= [End of Month] ),
    &quot;Y&quot;,
    &quot;N&quot;
)
">
  </button>
</div>
<pre><code class="language-DAX">Started in Month ? = 
IF (
    AND ( [Start Date] &gt;= [Start of Month], [Start Date] &lt;= [End of Month] ),
    "Y",
    "N"
)
</code></pre>

<h3 id="weekend-days-in-service">Weekend Days in Service</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Weekend Days in Service = 
VAR StartDate = [Start Date]
VAR EndDate =
    IF ( ISBLANK ( [End Date] ), TODAY (), [End Date] )
RETURN
    IF (
        MIN (
            MIN ( TODAY (), EndDate ),
            &#39;Cross Joined Staff Table (DAX)&#39;[End of Month]
        ) &lt; StartDate,
        BLANK (),
        CALCULATE (
            SUM ( &#39;Calendar&#39;[Weekend] ),
            DATESBETWEEN (
                &#39;Calendar&#39;[Date],
                StartDate,
                MIN (
                    MIN ( TODAY (), EndDate ),
                    &#39;Cross Joined Staff Table (DAX)&#39;[End of Month]
                )
            )
        )
    )
">
  </button>
</div>
<pre><code class="language-DAX">Weekend Days in Service = 
VAR StartDate = [Start Date]
VAR EndDate =
    IF ( ISBLANK ( [End Date] ), TODAY (), [End Date] )
RETURN
    IF (
        MIN (
            MIN ( TODAY (), EndDate ),
            'Cross Joined Staff Table (DAX)'[End of Month]
        ) &lt; StartDate,
        BLANK (),
        CALCULATE (
            SUM ( 'Calendar'[Weekend] ),
            DATESBETWEEN (
                'Calendar'[Date],
                StartDate,
                MIN (
                    MIN ( TODAY (), EndDate ),
                    'Cross Joined Staff Table (DAX)'[End of Month]
                )
            )
        )
    )
</code></pre>

<h3 id="weekend-days-in-service-in-month">Weekend Days in Service in Month</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Weekend Days in Service in Month = 
VAR StartDate =  MAX ( [Start Date], [Start of Month] )
VAR EndDate =
    IF ( ISBLANK ( [End Date] ), TODAY (), [End Date] )
RETURN
    IF (
        MIN (
            MIN ( TODAY (), EndDate ),
            &#39;Cross Joined Staff Table (DAX)&#39;[End of Month]
        ) &lt; StartDate,
        BLANK(),
        CALCULATE (
            SUM ( &#39;Calendar&#39;[Weekend] ),
            DATESBETWEEN (
                &#39;Calendar&#39;[Date],
                StartDate,
                MIN (
                    MIN ( TODAY (), EndDate ),
                    &#39;Cross Joined Staff Table (DAX)&#39;[End of Month]
                )
            )
        )
    )
">
  </button>
</div>
<pre><code class="language-DAX">Weekend Days in Service in Month = 
VAR StartDate =  MAX ( [Start Date], [Start of Month] )
VAR EndDate =
    IF ( ISBLANK ( [End Date] ), TODAY (), [End Date] )
RETURN
    IF (
        MIN (
            MIN ( TODAY (), EndDate ),
            'Cross Joined Staff Table (DAX)'[End of Month]
        ) &lt; StartDate,
        BLANK(),
        CALCULATE (
            SUM ( 'Calendar'[Weekend] ),
            DATESBETWEEN (
                'Calendar'[Date],
                StartDate,
                MIN (
                    MIN ( TODAY (), EndDate ),
                    'Cross Joined Staff Table (DAX)'[End of Month]
                )
            )
        )
    )
</code></pre>

<h3 id="weighted-annual-compensation-ratio">Weighted Annual Compensation Ratio</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Weighted Annual Compensation Ratio = 
VAR WeightedAnnualCompRatio =
    CALCULATE (
        DIVIDE (
            SUMX (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                [Annual Compensation Ratio] * [Days in Service in Month (excl W/E)]
            ),
            SUMX ( &#39;Cross Joined Staff Table (DAX)&#39;, [Days in Service in Month (excl W/E)] ),
            BLANK ()
        ),
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
            ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                &lt;= EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
        )
    )
RETURN
    IF (
        &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service in Month (excl W/E)] = 0,
        BLANK (),
        WeightedAnnualCompRatio
    )
">
  </button>
</div>
<pre><code class="language-DAX">Weighted Annual Compensation Ratio = 
VAR WeightedAnnualCompRatio =
    CALCULATE (
        DIVIDE (
            SUMX (
                'Cross Joined Staff Table (DAX)',
                [Annual Compensation Ratio] * [Days in Service in Month (excl W/E)]
            ),
            SUMX ( 'Cross Joined Staff Table (DAX)', [Days in Service in Month (excl W/E)] ),
            BLANK ()
        ),
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month]
            ),
            'Cross Joined Staff Table (DAX)'[Start Date]
                &lt;= EARLIER ( 'Cross Joined Staff Table (DAX)'[Start Date] )
        )
    )
RETURN
    IF (
        'Cross Joined Staff Table (DAX)'[Days in Service in Month (excl W/E)] = 0,
        BLANK (),
        WeightedAnnualCompRatio
    )
</code></pre>

<h3 id="weighted-annual-fte-salary">Weighted Annual FTE Salary</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Weighted Annual FTE Salary = 
VAR WeightedAnnualFTESalary =
    CALCULATE (
        DIVIDE (
            SUMX (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                [FTE Salary GBP] * [Days in Service in Month (excl W/E)]
            ),
            SUMX ( &#39;Cross Joined Staff Table (DAX)&#39;, [Days in Service in Month (excl W/E)] ),
            BLANK ()
        ),
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
            ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                &lt;= EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
        )
    )
RETURN
    IF (
        &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service in Month (excl W/E)] = 0,
        BLANK (),
        WeightedAnnualFTESalary
    )
">
  </button>
</div>
<pre><code class="language-DAX">Weighted Annual FTE Salary = 
VAR WeightedAnnualFTESalary =
    CALCULATE (
        DIVIDE (
            SUMX (
                'Cross Joined Staff Table (DAX)',
                [FTE Salary GBP] * [Days in Service in Month (excl W/E)]
            ),
            SUMX ( 'Cross Joined Staff Table (DAX)', [Days in Service in Month (excl W/E)] ),
            BLANK ()
        ),
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month]
            ),
            'Cross Joined Staff Table (DAX)'[Start Date]
                &lt;= EARLIER ( 'Cross Joined Staff Table (DAX)'[Start Date] )
        )
    )
RETURN
    IF (
        'Cross Joined Staff Table (DAX)'[Days in Service in Month (excl W/E)] = 0,
        BLANK (),
        WeightedAnnualFTESalary
    )
</code></pre>

<h3 id="weighted-salary-in-month-gbp-pro-rated">Weighted Salary in Month GBP (Pro Rated)</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Weighted Salary in Month GBP (Pro Rated) = 
VAR TotalWeightedSalary =
    CALCULATE (
        SUMX (
            &#39;Cross Joined Staff Table (DAX)&#39;,
            [Salary in Month GBP (Pro Rated)] * [Days in Service in Month (excl W/E)]
        ),
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
            ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                &lt;= EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
        )
    )
VAR FilteredTable =
    CALCULATETABLE (
        &#39;Cross Joined Staff Table (DAX)&#39;,
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
            ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                &lt;= EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
        )
    )
VAR SumDaysAllJobGradesExcludingDaysBetweenGrades =
    CALCULATE (
        SUMX (
            SUMMARIZE (
                FilteredTable,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month],
                &quot;ValueMaxDate&quot;,
                    CALCULATE (
                        VAR MaxStartDatePreviousGrade =
                            CALCULATE (
                                MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] ),
                                FILTER (
                                    ALLEXCEPT (
                                        &#39;Cross Joined Staff Table (DAX)&#39;,
                                        &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                                        &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
                                    ),
                                    &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                                        &lt; MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                                        &amp;&amp; &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade]
                                            &lt;&gt; MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade] )
                                )
                            )
                        VAR StartDateBeforePreviousGradeChange =
                            CALCULATE (
                                MIN ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] ),
                                FILTER (
                                    ALLEXCEPT (
                                        &#39;Cross Joined Staff Table (DAX)&#39;,
                                        &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                                        &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
                                    ),
                                    &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] &gt; MaxStartDatePreviousGrade
                                )
                            )
                        VAR NextStartDateSameGrade =
                            CALCULATE (
                                MIN ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] ),
                                FILTER (
                                    ALLEXCEPT (
                                        &#39;Cross Joined Staff Table (DAX)&#39;,
                                        &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                                        &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade],
                                        &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
                                    ),
                                    &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                                        &gt; MIN ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                                )
                            )
                        VAR MinStartDateNextGrade =
                            CALCULATE (
                                MIN ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] ),
                                FILTER (
                                    ALLEXCEPT (
                                        &#39;Cross Joined Staff Table (DAX)&#39;,
                                        &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                                        &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
                                    ),
                                    &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                                        &gt; MIN ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                                        &amp;&amp; &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade]
                                            &lt;&gt; MIN ( &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade] )
                                )
                            )
                        VAR EndDateBeforeNextGradeChange =
                            CALCULATE (
                                MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[End Date] ),
                                FILTER (
                                    ALLEXCEPT (
                                        &#39;Cross Joined Staff Table (DAX)&#39;,
                                        &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                                        &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
                                    ),
                                    &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] &lt; MinStartDateNextGrade
                                )
                            )
                        VAR EndDate =
                            IF (
                                NextStartDateSameGrade &gt; MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[End of Month] ),
                                EndDateBeforeNextGradeChange,
                                MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[End Date] )
                            )
                        VAR RunningDaysinMonthfromParticularGrade =
                            IF (
                                MIN (
                                    MIN ( TODAY (), EndDate ),
                                    MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[End of Month] )
                                )
                                    &lt; MAX (
                                        StartDateBeforePreviousGradeChange,
                                        MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month] )
                                    ) + 1,
                                BLANK (),
                                MIN (
                                    MIN ( TODAY (), EndDate ),
                                    MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[End of Month] )
                                )
                                    - MAX (
                                        StartDateBeforePreviousGradeChange,
                                        MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month] )
                                    ) + 1
                            )
                        VAR RunningWeekendDaysinMonthfromParticularGrade =
                            IF (
                                MIN (
                                    MIN ( TODAY (), EndDate ),
                                    MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[End of Month] )
                                )
                                    &lt; MAX (
                                        StartDateBeforePreviousGradeChange,
                                        MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month] )
                                    ) + 1,
                                BLANK (),
                                CALCULATE (
                                    SUM ( &#39;Calendar&#39;[Weekend] ),
                                    DATESBETWEEN (
                                        &#39;Calendar&#39;[Date],
                                        MAX (
                                            StartDateBeforePreviousGradeChange,
                                            MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month] )
                                        ),
                                        MIN (
                                            MIN ( TODAY (), EndDate ),
                                            MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[End of Month] )
                                        )
                                    )
                                )
                            )
                        RETURN
                            RunningDaysinMonthfromParticularGrade - RunningWeekendDaysinMonthfromParticularGrade,
                        FILTER (
                            &#39;Cross Joined Staff Table (DAX)&#39;,
                            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                                = MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                        )
                    )
            ),
            [ValueMaxDate]
        )
    )
RETURN
    IF (
        &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service in Month (excl W/E)] = 0,
        BLANK (),
        DIVIDE ( TotalWeightedSalary, SumDaysAllJobGradesExcludingDaysBetweenGrades, 0 )
    )
">
  </button>
</div>
<pre><code class="language-DAX">Weighted Salary in Month GBP (Pro Rated) = 
VAR TotalWeightedSalary =
    CALCULATE (
        SUMX (
            'Cross Joined Staff Table (DAX)',
            [Salary in Month GBP (Pro Rated)] * [Days in Service in Month (excl W/E)]
        ),
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month]
            ),
            'Cross Joined Staff Table (DAX)'[Start Date]
                &lt;= EARLIER ( 'Cross Joined Staff Table (DAX)'[Start Date] )
        )
    )
VAR FilteredTable =
    CALCULATETABLE (
        'Cross Joined Staff Table (DAX)',
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month]
            ),
            'Cross Joined Staff Table (DAX)'[Start Date]
                &lt;= EARLIER ( 'Cross Joined Staff Table (DAX)'[Start Date] )
        )
    )
VAR SumDaysAllJobGradesExcludingDaysBetweenGrades =
    CALCULATE (
        SUMX (
            SUMMARIZE (
                FilteredTable,
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Job Grade],
                'Cross Joined Staff Table (DAX)'[Start of Month],
                "ValueMaxDate",
                    CALCULATE (
                        VAR MaxStartDatePreviousGrade =
                            CALCULATE (
                                MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] ),
                                FILTER (
                                    ALLEXCEPT (
                                        'Cross Joined Staff Table (DAX)',
                                        'Cross Joined Staff Table (DAX)'[User ID],
                                        'Cross Joined Staff Table (DAX)'[Start of Month]
                                    ),
                                    'Cross Joined Staff Table (DAX)'[Start Date]
                                        &lt; MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                                        &amp;&amp; 'Cross Joined Staff Table (DAX)'[Job Grade]
                                            &lt;&gt; MAX ( 'Cross Joined Staff Table (DAX)'[Job Grade] )
                                )
                            )
                        VAR StartDateBeforePreviousGradeChange =
                            CALCULATE (
                                MIN ( 'Cross Joined Staff Table (DAX)'[Start Date] ),
                                FILTER (
                                    ALLEXCEPT (
                                        'Cross Joined Staff Table (DAX)',
                                        'Cross Joined Staff Table (DAX)'[User ID],
                                        'Cross Joined Staff Table (DAX)'[Start of Month]
                                    ),
                                    'Cross Joined Staff Table (DAX)'[Start Date] &gt; MaxStartDatePreviousGrade
                                )
                            )
                        VAR NextStartDateSameGrade =
                            CALCULATE (
                                MIN ( 'Cross Joined Staff Table (DAX)'[Start Date] ),
                                FILTER (
                                    ALLEXCEPT (
                                        'Cross Joined Staff Table (DAX)',
                                        'Cross Joined Staff Table (DAX)'[User ID],
                                        'Cross Joined Staff Table (DAX)'[Job Grade],
                                        'Cross Joined Staff Table (DAX)'[Start of Month]
                                    ),
                                    'Cross Joined Staff Table (DAX)'[Start Date]
                                        &gt; MIN ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                                )
                            )
                        VAR MinStartDateNextGrade =
                            CALCULATE (
                                MIN ( 'Cross Joined Staff Table (DAX)'[Start Date] ),
                                FILTER (
                                    ALLEXCEPT (
                                        'Cross Joined Staff Table (DAX)',
                                        'Cross Joined Staff Table (DAX)'[User ID],
                                        'Cross Joined Staff Table (DAX)'[Start of Month]
                                    ),
                                    'Cross Joined Staff Table (DAX)'[Start Date]
                                        &gt; MIN ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                                        &amp;&amp; 'Cross Joined Staff Table (DAX)'[Job Grade]
                                            &lt;&gt; MIN ( 'Cross Joined Staff Table (DAX)'[Job Grade] )
                                )
                            )
                        VAR EndDateBeforeNextGradeChange =
                            CALCULATE (
                                MAX ( 'Cross Joined Staff Table (DAX)'[End Date] ),
                                FILTER (
                                    ALLEXCEPT (
                                        'Cross Joined Staff Table (DAX)',
                                        'Cross Joined Staff Table (DAX)'[User ID],
                                        'Cross Joined Staff Table (DAX)'[Start of Month]
                                    ),
                                    'Cross Joined Staff Table (DAX)'[Start Date] &lt; MinStartDateNextGrade
                                )
                            )
                        VAR EndDate =
                            IF (
                                NextStartDateSameGrade &gt; MAX ( 'Cross Joined Staff Table (DAX)'[End of Month] ),
                                EndDateBeforeNextGradeChange,
                                MAX ( 'Cross Joined Staff Table (DAX)'[End Date] )
                            )
                        VAR RunningDaysinMonthfromParticularGrade =
                            IF (
                                MIN (
                                    MIN ( TODAY (), EndDate ),
                                    MAX ( 'Cross Joined Staff Table (DAX)'[End of Month] )
                                )
                                    &lt; MAX (
                                        StartDateBeforePreviousGradeChange,
                                        MAX ( 'Cross Joined Staff Table (DAX)'[Start of Month] )
                                    ) + 1,
                                BLANK (),
                                MIN (
                                    MIN ( TODAY (), EndDate ),
                                    MAX ( 'Cross Joined Staff Table (DAX)'[End of Month] )
                                )
                                    - MAX (
                                        StartDateBeforePreviousGradeChange,
                                        MAX ( 'Cross Joined Staff Table (DAX)'[Start of Month] )
                                    ) + 1
                            )
                        VAR RunningWeekendDaysinMonthfromParticularGrade =
                            IF (
                                MIN (
                                    MIN ( TODAY (), EndDate ),
                                    MAX ( 'Cross Joined Staff Table (DAX)'[End of Month] )
                                )
                                    &lt; MAX (
                                        StartDateBeforePreviousGradeChange,
                                        MAX ( 'Cross Joined Staff Table (DAX)'[Start of Month] )
                                    ) + 1,
                                BLANK (),
                                CALCULATE (
                                    SUM ( 'Calendar'[Weekend] ),
                                    DATESBETWEEN (
                                        'Calendar'[Date],
                                        MAX (
                                            StartDateBeforePreviousGradeChange,
                                            MAX ( 'Cross Joined Staff Table (DAX)'[Start of Month] )
                                        ),
                                        MIN (
                                            MIN ( TODAY (), EndDate ),
                                            MAX ( 'Cross Joined Staff Table (DAX)'[End of Month] )
                                        )
                                    )
                                )
                            )
                        RETURN
                            RunningDaysinMonthfromParticularGrade - RunningWeekendDaysinMonthfromParticularGrade,
                        FILTER (
                            'Cross Joined Staff Table (DAX)',
                            'Cross Joined Staff Table (DAX)'[Start Date]
                                = MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                        )
                    )
            ),
            [ValueMaxDate]
        )
    )
RETURN
    IF (
        'Cross Joined Staff Table (DAX)'[Days in Service in Month (excl W/E)] = 0,
        BLANK (),
        DIVIDE ( TotalWeightedSalary, SumDaysAllJobGradesExcludingDaysBetweenGrades, 0 )
    )
</code></pre>

                        
                        
                    </main>	
                    
                        <!-- Start of Feedback section -->
<section class="feedback-section is-relative">
    <h2 id="feedback" class="is-size-2 has-margin-top-large has-padding-top-medium"> Feedback </h2>
    <div class="feedback has-margin-top-small has-margin-bottom-none">
        <p id="send-feedback-about" class="has-margin-top-none has-margin-bottom-none">
            Submit and view feedback
        </p>
        <div id="feedback-section-link" class="has-margin-top-large has-margin-bottom-none">
            <a class="button has-margin-bottom-small" href="" target="_blank">
                <span class="icon">
                    <span class=github>
                        <i class="fab fa-github"></i>
                    </span>
                </span>
                <span>This page</span>
            </a>
        </div>
    </div>
    <div id="viewallfeedback-section-link" class="is-flex has-flex-justify-content-end has-margin-top-small has-margin-bottom-medium">
        <a class="view-on-github" href="" target="_blank">
            <span class="icon">
                <span class=github>
                    <i class="fab fa-github"></i>
                </span>
            </span><span>View all page feedback</span>
        </a>
    </div>
</section>

<!-- End of Feedback section -->
                    
                </div>

                
                 <!-- Right Hand Side Toc-->
                 <div class="right-sidebar column is-one-quarter is-one-fifth-desktop is-hidden-mobile is-hidden-tablet-only">
                    <nav class="doc-outline is-fixed is-vertically-scrollable", id="affixed-right-sidebar">
                        <nav id="side-doc-outline">
                            <header id="side-doc-title" class = "is-flex is-flex-row">
                                <div>
                                    <a href="#top">
                                        <h3 title="Go to Top of Page">
                                            <i class="fas fa-file-alt" style="color:#e82127;">&nbsp;</i>
                                            In this article
                                        </h3>
                                    </a>
                                </div>
                            </header>
                            <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#hr---metrics-report-monthly-salaries-pro-rated-salaries-average-salaries-running-average-salaries-total-to-date-salaries-and-annual-compensation-ratios">HR - Metrics Report: Monthly Salaries, Pro-Rated Salaries, Average Salaries, Running Average Salaries, Total To Date Salaries, and Annual Compensation Ratios</a>
<ul>
<li class="toc-entry toc-h3"><a href="#hr-salary-metrics">HR Salary Metrics</a></li>
<li class="toc-entry toc-h3"><a href="#enhancements">Enhancements</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#model-extensions">Model Extensions</a></li>
<li class="toc-entry toc-h2"><a href="#dashboard---snippet">Dashboard - Snippet</a></li>
<li class="toc-entry toc-h2"><a href="#data-model---snippet">Data Model - Snippet</a></li>
<li class="toc-entry toc-h2"><a href="#measures">Measures</a>
<ul>
<li class="toc-entry toc-h3"><a href="#average-comp-ratio-by-person-">Average Comp Ratio by Person %</a></li>
<li class="toc-entry toc-h3"><a href="#average-salary-by-person-actual-gbp">Average Salary by Person (Actual) GBP</a></li>
<li class="toc-entry toc-h3"><a href="#average-salary-by-person-annual-fte-gbp">Average Salary by Person (Annual FTE) GBP</a></li>
<li class="toc-entry toc-h3"><a href="#average-salary-by-person-pro-rated-gbp">Average Salary by Person (Pro-Rated) GBP</a></li>
<li class="toc-entry toc-h3"><a href="#running-avg-salary-by-person-actual-gbp">Running Avg. Salary by Person (Actual) GBP</a></li>
<li class="toc-entry toc-h3"><a href="#running-avg-salary-by-person-pro-rated-gbp">Running Avg. Salary by Person (Pro Rated) GBP</a></li>
<li class="toc-entry toc-h3"><a href="#salary-actual-gbp">Salary (Actual) GBP</a></li>
<li class="toc-entry toc-h3"><a href="#ttd-salary-actual-gbp">TTD Salary (Actual) GBP</a></li>
<li class="toc-entry toc-h3"><a href="#today">Today</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#tables">Tables</a>
<ul>
<li class="toc-entry toc-h3"><a href="#calendar">Calendar</a></li>
<li class="toc-entry toc-h3"><a href="#cross-joined-staff-table-dax">Cross Joined Staff Table (DAX)</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#calculated-columns">Calculated Columns</a>
<ul>
<li class="toc-entry toc-h3"><a href="#weekend">Weekend</a></li>
<li class="toc-entry toc-h3"><a href="#age-years">Age (Years)</a></li>
<li class="toc-entry toc-h3"><a href="#age-group">Age Group</a></li>
<li class="toc-entry toc-h3"><a href="#annual-compensation-ratio">Annual Compensation Ratio</a></li>
<li class="toc-entry toc-h3"><a href="#annual-salary-gbp">Annual Salary GBP</a></li>
<li class="toc-entry toc-h3"><a href="#benchmark-salary">Benchmark Salary</a></li>
<li class="toc-entry toc-h3"><a href="#count-of-months-with-salary">Count of Months with Salary</a></li>
<li class="toc-entry toc-h3"><a href="#days-in-service-excl-we">Days in Service (excl W/E)</a></li>
<li class="toc-entry toc-h3"><a href="#days-in-service-in-month-excl-we">Days in Service in Month (excl W/E)</a></li>
<li class="toc-entry toc-h3"><a href="#end-date-fill">End Date Fill</a></li>
<li class="toc-entry toc-h3"><a href="#external-join">External Join</a></li>
<li class="toc-entry toc-h3"><a href="#external-leave">External Leave</a></li>
<li class="toc-entry toc-h3"><a href="#internal-join">Internal Join</a></li>
<li class="toc-entry toc-h3"><a href="#internal-leave">Internal Leave</a></li>
<li class="toc-entry toc-h3"><a href="#left-in-month-">Left in Month ?</a></li>
<li class="toc-entry toc-h3"><a href="#next-start-date">Next Start Date</a></li>
<li class="toc-entry toc-h3"><a href="#part-of-headcount-at-end-of-month">Part of HeadCount at End of Month</a></li>
<li class="toc-entry toc-h3"><a href="#part-of-headcount-at-start-of-month">Part of HeadCount at Start of Month</a></li>
<li class="toc-entry toc-h3"><a href="#part-of-headcount-start-or-end-of-month">Part of HeadCount Start or End of Month</a></li>
<li class="toc-entry toc-h3"><a href="#previous-end-date">Previous End Date</a></li>
<li class="toc-entry toc-h3"><a href="#running-average-salary-in-month-gbp">Running Average Salary in Month GBP</a></li>
<li class="toc-entry toc-h3"><a href="#running-total-salary-in-month-gbp-actual">Running Total Salary in Month GBP (Actual)</a></li>
<li class="toc-entry toc-h3"><a href="#running-total-salary-in-month-gbp-pro-rated">Running Total Salary in Month GBP (Pro Rated)</a></li>
<li class="toc-entry toc-h3"><a href="#salary-in-month-gbp">Salary in Month GBP</a></li>
<li class="toc-entry toc-h3"><a href="#salary-in-month-gbp-pro-rated">Salary in Month GBP (Pro Rated)</a></li>
<li class="toc-entry toc-h3"><a href="#started-in-month-">Started in Month ?</a></li>
<li class="toc-entry toc-h3"><a href="#weekend-days-in-service">Weekend Days in Service</a></li>
<li class="toc-entry toc-h3"><a href="#weekend-days-in-service-in-month">Weekend Days in Service in Month</a></li>
<li class="toc-entry toc-h3"><a href="#weighted-annual-compensation-ratio">Weighted Annual Compensation Ratio</a></li>
<li class="toc-entry toc-h3"><a href="#weighted-annual-fte-salary">Weighted Annual FTE Salary</a></li>
<li class="toc-entry toc-h3"><a href="#weighted-salary-in-month-gbp-pro-rated">Weighted Salary in Month GBP (Pro Rated)</a></li>
</ul>
</li>
</ul>
                        </nav>

                        <!-- Fixed Element-->
                        <div>
                            <a class="top-link hide" href="" id="js-top" title="Go to Top of Page">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg>
                            </a>
                        </div>
                    </nav>
                </div>
                
            </div>
            <!-- end of /.columns -->
        </div>	
        <!-- end of /primary holder -->

    </div>
    <!-- end of /.columns -->
</div>
<!-- end of /.mainContainer -->
			<!-- Footer Container --> 
<div class="footerContainer">

    
    

    <footer id="footer" class=" footer-layout   uhf-container has-padding">
        <div class="">
            <a href="https://startech-enterprises.github.io/docs/">
                <img src="/../docs/assets/images/starbase_logo.png" class="footer-bar-logo">
            </a>
        </div>
        <div class="is-flex is-full-height has-padding-right-extra-large-desktop has-padding-left-extra-large-desktop">
            <a class="locale-selector-link has-flex-shrink-none" href="/../">
                <span class="icon">
                    <span><i class="fas fa-globe"></i></span>
                </span>
                <span class="locale-selector-link-text">English (United Kingdom)</span>
            </a>
        </div>
        <ul class="links">
            <li>
                <a href="/docs/">Docs</a>
            </li>
            <li>
                <a href="/docs/">Guides</a>
            </li>
            <li>
                <a href="/docs/articles-and-blogs/article-search.html">Articles & Blogs</a>
            </li>
            <li>
                <a href="/docs/videos/">Videos</a>
            </li>
            <li>
                <a href="/docs/about/about.html">About</a>
            </li>
            <li>
                <a href="https://www.linkedin.com/company/startech-enterprises/" target="_blank">LinkedIn</a>
            </li>
            <li style="color: #e82127;">
                <span class="icon">
                    <span> <i class="fas fa-star"></i></span>
                </span>Star Base 2020
            </li>
        </ul>
    </footer>
</div>
<!-- end of / footerContainer -->
	</body>
		<!-- Reference to main JavaScript Files -->
<script src="/../docs/assets/js/library.js" type="application/javascript"></script>
<script src="/../docs/assets/js/breadCrumb.js" type="application/javascript"></script>
<script src="/../docs/assets/js/navbar.js" type="application/javascript"></script>
<script src="/../docs/assets/js/affix.js" type="application/javascript"></script>
<script src="/../docs/assets/js/rhsToc.js" type="application/javascript"></script>




<script src="/../docs/assets/js/scrollTop.js" type="application/javascript"></script>
<script src="/../docs/assets/js/gitFeedback.js" type="application/javascript"></script>
<script src="/../docs/assets/js/copyCode.js" type="application/javascript"></script>
</html>
