<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-176158185-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176158185-1');
</script>

		<title>HR - Showing Employee Salaries & analysing trends in Actual and Average Running (Pro-Rated) Salaries over time | StarBase </title>
		<!-- link to website tab icon -->
		<link rel="shortcut icon" type="image/x-icon" href="/../docs/assets/images/alt-logo-star-tilted.png">
		<!-- link to Main Stylesheets -->
		<link rel="stylesheet" type="text/css" href="/../docs/assets/css/styles.css">
		<!-- link to Google Fonts -->
		<link href='https://fonts.googleapis.com/css?family=Zilla Slab' rel='stylesheet'>
		<link href="https://fonts.googleapis.com/css2?family=Marcellus&display=swap" rel="stylesheet"> 
		<link href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro&display=swap" rel="stylesheet"> 
		<link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@200..400&display=swap" rel="stylesheet">
		<!-- link to Font awesome -->
		<script src="https://kit.fontawesome.com/378306bc97.js" crossorigin="anonymous"></script>
		<!-- link to Material Icons -->
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<!-- link to Iconify CDN -->
		<script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
		<!-- link to UUID -->	
		<script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.1.0/uuidv5.min.js"></script>
	</head>
	<body>
		<a id="top"></a>
			<!-- Header Holder --> 

<div class="header-holder has-default-focus"
  
  >
    <div class="nav-bar">
        <!---->
        <a class="nav-bar-button has-padding-left-medium has-padding-left-none-tablet" href="https://sachin1882.wixsite.com/startechenterprises/guides" title="Go to parent site: StarTech Enterprises">
            <div class="nav-bar-logo has-background-image">
                <img src="https://fontmeme.com/permalink/200623/587d8aec23ed76c10e0b1ec43bc85f23.png" class="alt-logo has-background-image" width="180" height ="70">
                <div class="overlay">
                    <img src="/../docs/assets/images/starbase_logo.png" class="nav-bar-logo">
                </div>
            </div>
        </a>
        <nav class="nav-bar-nav">
            <ul class="nav-bar-nav-list">
                <li class="nav-bar-item is-category has-spacing">
                    <a class = "nav-bar-button title has-hover-underline is-6 
                    
                    
                    " href="/docs/">
                        <span>
                            <!---->
                            Docs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    underline
                    
                    " href="/docs/">
                        <span>
                            <!---->
                            Guides
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    
                    " href="/docs/articles-and-blogs/article-search.html">
                        <span>
                            <!---->
                            Articles & Blogs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/videos/">
                        <span>
                            <!---->
                            Videos
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    
                    " href="/docs/about/about.html">
                        <span>
                            <!---->
                            About
                            <!---->
                        </span>
                    </a>
                </li>
            </ul>
        </nav>
        <span class = "nav-bar-spacer i-hidden-mobile"></span>
        <!---->
    </div>
</div>


<div class="header-holder transparent has-default-focus" style="position: sticky; top: 0; left: 0; right: 0;">
    <div class="content-header uhf-container has-padding has-default-focus is-flexbox" style="padding-top: 0px; padding-bottom: 1px;">
        
<!-- Get correct Breadcrumb Links from Front Matter of loaded page-->

<!-- Liquid Code -->
    <!-- Page Root -->
    

    <!-- Page Type -->
    

    <!-- Page Category -->
    

    <!-- Page Series -->
    
<!-- / End of Liquid Code -->


<!-- Breadcrumb Links --> 
<nav class = "has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop has-flex-grow">
    <ul id="page-breadcrumbs" class="breadcrumbs">
        <li><a href="/docs/"><span class ="">Docs</span></a></li>
        <li><a href="/docs/"><span class ="">Guides</span></a></li>
        <li><a href="/docs/guides/data-analytics/data-analytics.html"><span class="">Data Analytics</span></a></li>
        <li><a href=/docs/guides/data-analytics/data-analytics.html><span class="">DAX Samples</span></a></li>

        <!-- This part needs to be generated by JavaScript-->

    </ul>
</nav>
<!-- end of / Breadcrumb links -->




        <!-- Page Functions --> 

<div class="has-padding-none-tablet has-padding-medium is-size-7 is-flex-touch has-flex-justify-content-space-between-touch has-flex-grow">
    <ul class="is-hidden-mobile action-list has-flex-justify-content-end-tablet is-flex is-flex-row has-flex-wrap has-flex-grow is-unstyled">
        <li>
            <button class="print button is-text has-inner-focus is-small is-icon-only-touch colorfill" type="button" title="Print this page" onclick="window.print()">
                <span class="icon">
                    <span class="iconify extra-small" data-icon="el:print" data-inline="false"></span>                </span>
                <span class="is-visually-hidden-touch is-hidden-portrait">Print</span>
            </button>
        </li>
        <li>
            <button class="button is-text has-inner-focus is-small is-icon-only-touch colorfill" title="Send feedback about this page" onclick="location.href='#feedback'">
                <span class="icon">
                    <i class="fas fa-comments"></i>
                </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Feedback</span>
            </button>
        </li>
        <li id="share-menu-link">
            <div class = "sharing dropdown has-caret">
                <button class="dropdown-trigger button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small is-icon-only-touch colorfill" title="Share This Document">
                    <span class="icon">
                        <span class="iconify extra-small" data-icon="ls:share" data-inline="false"></span>
                    </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
                </button>
                <div id="sharing-menu" class="sharing-menu has-padding-small is-hidden">
                    <ul>
                        <li id="twitter-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-twitter" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-twitter colorfill"></i>
                                </span>
                                <span>Twitter</span>
                            </a>
                        </li>
                        <li id="linkedin-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-linkedin" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-linkedin-in colorfill"></i>
                                </span>
                                <span>LinkedIn</span>
                            </a>
                        </li>
                        <li id="facebook-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-facebook" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-facebook-f colorfill"></i>
                                </span>
                                <span>Facebook</span>
                            </a>
                        </li>
                        <li id="email-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-email" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fas fa-envelope colorfill"></i>
                                </span>
                                <span>Email</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </li>
    </ul>
</div>

<!-- end of / Page Functions -->
    </div>
    <div class="progress-container">
        <div class="progress-bar-scroll" id="myBar"></div>
    </div>
</div>

<!-- end of /.header-holder -->
			<!-- Main Container --> 
<div class="mainContainer uhf-container  has-top-padding ">
    <div class="columns has-large-gaps is-gapless-mobile ">

        
        <!-- Left Hand Side Tree-->
        <div class="left-sidebar column is-hidden-mobile 
         
        is-one-fifth-tablet is-one-seventh-desktop 
        ">
            <nav class ="is-fixed is-flex is-flex-column" id="affixed-left-sidebar">

                <!-- Include LHS Menu -->
                
                <a href="../data-analytics.html">
                    <span id="earlierPage" class="is-primary">
                        <span class="iconify medium" data-icon="ic-sharp-arrow-back" data-inline="false"></span>
                    </span>
                </a>
                
            </nav>
        </div>
         <!-- end of /left hand side tree -->
        

        <!-- Primary Holder -->    
        <div class="primary-holder column 
        
         is-four-fifths-tablet is-six-sevenths-desktop 
        ">
            <div class="columns has-large-gaps is-gapless-mobile 
            
            ">

                 <!-- Main Column -->
                <div id="main-column" class="column 
                 
                is-full is-four-fifths-desktop 
                ">
                    <main id="main" class ="
                    
                        content docs
                    " lang="eng-us">
                        <h1 id="hr---showing-employee-salaries--analysing-trends-in-actual-and-average-running-pro-rated-salaries-over-time">HR - Showing Employee Salaries &amp; analysing trends in Actual and Average Running (Pro-Rated) Salaries over time</h1>
<time class="metadata" style="text-alstyleign:left"> Guides • Data Analytics • 17/09/2020</time>

<div class="has-margin-top-medium">
  <p><a class="button is-small is-primary no_icon" href="https://1drv.ms/u/s!Ahu8OSSAtOMzlGfViEaX73gKFww-?e=OemGxj" target="_blank">
    <span>
        Download Sample
    </span>
    <span class=" has-margin-left-small material-icons">
        cloud_download
    </span>
</a></p>
</div>

<h2 id="hr---showing-employee-salaries--analysing-trends-in-actual-and-average-running-pro-rated-salaries-over-time-1">HR - Showing Employee Salaries &amp; analysing trends in Actual and Average Running (Pro-Rated) Salaries over time</h2>

<p>This sample takes the following data (you need to have a HR ERP supports such data capture!), and turns it into a full Employee Inventory Salary Table. In this example, the final data table (after any necessary cross-joining) is created entirely with DAX (here, ETL, and ‘M’ code are not used).</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-salary-inventory-table-data.png');" src="images/hr-salary-inventory-table-data.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>The example in this article is slightly more complex than the Tenure example shown in this <em>DAX article:</em> <a href="../dax-samples/hr-inventory-table-and-tenure.html"><strong>HR - Showing Inventory Movements &amp; analysing Total Running Tenure over time</strong></a>, to calculate Tenure. That example shows: (a) each Employee’s Running Tenure (in Years) by Month - showing only one figure for a user, in a given Month. It also shows (b) each Employee’s Running Tenure (in Months) by Job Grade, and Month - again, showing only one figure for a user, for a given Month and Job Grade.</p>

<p>The way Running Tenure is calculated, to all intents and purposes <em>good enough</em>, and we can get by, without having to be <strong><em>Hyper-Accurate!</em></strong></p>

<p>In this example, however, we take things a step further. Probably the most difficult measure shown in this report is:</p>

<p>(i) <strong>Running Average Monthly Salary by Grade:</strong> (shown on page 2 of the report).</p>

<p>The measure is re-computed <strong><em>everytime</em></strong> a user’s profile changes - even if looking at the same month, where the user’s job grade <strong>does not</strong> change - for example, if there are other profile changes, such as in their: Department, Country, Full or Part Time working status, <em>over the course</em> of the month.</p>

<h3 id="running-average-monthly-salary-methodology">Running Average Monthly Salary Methodology</h3>

<p>The Running Average Monthly Salary calculation is complex (but also as accurate as I could make it!). For each Employee, the measure is computed, by Job Grade, by:</p>

<ul>
  <li>Taking the Arithmetic average of: (i) the Weighted Average salary of the Employee in the current month (upto the end date of current profile change), together with (ii) the sum of the Weighted Average salary of the Employee in each of the previous months, as they stood at the end of those months (but still considering only those months where the Employee held the same Job Grade - as the measure is computed at a Job Grade level),</li>
  <li>The Weighted Average Monthly Salary, upto a particular date, itself, is also re-computed for each profile change, and calculated by taking a blended average of the Employee’s Pro-Rated (Full Month) Salaries, for each unique profile position held by the Employee in the given month (i.e. from the start of the month (or first start date at that particular job grade, which ever is later) upto the given end date of the profile the Weighted Average Salary is being calculated for).</li>
</ul>

<h3 id="worked-example">Worked Example</h3>

<p>To illustrate the method more clearly:</p>

<p>If, in January, Employee 001, worked 5 days, as an Associate, in Brazil, from 27/01/2020 to 31/01/2020, on a Pro-Rated Monthly Salary of £5,000, the Weighted Average Salary on 31/01/2020 is: £5,000/5 * 5 = £5,000. Their Running Average Monthly Salary would be £5,000 / 1 = £5,000 (Note here, if the employee just started on 27/01/2020, their actual paid salary would be: £5,000 * 5 / 31 = £806, in the Month)</p>

<p>If Employee 001 then worked for another 10 days, from 01/02/2020 to 10/02/2020, on a Pro-Rated Monthly Salary of £6,000, their Weighted Average Salary on 10/02/2020 would be: £6,000/10 * 10 = £6,000. Their Running Average Salary, upto this date, would be: ( £5,000 (from Jan) + £6,000 (from Feb) ) / 2 = £5,500</p>

<p>If then, the Employee then worked for 15 days, from 11/02/2020 to 25/02/2020, on a Pro-Rated Monthly Salary of £5,000, their Weighted Average Salary on 25/02/2020 would be: (£6,000 * 10 + £5,000 * 15) / 25 = £5,400. Their Running Average Monthly Salary would change to: ( £5,000 (from Jan) + £5,400 (from Feb) ) / 2 = £5,200</p>

<h3 id="other-measures">Other Measures</h3>

<p>Apart from <strong>Running Average Monthly Salary by Grade</strong>, the report also shows:</p>

<p>(iii) The <strong>Actual Salary Paid to each Employee:</strong>, by Job Grade, and Month, both as a Matrix Table, and Stacked Bar Chart (on page 1)<br />
(ii) The <strong>Actual Salary Paid to each Employee:</strong>, by Country, Department, Part of Full time working status, and Job Grade (on page 2)</p>

<h3 id="enhancements">Enhancements</h3>

<p>Other enhancements to make the calculation more accurate, have been to:</p>

<ul>
  <li>Ignore the affect of Weekends in any day count calculations (when computing any <em>Weighted Average</em>, <em>Actual Paid</em>, or <em>Pro-Rated</em> Salaries)</li>
  <li>Reduce the <strong>Weighted Average Salary</strong> calculation, for any Working days not worked in the month
    <ul>
      <li>For example, assuming weekends don’t exist, if an Employee worked from 01/02/2020 to 10/02/2020, and then from 15/02/2020 to 20/02/2020, the Days in Service worked by the Employee would be 16. The Days Available to that Employee in the Month would be 20 (because of the 4 days not worked). The affect would be to reduce their Weighted Average Salary when it is calculated on 20/02/2022. There would be no affect when the salary is calculated on 10/02/2020, because at this point, both Days in Service, and Days Available would have been 10)</li>
      <li>Note that, if the Employee started working slightly later, say on 03/02/2020 (i.e. not the first day of the month), to 10/02/2020, and then again from 15/02/2020 to 20/02/2020, their total Days in Service on 20/02/2020 would be 14, and Days Available would be 18. Again, provided 03/02/2020 was Employee’s very first day working at the particular Job Grade, the Weighted Average Salary when calculated at 10/02/2020 would not be affected. It would still though be affected when calculated on 20/02/2020.</li>
    </ul>
  </li>
</ul>

<div class="alert alert-danger alerts-font" role="alert">
  <p><i class="fa fa-exclamation-circle"></i> <b>Warning: </b>
<br />
Public Holidays are not considered in this report. Only Weekends, which are assumed to fall on every Saturday, and Sunday.</p>
</div>

<div class="alert alert-info alerts-font" role="alert">
  <p><i class="fa fa-info-circle"></i> <b>Note: </b>
<br />
By comparison, the Running Tenure example, shown in this <em>DAX article:</em> <a href="../dax-samples/hr-inventory-table-and-tenure.html"><strong>HR - Showing Inventory Movements &amp; analysing Total Running Tenure over time</strong></a>, takes a much simpler approach. Each Employee’s tenure (Tenure by employee, or Tenure by employee by job grade), is calculated by providing one running total figure - even if different profile statuses are held by the employee in the same month, at the same job grade. The calculation is done by scanning the entire month first to compute the running total figure for the entire month, rather than, what is being done above, where the running total is re-calculated for each profile change, <em>within the course</em> of the month.)</p>
</div>

<h2 id="model-extensions">Model Extensions</h2>

<p>Possible extensions to this model, could include:</p>

<ul>
  <li>Adding ‘<strong><em>Freelance or Permanent</em></strong>’ as an extra field to distinguish between these staff types</li>
  <li>Separating the calculations for <em>Freelancers</em> and <em>Permanent Staff</em> so that the so that the <strong>Running Salary</strong> and <strong>Weighted Average Salary</strong> calculations only consider the time when a person was a <em>Freelancer</em>, or only when they were <em>Permanent Staff</em>, or both.</li>
  <li>Freelance records could be automatically linked and created from their agency Timesheet submissions.</li>
  <li>Consideration of Public Holidays</li>
</ul>

<h2 id="dashboard---snippet">Dashboard - Snippet</h2>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-salary-inventory-table-db.png');" src="images/hr-salary-inventory-table-db.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<!-- ************************************************ -->

<!-- Trigger/Open The Modal -->
<p><button id="modalBtn-2" onclick="window.open('https://app.powerbi.com/view?r=eyJrIjoiNDhiNzliNDktZTQxZC00ZmU4LTgwZDAtY2I1ODdiMDM5YjliIiwidCI6ImE1MzNjNTc0LWNiYjMtNDBiNi04OGI4LTkzMDkyZjMyYzc0OSJ9','_blank')">Open interactive version - 2 pgs</button></p>

<!-- The Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <div class="modal-header">
      <h4>HR - Showing Employee Salaries &amp; analysing trends in Actual and Average Running (Pro-Rated) Salaries over time</h4>
      <p><span class="close">
×
</span></p>
    </div>
    <div class="modal-body">
      <!-- image inserted with JavaScript -->
    </div>
    <div class="modal-footer"></div>
  </div>
</div>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-salary-inventory-table-2-db.png');" src="images/hr-salary-inventory-table-2-db.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<div class="alert alert-warning alerts-font" role="alert">
  <p><i class="fa fa-warning"></i> <b>Important: </b>
<br />
In this report, in order to show the correct results, most tables and charts have additional Page filters applied to them too. Click the red filter bar on the side of each page, to see which filters have been applied to each table and chart.</p>
</div>

<!-- ************************************************ -->

<h2 id="data-model---snippet">Data Model - Snippet</h2>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-salary-inventory-table-dm.png');" src="images/hr-salary-inventory-table-dm.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('hr-salary-inventory-table-2-dm.png');" src="images/hr-salary-inventory-table-2-dm.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<h2 id="measures">Measures</h2>

<h3 id="salary-in-month-gbp">Salary in Month GBP</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Salary in Month GBP = 
VAR MonthlySalaryGBP =
    CALCULATE ( SUM ( &#39;Cross Joined Staff Table (DAX)&#39;[Salary in Month GBP] ) )
RETURN
    IF ( MonthlySalaryGBP = 0, BLANK (), MonthlySalaryGBP )
">
  </button>
</div>
<pre><code class="language-DAX">Salary in Month GBP = 
VAR MonthlySalaryGBP =
    CALCULATE ( SUM ( 'Cross Joined Staff Table (DAX)'[Salary in Month GBP] ) )
RETURN
    IF ( MonthlySalaryGBP = 0, BLANK (), MonthlySalaryGBP )
</code></pre>

<h3 id="running-avg-monthly-salary-gbp-pro-rated---by-job-grade">Running Avg. Monthly Salary GBP (Pro Rated) - by Job Grade</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Running Avg. Monthly Salary GBP (Pro Rated) - by Job Grade = 
VAR RunningAverageMonthlySalaryJobGrade =
    CALCULATE (
        AVERAGE ( &#39;Cross Joined Staff Table (DAX)&#39;[Running Average Salary in Month GBP by Grade] ),
        FILTER (
            &#39;Cross Joined Staff Table (DAX)&#39;,
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                = MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
        )
    )
RETURN
    IF (
        ISFILTERED ( &#39;Cross Joined Staff Table (DAX)&#39;[User ID] ),
        RunningAverageMonthlySalaryJobGrade,
        AVERAGEX (
            SUMMARIZE (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month],
                &quot;Running Average Monthly Salary by Job Grade&quot;,
                    CALCULATE (
                        AVERAGE ( &#39;Cross Joined Staff Table (DAX)&#39;[Running Average Salary in Month GBP by Grade] ),
                        FILTER (
                            &#39;Cross Joined Staff Table (DAX)&#39;,
                            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                                = MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                        )
                    )
            ),
            [Running Average Monthly Salary by Job Grade]
        )
    )
">
  </button>
</div>
<pre><code class="language-DAX">Running Avg. Monthly Salary GBP (Pro Rated) - by Job Grade = 
VAR RunningAverageMonthlySalaryJobGrade =
    CALCULATE (
        AVERAGE ( 'Cross Joined Staff Table (DAX)'[Running Average Salary in Month GBP by Grade] ),
        FILTER (
            'Cross Joined Staff Table (DAX)',
            'Cross Joined Staff Table (DAX)'[Start Date]
                = MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
        )
    )
RETURN
    IF (
        ISFILTERED ( 'Cross Joined Staff Table (DAX)'[User ID] ),
        RunningAverageMonthlySalaryJobGrade,
        AVERAGEX (
            SUMMARIZE (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Job Grade],
                'Cross Joined Staff Table (DAX)'[Start of Month],
                "Running Average Monthly Salary by Job Grade",
                    CALCULATE (
                        AVERAGE ( 'Cross Joined Staff Table (DAX)'[Running Average Salary in Month GBP by Grade] ),
                        FILTER (
                            'Cross Joined Staff Table (DAX)',
                            'Cross Joined Staff Table (DAX)'[Start Date]
                                = MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                        )
                    )
            ),
            [Running Average Monthly Salary by Job Grade]
        )
    )
</code></pre>

<h3 id="today">Today</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Today = TODAY()
">
  </button>
</div>
<pre><code class="language-DAX">Today = TODAY()
</code></pre>

<h2 id="tables">Tables</h2>

<h3 id="calendar">Calendar</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Calendar = 
VAR MinDate =
    MIN ( Min_Date[Min_Date] )
VAR MaxDate =
    MAX ( Max_Date[Max_Date] )
RETURN
    CALENDAR ( EOMONTH ( MinDate, - 1 ) + 1, EOMONTH ( MaxDate, 0 ) )
">
  </button>
</div>
<pre><code class="language-DAX">Calendar = 
VAR MinDate =
    MIN ( Min_Date[Min_Date] )
VAR MaxDate =
    MAX ( Max_Date[Max_Date] )
RETURN
    CALENDAR ( EOMONTH ( MinDate, - 1 ) + 1, EOMONTH ( MaxDate, 0 ) )
</code></pre>

<h3 id="cross-joined-staff-table-dax">Cross Joined Staff Table (DAX)</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Cross Joined Staff Table (DAX) = 
CROSSJOIN(&#39;Monthly Calendar&#39;, Inventory_Table)
">
  </button>
</div>
<pre><code class="language-DAX">Cross Joined Staff Table (DAX) = 
CROSSJOIN('Monthly Calendar', Inventory_Table)
</code></pre>

<h2 id="calculated-columns">Calculated Columns</h2>

<h3 id="weekend">Weekend</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Weekend = 
SWITCH ( WEEKDAY ( [Date] ), 1, 1, 7, 1, 0 )
">
  </button>
</div>
<pre><code class="language-DAX">Weekend = 
SWITCH ( WEEKDAY ( [Date] ), 1, 1, 7, 1, 0 )
</code></pre>

<h3 id="annual-salary-gbp">Annual Salary GBP</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Annual Salary GBP = 
&#39;Cross Joined Staff Table (DAX)&#39;[Ratio] * &#39;Cross Joined Staff Table (DAX)&#39;[FTE Salary GBP]
">
  </button>
</div>
<pre><code class="language-DAX">Annual Salary GBP = 
'Cross Joined Staff Table (DAX)'[Ratio] * 'Cross Joined Staff Table (DAX)'[FTE Salary GBP]
</code></pre>

<h3 id="count-of-months-with-salary-by-grade">Count of Months with Salary by Grade</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Count of Months with Salary by Grade = 
VAR CountofMonthswithSalary =
    CALCULATE (
        DISTINCTCOUNT ( &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month] ),
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade]
            ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
                &lt;= EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month] )
                &amp;&amp; &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service in Month (excl W/E)] &lt;&gt; 0
                &amp;&amp; &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                    &lt;= EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
        )
    )
RETURN
IF(&#39;Cross Joined Staff Table (DAX)&#39;[Days in Service (excl W/E)] = 0, BLANK(), CountofMonthswithSalary)
">
  </button>
</div>
<pre><code class="language-DAX">Count of Months with Salary by Grade = 
VAR CountofMonthswithSalary =
    CALCULATE (
        DISTINCTCOUNT ( 'Cross Joined Staff Table (DAX)'[Start of Month] ),
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Job Grade]
            ),
            'Cross Joined Staff Table (DAX)'[Start of Month]
                &lt;= EARLIER ( 'Cross Joined Staff Table (DAX)'[Start of Month] )
                &amp;&amp; 'Cross Joined Staff Table (DAX)'[Days in Service in Month (excl W/E)] &lt;&gt; 0
                &amp;&amp; 'Cross Joined Staff Table (DAX)'[Start Date]
                    &lt;= EARLIER ( 'Cross Joined Staff Table (DAX)'[Start Date] )
        )
    )
RETURN
IF('Cross Joined Staff Table (DAX)'[Days in Service (excl W/E)] = 0, BLANK(), CountofMonthswithSalary)
</code></pre>

<h3 id="days-in-service-excl-we">Days in Service (excl W/E)</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Days in Service (excl W/E) = 
VAR StartDate = [Start Date]
VAR EndDate =
    IF ( ISBLANK ( [End Date] ), TODAY (), [End Date] )
RETURN
    IF (
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] ) &lt; StartDate,
        BLANK (),
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] ) - StartDate + 1 - [Weekend Days in Service]
    )
">
  </button>
</div>
<pre><code class="language-DAX">Days in Service (excl W/E) = 
VAR StartDate = [Start Date]
VAR EndDate =
    IF ( ISBLANK ( [End Date] ), TODAY (), [End Date] )
RETURN
    IF (
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] ) &lt; StartDate,
        BLANK (),
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] ) - StartDate + 1 - [Weekend Days in Service]
    )
</code></pre>

<h3 id="days-in-service-in-month-excl-we">Days in Service in Month (excl W/E)</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Days in Service in Month (excl W/E) = 
VAR StartDate =
    MAX ( [Start Date], [Start of Month] )
VAR EndDate =
    IF ( ISBLANK ( [End Date] ), TODAY (), [End Date] )
RETURN
    IF (
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] ) &lt; StartDate,
        BLANK (),
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] ) - StartDate + 1 - [Weekend Days in Service in Month]
    )
">
  </button>
</div>
<pre><code class="language-DAX">Days in Service in Month (excl W/E) = 
VAR StartDate =
    MAX ( [Start Date], [Start of Month] )
VAR EndDate =
    IF ( ISBLANK ( [End Date] ), TODAY (), [End Date] )
RETURN
    IF (
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] ) &lt; StartDate,
        BLANK (),
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] ) - StartDate + 1 - [Weekend Days in Service in Month]
    )
</code></pre>

<h3 id="end-date-fill">End Date Fill</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
End Date Fill = 
IF ( ISBLANK ( [End Date] ), 2958100, [End Date] )
">
  </button>
</div>
<pre><code class="language-DAX">End Date Fill = 
IF ( ISBLANK ( [End Date] ), 2958100, [End Date] )
</code></pre>

<h3 id="external-join">External Join</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
External Join = 
IF(([Start Date] - [Previous End Date]) &gt; 30, &quot;Y&quot;, &quot;N&quot;)
">
  </button>
</div>
<pre><code class="language-DAX">External Join = 
IF(([Start Date] - [Previous End Date]) &gt; 30, "Y", "N")
</code></pre>

<h3 id="external-leave">External Leave</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
External Leave = 
IF(([Next Start Date] - [End Date Fill]) &gt; 30, &quot;Y&quot;, &quot;N&quot;)
">
  </button>
</div>
<pre><code class="language-DAX">External Leave = 
IF(([Next Start Date] - [End Date Fill]) &gt; 30, "Y", "N")
</code></pre>

<h3 id="internal-join">Internal Join</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Internal Join = 
IF([External Join] = &quot;Y&quot;, &quot;N&quot;, &quot;Y&quot;)
">
  </button>
</div>
<pre><code class="language-DAX">Internal Join = 
IF([External Join] = "Y", "N", "Y")
</code></pre>

<h3 id="internal-leave">Internal Leave</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Internal Leave = 
IF([External Leave] = &quot;Y&quot;, &quot;N&quot;, &quot;Y&quot;)
">
  </button>
</div>
<pre><code class="language-DAX">Internal Leave = 
IF([External Leave] = "Y", "N", "Y")
</code></pre>

<h3 id="left-in-month-">Left in Month ?</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Left in Month ? = 
IF (
    AND ( [End Date Fill] &gt;= [Start of Month], [End Date Fill] &lt;= [End of Month] ),
    &quot;Y&quot;,
    &quot;N&quot;
)
">
  </button>
</div>
<pre><code class="language-DAX">Left in Month ? = 
IF (
    AND ( [End Date Fill] &gt;= [Start of Month], [End Date Fill] &lt;= [End of Month] ),
    "Y",
    "N"
)
</code></pre>

<h3 id="next-start-date">Next Start Date</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Next Start Date =
IF (
    ISBLANK (
        CALCULATE (
            MIN ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] ),
            FILTER (
                ALLEXCEPT (
                    &#39;Cross Joined Staff Table (DAX)&#39;,
                    &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                    &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
                ),
                &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                    &gt; EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
            )
        )
    ),
    2958465,
    CALCULATE (
        MIN ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] ),
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
            ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                &gt; EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
        )
    )
)
">
  </button>
</div>
<pre><code class="language-DAX">Next Start Date =
IF (
    ISBLANK (
        CALCULATE (
            MIN ( 'Cross Joined Staff Table (DAX)'[Start Date] ),
            FILTER (
                ALLEXCEPT (
                    'Cross Joined Staff Table (DAX)',
                    'Cross Joined Staff Table (DAX)'[User ID],
                    'Cross Joined Staff Table (DAX)'[Start of Month]
                ),
                'Cross Joined Staff Table (DAX)'[Start Date]
                    &gt; EARLIER ( 'Cross Joined Staff Table (DAX)'[Start Date] )
            )
        )
    ),
    2958465,
    CALCULATE (
        MIN ( 'Cross Joined Staff Table (DAX)'[Start Date] ),
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month]
            ),
            'Cross Joined Staff Table (DAX)'[Start Date]
                &gt; EARLIER ( 'Cross Joined Staff Table (DAX)'[Start Date] )
        )
    )
)
</code></pre>

<h3 id="part-of-headcount-at-end-of-month">Part of HeadCount at End of Month</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Part of HeadCount at End of Month = 
IF (
    AND ( [Start Date] &lt;= [End of Month], [End Date Fill] &gt; [End of Month] ),
    &quot;Y&quot;,
    &quot;N&quot;
)
">
  </button>
</div>
<pre><code class="language-DAX">Part of HeadCount at End of Month = 
IF (
    AND ( [Start Date] &lt;= [End of Month], [End Date Fill] &gt; [End of Month] ),
    "Y",
    "N"
)
</code></pre>

<h3 id="part-of-headcount-at-start-of-month">Part of HeadCount at Start of Month</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Part of HeadCount at Start of Month = 
IF (
    AND ( [Start Date] &lt; [Start of Month], [End Date Fill] &gt;= [Start of Month] ),
    &quot;Y&quot;,
    &quot;N&quot;
)
">
  </button>
</div>
<pre><code class="language-DAX">Part of HeadCount at Start of Month = 
IF (
    AND ( [Start Date] &lt; [Start of Month], [End Date Fill] &gt;= [Start of Month] ),
    "Y",
    "N"
)
</code></pre>

<h3 id="part-of-headcount-start-or-end-of-month">Part of HeadCount Start or End of Month</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Part of HeadCount Start or End of Month = 
IF (
    OR (
        [Part of HeadCount at Start of Month] = &quot;Y&quot;,
        [Part of HeadCount at End of Month] = &quot;Y&quot;
    ),
    &quot;Y&quot;,
    &quot;N&quot;
)
">
  </button>
</div>
<pre><code class="language-DAX">Part of HeadCount Start or End of Month = 
IF (
    OR (
        [Part of HeadCount at Start of Month] = "Y",
        [Part of HeadCount at End of Month] = "Y"
    ),
    "Y",
    "N"
)
</code></pre>

<h3 id="previous-end-date">Previous End Date</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Previous End Date = 
IF (
    ISBLANK (
        CALCULATE (
            MAX ( [End Date Fill] ),
            FILTER (
                ALLEXCEPT (
                    &#39;Cross Joined Staff Table (DAX)&#39;,
                    &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                    &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
                ),
                [End Date Fill] &lt; EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[End Date Fill] )
            )
        )
    ),
    0,
    CALCULATE (
        MAX ( [End Date Fill] ),
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
            ),
            [End Date Fill] &lt; EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[End Date Fill] )
        )
    )
)
">
  </button>
</div>
<pre><code class="language-DAX">Previous End Date = 
IF (
    ISBLANK (
        CALCULATE (
            MAX ( [End Date Fill] ),
            FILTER (
                ALLEXCEPT (
                    'Cross Joined Staff Table (DAX)',
                    'Cross Joined Staff Table (DAX)'[User ID],
                    'Cross Joined Staff Table (DAX)'[Start of Month]
                ),
                [End Date Fill] &lt; EARLIER ( 'Cross Joined Staff Table (DAX)'[End Date Fill] )
            )
        )
    ),
    0,
    CALCULATE (
        MAX ( [End Date Fill] ),
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month]
            ),
            [End Date Fill] &lt; EARLIER ( 'Cross Joined Staff Table (DAX)'[End Date Fill] )
        )
    )
)
</code></pre>

<h3 id="running-average-salary-in-month-gbp-by-grade">Running Average Salary in Month GBP by Grade</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Running Average Salary in Month GBP by Grade = 
DIVIDE (
    &#39;Cross Joined Staff Table (DAX)&#39;[Running Total Salary in Month GBP (Pro Rated) by Grade],
    &#39;Cross Joined Staff Table (DAX)&#39;[Count of Months with Salary by Grade],
    0
)
">
  </button>
</div>
<pre><code class="language-DAX">Running Average Salary in Month GBP by Grade = 
DIVIDE (
    'Cross Joined Staff Table (DAX)'[Running Total Salary in Month GBP (Pro Rated) by Grade],
    'Cross Joined Staff Table (DAX)'[Count of Months with Salary by Grade],
    0
)
</code></pre>

<h3 id="running-total-salary-in-month-gbp-pro-rated-by-grade">Running Total Salary in Month GBP (Pro Rated) by Grade</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Running Total Salary in Month GBP (Pro Rated) by Grade = 
VAR FilteredTable =
    CALCULATETABLE (
        &#39;Cross Joined Staff Table (DAX)&#39;,
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade]
            ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
                &lt; EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month] )
                &amp;&amp; &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                    &lt;= EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                &amp;&amp; &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service in Month (excl W/E)] &lt;&gt; 0
        )
    )
VAR RunningTotalSalaryinMonth =
    SUMX (
        SUMMARIZE (
            FilteredTable,
            &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
            &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade],
            &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month],
            &quot;ValueMaxDate&quot;,
                CALCULATE (
                    AVERAGE ( &#39;Cross Joined Staff Table (DAX)&#39;[Total Weighted Salary in Month GBP (Pro Rated)] ),
                    FILTER (
                        &#39;Cross Joined Staff Table (DAX)&#39;,
                        &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                            = MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                    )
                )
        ),
        [ValueMaxDate]
    )
RETURN
    IF (
        &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service (excl W/E)] = 0,
        BLANK (),
        RunningTotalSalaryinMonth + &#39;Cross Joined Staff Table (DAX)&#39;[Total Weighted Salary in Month GBP (Pro Rated)]
    )
">
  </button>
</div>
<pre><code class="language-DAX">Running Total Salary in Month GBP (Pro Rated) by Grade = 
VAR FilteredTable =
    CALCULATETABLE (
        'Cross Joined Staff Table (DAX)',
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Job Grade]
            ),
            'Cross Joined Staff Table (DAX)'[Start of Month]
                &lt; EARLIER ( 'Cross Joined Staff Table (DAX)'[Start of Month] )
                &amp;&amp; 'Cross Joined Staff Table (DAX)'[Start Date]
                    &lt;= EARLIER ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                &amp;&amp; 'Cross Joined Staff Table (DAX)'[Days in Service in Month (excl W/E)] &lt;&gt; 0
        )
    )
VAR RunningTotalSalaryinMonth =
    SUMX (
        SUMMARIZE (
            FilteredTable,
            'Cross Joined Staff Table (DAX)'[User ID],
            'Cross Joined Staff Table (DAX)'[Job Grade],
            'Cross Joined Staff Table (DAX)'[Start of Month],
            "ValueMaxDate",
                CALCULATE (
                    AVERAGE ( 'Cross Joined Staff Table (DAX)'[Total Weighted Salary in Month GBP (Pro Rated)] ),
                    FILTER (
                        'Cross Joined Staff Table (DAX)',
                        'Cross Joined Staff Table (DAX)'[Start Date]
                            = MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                    )
                )
        ),
        [ValueMaxDate]
    )
RETURN
    IF (
        'Cross Joined Staff Table (DAX)'[Days in Service (excl W/E)] = 0,
        BLANK (),
        RunningTotalSalaryinMonth + 'Cross Joined Staff Table (DAX)'[Total Weighted Salary in Month GBP (Pro Rated)]
    )
</code></pre>

<h3 id="salary-in-month-gbp-1">Salary in Month GBP</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Salary in Month GBP = 
VAR DaysinMonth = [End of Month] - [Start of Month] + 1
VAR WeekendDaysinMonth =
    CALCULATE (
        SUM ( &#39;Calendar&#39;[Weekend] ),
        DATESBETWEEN (
            &#39;Calendar&#39;[Date],
            &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month],
            &#39;Cross Joined Staff Table (DAX)&#39;[End of Month]
        )
    )
RETURN
    [Annual Salary GBP] * ( 1 / 12 )
        * DIVIDE (
            [Days in Service in Month (excl W/E)],
             ( DaysinMonth - WeekendDaysinMonth ),
            0
        )
">
  </button>
</div>
<pre><code class="language-DAX">Salary in Month GBP = 
VAR DaysinMonth = [End of Month] - [Start of Month] + 1
VAR WeekendDaysinMonth =
    CALCULATE (
        SUM ( 'Calendar'[Weekend] ),
        DATESBETWEEN (
            'Calendar'[Date],
            'Cross Joined Staff Table (DAX)'[Start of Month],
            'Cross Joined Staff Table (DAX)'[End of Month]
        )
    )
RETURN
    [Annual Salary GBP] * ( 1 / 12 )
        * DIVIDE (
            [Days in Service in Month (excl W/E)],
             ( DaysinMonth - WeekendDaysinMonth ),
            0
        )
</code></pre>

<h3 id="salary-in-month-gbp-pro-rated">Salary in Month GBP (Pro Rated)</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Salary in Month GBP (Pro Rated) = 
VAR DaysinMonth = [End of Month] - [Start of Month] + 1
VAR WeekendDaysinMonth =
    CALCULATE (
        SUM ( &#39;Calendar&#39;[Weekend] ),
        DATESBETWEEN (
            &#39;Calendar&#39;[Date],
            &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month],
            &#39;Cross Joined Staff Table (DAX)&#39;[End of Month]
        )
    )
VAR SalaryinMonth =
    &#39;Cross Joined Staff Table (DAX)&#39;[Salary in Month GBP]
        * DIVIDE (
             ( DaysinMonth - WeekendDaysinMonth ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service in Month (excl W/E)],
            0
        )
RETURN
    IF (
        &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service in Month (excl W/E)] = 0,
        BLANK (),
        SalaryinMonth
    )
">
  </button>
</div>
<pre><code class="language-DAX">Salary in Month GBP (Pro Rated) = 
VAR DaysinMonth = [End of Month] - [Start of Month] + 1
VAR WeekendDaysinMonth =
    CALCULATE (
        SUM ( 'Calendar'[Weekend] ),
        DATESBETWEEN (
            'Calendar'[Date],
            'Cross Joined Staff Table (DAX)'[Start of Month],
            'Cross Joined Staff Table (DAX)'[End of Month]
        )
    )
VAR SalaryinMonth =
    'Cross Joined Staff Table (DAX)'[Salary in Month GBP]
        * DIVIDE (
             ( DaysinMonth - WeekendDaysinMonth ),
            'Cross Joined Staff Table (DAX)'[Days in Service in Month (excl W/E)],
            0
        )
RETURN
    IF (
        'Cross Joined Staff Table (DAX)'[Days in Service in Month (excl W/E)] = 0,
        BLANK (),
        SalaryinMonth
    )
</code></pre>

<h3 id="started-in-month-">Started in Month ?</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Started in Month ? = 
IF (
    AND ( [Start Date] &gt;= [Start of Month], [Start Date] &lt;= [End of Month] ),
    &quot;Y&quot;,
    &quot;N&quot;
)
">
  </button>
</div>
<pre><code class="language-DAX">Started in Month ? = 
IF (
    AND ( [Start Date] &gt;= [Start of Month], [Start Date] &lt;= [End of Month] ),
    "Y",
    "N"
)
</code></pre>

<h3 id="total-weighted-salary-in-month-gbp-pro-rated">Total Weighted Salary in Month GBP (Pro Rated)</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Total Weighted Salary in Month GBP (Pro Rated) = 
VAR MaxStartDatePreviousGrade =
    CALCULATE (
        MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] ),
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
            ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                &lt; EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                &amp;&amp; &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade]
                    &lt;&gt; EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade] )
        )
    )
VAR StartDateBeforePreviousGradeChange =
    CALCULATE (
        MIN ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] ),
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
            ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] &gt; MaxStartDatePreviousGrade
        )
    )
VAR NextStartDateSameGrade =
    CALCULATE (
        MIN ( [Start Date] ),
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
            ),
            [Start Date] &gt; MIN ( [Start Date] )
        )
    )
VAR MinStartDateNextGrade =
    CALCULATE (
        MIN ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] ),
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
            ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                &gt; EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
                &amp;&amp; &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade]
                    &lt;&gt; EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade] )
        )
    )
VAR EndDateBeforeNextGradeChange =
    CALCULATE (
        MAX ( &#39;Cross Joined Staff Table (DAX)&#39;[End Date] ),
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
            ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] &lt; MinStartDateNextGrade
        )
    )
VAR EndDate =
    IF (
        NextStartDateSameGrade &gt; [End of Month],
        EndDateBeforeNextGradeChange,
        [End Date]
    )
VAR RunningDaysinMonthfromParticularGrade =
    IF (
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] )
            &lt; MAX ( StartDateBeforePreviousGradeChange, [Start of Month] ) + 1,
        BLANK (),
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] )
            - MAX ( StartDateBeforePreviousGradeChange, [Start of Month] ) + 1
    )
VAR RunningWeekendDaysinMonthfromParticularGrade =
    IF (
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] )
            &lt; MAX ( StartDateBeforePreviousGradeChange, [Start of Month] ) + 1,
        BLANK (),
        CALCULATE (
            SUM ( &#39;Calendar&#39;[Weekend] ),
            DATESBETWEEN (
                &#39;Calendar&#39;[Date],
                MAX (
                    StartDateBeforePreviousGradeChange,
                    &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
                ),
                MIN (
                    MIN ( TODAY (), EndDate ),
                    &#39;Cross Joined Staff Table (DAX)&#39;[End of Month]
                )
            )
        )
    )
VAR TotalWeightedSalary =
    CALCULATE (
        SUMX (
            &#39;Cross Joined Staff Table (DAX)&#39;,
            [Salary in Month GBP (Pro Rated)] * [Days in Service in Month (excl W/E)]
        ),
        FILTER (
            ALLEXCEPT (
                &#39;Cross Joined Staff Table (DAX)&#39;,
                &#39;Cross Joined Staff Table (DAX)&#39;[User ID],
                &#39;Cross Joined Staff Table (DAX)&#39;[Job Grade],
                &#39;Cross Joined Staff Table (DAX)&#39;[Start of Month]
            ),
            &#39;Cross Joined Staff Table (DAX)&#39;[Start Date]
                &lt;= EARLIER ( &#39;Cross Joined Staff Table (DAX)&#39;[Start Date] )
        )
    )
RETURN
    IF (
        &#39;Cross Joined Staff Table (DAX)&#39;[Days in Service in Month (excl W/E)] = 0,
        BLANK (),
        DIVIDE (
            TotalWeightedSalary,
            RunningDaysinMonthfromParticularGrade - RunningWeekendDaysinMonthfromParticularGrade,
            0
        )
    )
">
  </button>
</div>
<pre><code class="language-DAX">Total Weighted Salary in Month GBP (Pro Rated) = 
VAR MaxStartDatePreviousGrade =
    CALCULATE (
        MAX ( 'Cross Joined Staff Table (DAX)'[Start Date] ),
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month]
            ),
            'Cross Joined Staff Table (DAX)'[Start Date]
                &lt; EARLIER ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                &amp;&amp; 'Cross Joined Staff Table (DAX)'[Job Grade]
                    &lt;&gt; EARLIER ( 'Cross Joined Staff Table (DAX)'[Job Grade] )
        )
    )
VAR StartDateBeforePreviousGradeChange =
    CALCULATE (
        MIN ( 'Cross Joined Staff Table (DAX)'[Start Date] ),
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month]
            ),
            'Cross Joined Staff Table (DAX)'[Start Date] &gt; MaxStartDatePreviousGrade
        )
    )
VAR NextStartDateSameGrade =
    CALCULATE (
        MIN ( [Start Date] ),
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Job Grade],
                'Cross Joined Staff Table (DAX)'[Start of Month]
            ),
            [Start Date] &gt; MIN ( [Start Date] )
        )
    )
VAR MinStartDateNextGrade =
    CALCULATE (
        MIN ( 'Cross Joined Staff Table (DAX)'[Start Date] ),
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month]
            ),
            'Cross Joined Staff Table (DAX)'[Start Date]
                &gt; EARLIER ( 'Cross Joined Staff Table (DAX)'[Start Date] )
                &amp;&amp; 'Cross Joined Staff Table (DAX)'[Job Grade]
                    &lt;&gt; EARLIER ( 'Cross Joined Staff Table (DAX)'[Job Grade] )
        )
    )
VAR EndDateBeforeNextGradeChange =
    CALCULATE (
        MAX ( 'Cross Joined Staff Table (DAX)'[End Date] ),
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Start of Month]
            ),
            'Cross Joined Staff Table (DAX)'[Start Date] &lt; MinStartDateNextGrade
        )
    )
VAR EndDate =
    IF (
        NextStartDateSameGrade &gt; [End of Month],
        EndDateBeforeNextGradeChange,
        [End Date]
    )
VAR RunningDaysinMonthfromParticularGrade =
    IF (
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] )
            &lt; MAX ( StartDateBeforePreviousGradeChange, [Start of Month] ) + 1,
        BLANK (),
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] )
            - MAX ( StartDateBeforePreviousGradeChange, [Start of Month] ) + 1
    )
VAR RunningWeekendDaysinMonthfromParticularGrade =
    IF (
        MIN ( MIN ( TODAY (), EndDate ), [End of Month] )
            &lt; MAX ( StartDateBeforePreviousGradeChange, [Start of Month] ) + 1,
        BLANK (),
        CALCULATE (
            SUM ( 'Calendar'[Weekend] ),
            DATESBETWEEN (
                'Calendar'[Date],
                MAX (
                    StartDateBeforePreviousGradeChange,
                    'Cross Joined Staff Table (DAX)'[Start of Month]
                ),
                MIN (
                    MIN ( TODAY (), EndDate ),
                    'Cross Joined Staff Table (DAX)'[End of Month]
                )
            )
        )
    )
VAR TotalWeightedSalary =
    CALCULATE (
        SUMX (
            'Cross Joined Staff Table (DAX)',
            [Salary in Month GBP (Pro Rated)] * [Days in Service in Month (excl W/E)]
        ),
        FILTER (
            ALLEXCEPT (
                'Cross Joined Staff Table (DAX)',
                'Cross Joined Staff Table (DAX)'[User ID],
                'Cross Joined Staff Table (DAX)'[Job Grade],
                'Cross Joined Staff Table (DAX)'[Start of Month]
            ),
            'Cross Joined Staff Table (DAX)'[Start Date]
                &lt;= EARLIER ( 'Cross Joined Staff Table (DAX)'[Start Date] )
        )
    )
RETURN
    IF (
        'Cross Joined Staff Table (DAX)'[Days in Service in Month (excl W/E)] = 0,
        BLANK (),
        DIVIDE (
            TotalWeightedSalary,
            RunningDaysinMonthfromParticularGrade - RunningWeekendDaysinMonthfromParticularGrade,
            0
        )
    )
</code></pre>

<h3 id="weekend-days-in-service">Weekend Days in Service</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Weekend Days in Service = 
VAR StartDate = [Start Date]
VAR EndDate =
    IF ( ISBLANK ( [End Date] ), TODAY (), [End Date] )
RETURN
    IF (
        MIN (
            MIN ( TODAY (), EndDate ),
            &#39;Cross Joined Staff Table (DAX)&#39;[End of Month]
        ) &lt; StartDate,
        BLANK (),
        CALCULATE (
            SUM ( &#39;Calendar&#39;[Weekend] ),
            DATESBETWEEN (
                &#39;Calendar&#39;[Date],
                StartDate,
                MIN (
                    MIN ( TODAY (), EndDate ),
                    &#39;Cross Joined Staff Table (DAX)&#39;[End of Month]
                )
            )
        )
    )
">
  </button>
</div>
<pre><code class="language-DAX">Weekend Days in Service = 
VAR StartDate = [Start Date]
VAR EndDate =
    IF ( ISBLANK ( [End Date] ), TODAY (), [End Date] )
RETURN
    IF (
        MIN (
            MIN ( TODAY (), EndDate ),
            'Cross Joined Staff Table (DAX)'[End of Month]
        ) &lt; StartDate,
        BLANK (),
        CALCULATE (
            SUM ( 'Calendar'[Weekend] ),
            DATESBETWEEN (
                'Calendar'[Date],
                StartDate,
                MIN (
                    MIN ( TODAY (), EndDate ),
                    'Cross Joined Staff Table (DAX)'[End of Month]
                )
            )
        )
    )
</code></pre>

<h3 id="weekend-days-in-service-in-month">Weekend Days in Service in Month</h3>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: DAX">DAX</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Weekend Days in Service in Month = 
VAR StartDate =  MAX ( [Start Date], [Start of Month] )
VAR EndDate =
    IF ( ISBLANK ( [End Date] ), TODAY (), [End Date] )
RETURN
    IF (
        MIN (
            MIN ( TODAY (), EndDate ),
            &#39;Cross Joined Staff Table (DAX)&#39;[End of Month]
        ) &lt; StartDate,
        BLANK(),
        CALCULATE (
            SUM ( &#39;Calendar&#39;[Weekend] ),
            DATESBETWEEN (
                &#39;Calendar&#39;[Date],
                StartDate,
                MIN (
                    MIN ( TODAY (), EndDate ),
                    &#39;Cross Joined Staff Table (DAX)&#39;[End of Month]
                )
            )
        )
    )
">
  </button>
</div>
<pre><code class="language-DAX">Weekend Days in Service in Month = 
VAR StartDate =  MAX ( [Start Date], [Start of Month] )
VAR EndDate =
    IF ( ISBLANK ( [End Date] ), TODAY (), [End Date] )
RETURN
    IF (
        MIN (
            MIN ( TODAY (), EndDate ),
            'Cross Joined Staff Table (DAX)'[End of Month]
        ) &lt; StartDate,
        BLANK(),
        CALCULATE (
            SUM ( 'Calendar'[Weekend] ),
            DATESBETWEEN (
                'Calendar'[Date],
                StartDate,
                MIN (
                    MIN ( TODAY (), EndDate ),
                    'Cross Joined Staff Table (DAX)'[End of Month]
                )
            )
        )
    )
</code></pre>

                        
                        
                    </main>	
                    
                        <!-- Start of Feedback section -->
<section class="feedback-section is-relative">
    <h2 id="feedback" class="is-size-2 has-margin-top-large has-padding-top-medium"> Feedback </h2>
    <div class="feedback has-margin-top-small has-margin-bottom-none">
        <p id="send-feedback-about" class="has-margin-top-none has-margin-bottom-none">
            Submit and view feedback
        </p>
        <div id="feedback-section-link" class="has-margin-top-large has-margin-bottom-none">
            <a class="button has-margin-bottom-small" href="" target="_blank">
                <span class="icon">
                    <span class=github>
                        <i class="fab fa-github"></i>
                    </span>
                </span>
                <span>This page</span>
            </a>
        </div>
    </div>
    <div id="viewallfeedback-section-link" class="is-flex has-flex-justify-content-end has-margin-top-small has-margin-bottom-medium">
        <a class="view-on-github" href="" target="_blank">
            <span class="icon">
                <span class=github>
                    <i class="fab fa-github"></i>
                </span>
            </span><span>View all page feedback</span>
        </a>
    </div>
</section>

<!-- End of Feedback section -->
                    
                </div>

                
                 <!-- Right Hand Side Toc-->
                 <div class="right-sidebar column is-one-quarter is-one-fifth-desktop is-hidden-mobile is-hidden-tablet-only">
                    <nav class="doc-outline is-fixed is-vertically-scrollable", id="affixed-right-sidebar">
                        <nav id="side-doc-outline">
                            <header id="side-doc-title" class = "is-flex is-flex-row">
                                <div>
                                    <a href="#top">
                                        <h3 title="Go to Top of Page">
                                            <i class="fas fa-file-alt" style="color:#e82127;">&nbsp;</i>
                                            In this article
                                        </h3>
                                    </a>
                                </div>
                            </header>
                            <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#hr---showing-employee-salaries--analysing-trends-in-actual-and-average-running-pro-rated-salaries-over-time-1">HR - Showing Employee Salaries &amp; analysing trends in Actual and Average Running (Pro-Rated) Salaries over time</a>
<ul>
<li class="toc-entry toc-h3"><a href="#running-average-monthly-salary-methodology">Running Average Monthly Salary Methodology</a></li>
<li class="toc-entry toc-h3"><a href="#worked-example">Worked Example</a></li>
<li class="toc-entry toc-h3"><a href="#other-measures">Other Measures</a></li>
<li class="toc-entry toc-h3"><a href="#enhancements">Enhancements</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#model-extensions">Model Extensions</a></li>
<li class="toc-entry toc-h2"><a href="#dashboard---snippet">Dashboard - Snippet</a></li>
<li class="toc-entry toc-h2"><a href="#data-model---snippet">Data Model - Snippet</a></li>
<li class="toc-entry toc-h2"><a href="#measures">Measures</a>
<ul>
<li class="toc-entry toc-h3"><a href="#salary-in-month-gbp">Salary in Month GBP</a></li>
<li class="toc-entry toc-h3"><a href="#running-avg-monthly-salary-gbp-pro-rated---by-job-grade">Running Avg. Monthly Salary GBP (Pro Rated) - by Job Grade</a></li>
<li class="toc-entry toc-h3"><a href="#today">Today</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#tables">Tables</a>
<ul>
<li class="toc-entry toc-h3"><a href="#calendar">Calendar</a></li>
<li class="toc-entry toc-h3"><a href="#cross-joined-staff-table-dax">Cross Joined Staff Table (DAX)</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#calculated-columns">Calculated Columns</a>
<ul>
<li class="toc-entry toc-h3"><a href="#weekend">Weekend</a></li>
<li class="toc-entry toc-h3"><a href="#annual-salary-gbp">Annual Salary GBP</a></li>
<li class="toc-entry toc-h3"><a href="#count-of-months-with-salary-by-grade">Count of Months with Salary by Grade</a></li>
<li class="toc-entry toc-h3"><a href="#days-in-service-excl-we">Days in Service (excl W/E)</a></li>
<li class="toc-entry toc-h3"><a href="#days-in-service-in-month-excl-we">Days in Service in Month (excl W/E)</a></li>
<li class="toc-entry toc-h3"><a href="#end-date-fill">End Date Fill</a></li>
<li class="toc-entry toc-h3"><a href="#external-join">External Join</a></li>
<li class="toc-entry toc-h3"><a href="#external-leave">External Leave</a></li>
<li class="toc-entry toc-h3"><a href="#internal-join">Internal Join</a></li>
<li class="toc-entry toc-h3"><a href="#internal-leave">Internal Leave</a></li>
<li class="toc-entry toc-h3"><a href="#left-in-month-">Left in Month ?</a></li>
<li class="toc-entry toc-h3"><a href="#next-start-date">Next Start Date</a></li>
<li class="toc-entry toc-h3"><a href="#part-of-headcount-at-end-of-month">Part of HeadCount at End of Month</a></li>
<li class="toc-entry toc-h3"><a href="#part-of-headcount-at-start-of-month">Part of HeadCount at Start of Month</a></li>
<li class="toc-entry toc-h3"><a href="#part-of-headcount-start-or-end-of-month">Part of HeadCount Start or End of Month</a></li>
<li class="toc-entry toc-h3"><a href="#previous-end-date">Previous End Date</a></li>
<li class="toc-entry toc-h3"><a href="#running-average-salary-in-month-gbp-by-grade">Running Average Salary in Month GBP by Grade</a></li>
<li class="toc-entry toc-h3"><a href="#running-total-salary-in-month-gbp-pro-rated-by-grade">Running Total Salary in Month GBP (Pro Rated) by Grade</a></li>
<li class="toc-entry toc-h3"><a href="#salary-in-month-gbp-1">Salary in Month GBP</a></li>
<li class="toc-entry toc-h3"><a href="#salary-in-month-gbp-pro-rated">Salary in Month GBP (Pro Rated)</a></li>
<li class="toc-entry toc-h3"><a href="#started-in-month-">Started in Month ?</a></li>
<li class="toc-entry toc-h3"><a href="#total-weighted-salary-in-month-gbp-pro-rated">Total Weighted Salary in Month GBP (Pro Rated)</a></li>
<li class="toc-entry toc-h3"><a href="#weekend-days-in-service">Weekend Days in Service</a></li>
<li class="toc-entry toc-h3"><a href="#weekend-days-in-service-in-month">Weekend Days in Service in Month</a></li>
</ul>
</li>
</ul>
                        </nav>

                        <!-- Fixed Element-->
                        <div>
                            <a class="top-link hide" href="" id="js-top" title="Go to Top of Page">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg>
                            </a>
                        </div>
                    </nav>
                </div>
                
            </div>
            <!-- end of /.columns -->
        </div>	
        <!-- end of /primary holder -->

    </div>
    <!-- end of /.columns -->
</div>
<!-- end of /.mainContainer -->
			<!-- Footer Container --> 
<div class="footerContainer">

    
    

    <footer id="footer" class=" footer-layout   uhf-container has-padding">
        <div class="">
            <a href="https://startech-enterprises.github.io/docs/">
                <img src="/../docs/assets/images/starbase_logo.png" class="footer-bar-logo">
            </a>
        </div>
        <div class="is-flex is-full-height has-padding-right-extra-large-desktop has-padding-left-extra-large-desktop">
            <a class="locale-selector-link has-flex-shrink-none" href="/../">
                <span class="icon">
                    <span><i class="fas fa-globe"></i></span>
                </span>
                <span class="locale-selector-link-text">English (United Kingdom)</span>
            </a>
        </div>
        <ul class="links">
            <li>
                <a href="/docs/">Docs</a>
            </li>
            <li>
                <a href="/docs/">Guides</a>
            </li>
            <li>
                <a href="/docs/articles-and-blogs/article-search.html">Articles & Blogs</a>
            </li>
            <li>
                <a href="/docs/videos/">Videos</a>
            </li>
            <li>
                <a href="/docs/about/about.html">About</a>
            </li>
            <li>
                <a href="https://www.linkedin.com/company/startech-enterprises/" target="_blank">LinkedIn</a>
            </li>
            <li style="color: #e82127;">
                <span class="icon">
                    <span> <i class="fas fa-star"></i></span>
                </span>Star Base 2020
            </li>
        </ul>
    </footer>
</div>
<!-- end of / footerContainer -->
	</body>
		<!-- Reference to main JavaScript Files -->
<script src="/../docs/assets/js/library.js" type="application/javascript"></script>
<script src="/../docs/assets/js/breadCrumb.js" type="application/javascript"></script>
<script src="/../docs/assets/js/navbar.js" type="application/javascript"></script>
<script src="/../docs/assets/js/affix.js" type="application/javascript"></script>
<script src="/../docs/assets/js/rhsToc.js" type="application/javascript"></script>




<script src="/../docs/assets/js/scrollTop.js" type="application/javascript"></script>
<script src="/../docs/assets/js/gitFeedback.js" type="application/javascript"></script>
<script src="/../docs/assets/js/copyCode.js" type="application/javascript"></script>
</html>
