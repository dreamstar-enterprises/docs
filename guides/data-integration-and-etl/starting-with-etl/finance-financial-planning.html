<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-176158185-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-176158185-1');
</script>

		<title>Finance - Financial Planning | StarBase </title>
		<!-- link to website tab icon -->
		<link rel="shortcut icon" type="image/x-icon" href="/../docs/assets/images/alt-logo-star-tilted.png">
		<!-- link to Main Stylesheets -->
		<link rel="stylesheet" type="text/css" href="/../docs/assets/css/styles.css">
		<!-- link to Google Fonts -->
		<link href='https://fonts.googleapis.com/css?family=Zilla Slab' rel='stylesheet'>
		<link href="https://fonts.googleapis.com/css2?family=Marcellus&display=swap" rel="stylesheet"> 
		<link href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro&display=swap" rel="stylesheet"> 
		<link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@200..400&display=swap" rel="stylesheet">
		<!-- link to Font awesome -->
		<script src="https://kit.fontawesome.com/378306bc97.js" crossorigin="anonymous"></script>
		<!-- link to Material Icons -->
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<!-- link to Iconify CDN -->
		<script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
		<!-- link to UUID -->	
		<script src="https://cdnjs.cloudflare.com/ajax/libs/uuid/8.1.0/uuidv5.min.js"></script>
	</head>
	<body>
		<a id="top"></a>
			<!-- Header Holder --> 

<div class="header-holder has-default-focus"
  
  >
    <div class="nav-bar">
        <!---->
        <a class="nav-bar-button has-padding-left-medium has-padding-left-none-tablet" href="https://sachin1882.wixsite.com/startechenterprises/guides" title="Go to parent site: StarTech Enterprises">
            <div class="nav-bar-logo has-background-image">
                <img src="https://fontmeme.com/permalink/200623/587d8aec23ed76c10e0b1ec43bc85f23.png" class="alt-logo has-background-image" width="180" height ="70">
                <div class="overlay">
                    <img src="/../docs/assets/images/starbase_logo.png" class="nav-bar-logo">
                </div>
            </div>
        </a>
        <nav class="nav-bar-nav">
            <ul class="nav-bar-nav-list">
                <li class="nav-bar-item is-category has-spacing">
                    <a class = "nav-bar-button title has-hover-underline is-6 
                    
                    
                    " href="/docs/">
                        <span>
                            <!---->
                            Docs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    underline
                    
                    " href="/docs/">
                        <span>
                            <!---->
                            Guides
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    
                    " href="/docs/articles-and-blogs/article-search.html">
                        <span>
                            <!---->
                            Articles & Blogs
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline" href="/docs/videos/">
                        <span>
                            <!---->
                            Videos
                            <!---->
                        </span>
                    </a>
                </li>
                <li class="nav-bar-item">
                    <a class = "nav-bar-button has-hover-underline 
                    
                    
                    " href="/docs/about/about.html">
                        <span>
                            <!---->
                            About
                            <!---->
                        </span>
                    </a>
                </li>
            </ul>
        </nav>
        <span class = "nav-bar-spacer i-hidden-mobile"></span>
        <!---->
    </div>
</div>


<div class="header-holder transparent has-default-focus" style="position: sticky; top: 0; left: 0; right: 0;">
    <div class="content-header uhf-container has-padding has-default-focus is-flexbox" style="padding-top: 0px; padding-bottom: 1px;">
        
<!-- Get correct Breadcrumb Links from Front Matter of loaded page-->

<!-- Liquid Code -->
    <!-- Page Root -->
    

    <!-- Page Type -->
    

    <!-- Page Category -->
    

    <!-- Page Series -->
    
<!-- / End of Liquid Code -->


<!-- Breadcrumb Links --> 
<nav class = "has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop has-flex-grow">
    <ul id="page-breadcrumbs" class="breadcrumbs">
        <li><a href="/docs/"><span class ="">Docs</span></a></li>
        <li><a href="/docs/"><span class ="">Guides</span></a></li>
        <li><a href="/docs/guides/data-integration-and-etl/etl.html"><span class="">Data Integration & ETL</span></a></li>
        <li><a href=/docs/guides/data-integration-and-etl/starting-with-etl/overview.html><span class="">Starting with ETL</span></a></li>

        <!-- This part needs to be generated by JavaScript-->

    </ul>
</nav>
<!-- end of / Breadcrumb links -->




        <!-- Page Functions --> 

<div class="has-padding-none-tablet has-padding-medium is-size-7 is-flex-touch has-flex-justify-content-space-between-touch has-flex-grow">
    <ul class="is-hidden-mobile action-list has-flex-justify-content-end-tablet is-flex is-flex-row has-flex-wrap has-flex-grow is-unstyled">
        <li>
            <button class="print button is-text has-inner-focus is-small is-icon-only-touch colorfill" type="button" title="Print this page" onclick="window.print()">
                <span class="icon">
                    <span class="iconify extra-small" data-icon="el:print" data-inline="false"></span>                </span>
                <span class="is-visually-hidden-touch is-hidden-portrait">Print</span>
            </button>
        </li>
        <li>
            <button class="button is-text has-inner-focus is-small is-icon-only-touch colorfill" title="Send feedback about this page" onclick="location.href='#feedback'">
                <span class="icon">
                    <i class="fas fa-comments"></i>
                </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Feedback</span>
            </button>
        </li>
        <li id="share-menu-link">
            <div class = "sharing dropdown has-caret">
                <button class="dropdown-trigger button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small is-icon-only-touch colorfill" title="Share This Document">
                    <span class="icon">
                        <span class="iconify extra-small" data-icon="ls:share" data-inline="false"></span>
                    </span>
                    <span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
                </button>
                <div id="sharing-menu" class="sharing-menu has-padding-small is-hidden">
                    <ul>
                        <li id="twitter-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-twitter" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-twitter colorfill"></i>
                                </span>
                                <span>Twitter</span>
                            </a>
                        </li>
                        <li id="linkedin-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-linkedin" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-linkedin-in colorfill"></i>
                                </span>
                                <span>LinkedIn</span>
                            </a>
                        </li>
                        <li id="facebook-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-facebook" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fab fa-facebook-f colorfill"></i>
                                </span>
                                <span>Facebook</span>
                            </a>
                        </li>
                        <li id="email-link">
                            <a class="button is-text is-fullwidth has-flex-justify-content-start has-inner-focus is-small share-email" href="" target="_blank">
                                <span class="icon effect">
                                    <i class="fas fa-envelope colorfill"></i>
                                </span>
                                <span>Email</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </li>
    </ul>
</div>

<!-- end of / Page Functions -->
    </div>
    <div class="progress-container">
        <div class="progress-bar-scroll" id="myBar"></div>
    </div>
</div>

<!-- end of /.header-holder -->
			<!-- Main Container --> 
<div class="mainContainer uhf-container  has-top-padding ">
    <div class="columns has-large-gaps is-gapless-mobile ">

        
        <!-- Left Hand Side Tree-->
        <div class="left-sidebar column is-hidden-mobile 
         
        is-one-third-tablet is-one-quarter-desktop 
        ">
            <nav class ="is-fixed is-flex is-flex-column" id="affixed-left-sidebar">

                <!-- Include LHS Menu -->
                
                <form class = "has-margin-bottom-small" action="javascript:" role="search">
                    <label class="visually-hidden">Search</label>
                    <div class="searchFilter is-block">
                        <div class="control has-icons-left">
                            <input id="searchFilter" class="searchFilter-input input control has-icons-left is-full-width is-small" role="combobox" maxlength="100" autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" placeholder="Filter by title" type="text">
                            <span class="icon is-small is-left">
                                <img src="/../docs/assets/images/filter.png" class="filter-icon">
                            </span>
                        </div>
                        <ul class="searchFilter-suggestions is-vertically-scrollable is-hidden"></ul>
                    </div>
                </form>

                <ul class="toc is-vertically-scrollable has-flex-grow has-flex-shrink">
                    <!-- Menu Series -->
                    
                    
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Introduction</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/overview.html">Overview</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Working with Data Tables</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/grouping-tables-with-stats.html">Grouping tables (Summary Statistics)</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/grouping-tables-with-rd.html">Grouping tables (Row Details)</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/grouping-tables-with-duplicates.html">Grouping tables (Duplicates)</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/grouping-tables-with-rankings.html">Grouping tables (Rankings)</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/grouping-tables-multi-single.html">Grouping tables (Multi to Single row)</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/cross-joining-tables.html">Cross-Joining tables</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/transition-tables.html">Using Transition tables</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/self-referencing-tables.html">Using Self-Referencing tables</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/renaming-table-headings.html">Renaming table headings</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Pivoting Data</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/queries-with-pivot-tables.html">Queries as a Pivot Table data source</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/pivoting-text-data.html">Pivoting text data</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/pivoting-text-data-adv.html">Pivoting text data (advanced)</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/pivoting-multiple-measures.html">Pivoting on multiple measures</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/pivoting-data-validation.html">Pivoting data to enable validation</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Filtering Data</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/filtering-rows-m.html">Dynamically filtering rows with 'M'</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/removing-duplicate-rows.html">Removing duplicate rows</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/filtering-using-lists.html">Filtering data with list inputs</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/dynamically-removing-columns.html">Dynamically removing columns</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/dynamically-expanding-columns.html">Dynamically expanding columns</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Transforming Data</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/reordering-columns.html">Re-ordering columns</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/selecting-removing-columns.html">Selecting & Removing columns</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/renaming-columns.html">Renaming columns</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/splitting-columns.html">Splitting columns</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/merging-columns.html">Merging columns</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/changing-data-types.html">Changing Data Types</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Conditional Logic</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/conditional-columns.html">Creating conditional columns</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/logical-operators.html">Applying OR, AND, and SWITCH logic</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/nesting-operators.html">Nesting conditional & logical operators</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Functions & Parameters</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/excel-parameters-pq.html">Excel parameters in Power Query</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/custom-functions.html">Custom functions</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/parameter-tables.html">Parameter tables</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/recursive-functions.html">Recursive functions</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/running-total.html">Running Total functions</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/working-days.html">Working Day functions</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Calendar Tables & Dates</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/date-table.html">Generating a Date table</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/554-calendar.html">Creating a 554 calendar</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/monthly-weekly-budget.html">Monthly to weekly budget</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/filling-dates.html">Filling in dates</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Importing Single File data</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/importing-data-pdf.html">Importing data from a pdf</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/importing-data-pdf-new.html">Importing data from a pdf - new</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/first-sheet.html">Importing the first sheet in a workbook</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/latest-version.html">Loading the latest version of a file</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/combining-sheets.html">Combining workbook sheets</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Importing Multiple File data</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/combining-workbooks-function.html">Combining a single sheet across workbooks (with function)</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/combining-workbooks.html">Combining a single sheet across workbooks (no function)</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/multiple-sheets-workbooks.html">Combining multiple sheets across workbooks</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Getting Network / Web Data</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/web-weather-data.html">Web weather data</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/one-drive-personal.html">One-Drive Personal</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Practical Applications</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/new-lost-returning-customers.html">New, lost, and returning customers</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/distinct-customers.html">Number of distinct customers</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/stock-price-thresholds.html">Stock price thresholds</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/percentage-shares.html">Calculating percentage shares</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/tied-ranks.html">Calculating tied ranks</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/growth-percentages.html">Growth percentages from previous days</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/comparing-records.html">Comparing database records</a></li>
    
          
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Human Resourcing</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/hr-onboarding.html">HR - On-boarding</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/hr-inventory-table.html">HR - Inventory Movements & Tenure</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/hr-inventory-utilisation-table.html">HR - Inventory Utilisation</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Finance</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/finance-daily-cashflows.html">Finance - Daily Cashflows</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/finance-payroll-tracking.html">Finance - Payroll Tracking</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/finance-profitability.html">Finance - Client Profitability</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/finance-debtors.html">Finance - Debtors</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/finance-financial-planning.html">Finance - Financial Planning</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Quality Checking & Maintenance</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/bulk-refreshing.html">Bulk refreshing workbooks</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/auditing-tool.html">Creating an Auditing tool</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/cleaning-data.html">Cleaning data</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/error-handling.html">Error Handling</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
    
      <li class="treeitem"><span class="tree-expander"><span class="tree-indicator"><img src="/../docs/assets/images/chevron.png" class="chevron"></span>Query Design</span></li>
    
        
          
<!-- Left Hand Side Tree --> 
<ul class="treegroup">
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/best-practices.html">ETL Best Practices</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/shaping-vs-modelling.html">Shaping vs Modelling</a></li>
    
          
        
      </li>
  
    
      <li class="none"><a href="/docs/guides/data-integration-and-etl/starting-with-etl/query-folding.html">Query Folding</a></li>
    
          
        
      </li>
  
</ul>
        
      </li>
  
</ul>
                </ul>

                <!-- Include the Correct Back Button -->
                
            </nav>
        </div>
         <!-- end of /left hand side tree -->
        

        <!-- Primary Holder -->    
        <div class="primary-holder column 
          
        is-two-thirds-tablet is-three-quarters-desktop 
        ">
            <div class="columns has-large-gaps is-gapless-mobile 
            
            ">

                 <!-- Main Column -->
                <div id="main-column" class="column 
                 
                is-full is-four-fifths-desktop 
                ">
                    <main id="main" class ="
                    
                        content docs
                    " lang="eng-us">
                        <h1 id="finance---financial-planning">Finance - Financial Planning</h1>
<time class="metadata" style="text-alstyleign:left"> Guides • Data Integration &amp; ETL • 23/03/2021</time>

<h2 id="overview">Overview</h2>

<p>One of the important activities undertaken by FP&amp;A (Financial Planning and Analysis) departments is to help the company’s Executives, and other Group-level business functions, better manage the company’s profitability, and use of its expected future cashflows.</p>

<p>The department carries out several different activities, including: comparing the company’s actual results to its budgets and forecasts; understanding how profit contributions and profitability of the company’s products and services compare; assessing how cost-efficiencies vary across departments; and working with the company’s Executives and Management to create a longer term forecast (3 to 5 years), that consider a range of both internal and external factors.</p>

<p>One of the most important goals of the department is to predict (i.e. forecast) the company’s future performance, so its Management can make best use of its expected future cash flows – to cover both its short-term (operating) expenses, and larger scale capital investment programmes - that should help the company to continue to grow, stay competitive, and meet its short and long-term strategic objectives (as they have defined by the company’s Leadership).</p>

<p><strong><em>Source:</em></strong>
<em>https://corporatefinanceinstitute.com/resources/careers/jobs/financial-planning-and-analysis-fpa/</em></p>

<p>The following article goes through an example of the kind of financial data that an FP&amp;A department might be work through, and how this data could be turned into a meanningful Financial Report - one that provides a summary of a company’s main P&amp;L Cost lines (over different financial periods), and, separately, some Key Performance Indicators (in this example), on the company’s ‘people cost’ efficiency.</p>

<h2 id="transforming-this-financial-data-from-its-raw-form-to-final-report-involves-several-key-steps">Transforming this financial data from its raw form to final report, involves several key steps:</h2>

<ol>
  <li>Importing the initial financial data from any relevant Financial ERP, into the Query Editor (used for Transforming the data)</li>
  <li>Designing and programming in additional steps to ensure column headings of the table are given the correct ‘Dimension’ names.</li>
  <li>Using a self-referencing table to allow the report preparer to use their own user-defined headings (if needed) for the processed raw data (the FACT table)</li>
  <li>Creating the relevant DIMENSION tables, that go along with the FACT tables.</li>
  <li>Importing both the FACT and DIMENSION tables into a Data Model, so any relevant KPI calculations can also be created</li>
  <li>Designing the appropriate Financial Tables, with information that can help a company better plan for the use of its expected future cashflows.</li>
</ol>

<h2 id="step-1--importing-the-financial-data-into-the-query-editor">Step 1 – Importing the financial data into the Query Editor</h2>

<!-- The Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <div class="modal-header">
      <h4>Finance - Financial Planning</h4>
      <p><span class="close">
×
</span></p>
    </div>
    <div class="modal-body">
      <!-- image inserted with JavaScript -->
    </div>
    <div class="modal-footer"></div>
  </div>
</div>

<p>When you get the Financial data from the relevant ERP system, it might look something like this, with all the ‘Dimensions’ listed at the top for different time periods, and types of categorisations, such as Cost Center, Cost Category, shown on the left:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-1.png');" src="images/financial-planning-1.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<h3 id="query-1-fin-costs---promoted-headers">Query 1 (Fin Costs - Promoted Headers)</h3>

<p>When imported into the Query Editor of MS Excel, the data should then look something like this:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-2.png');" src="images/financial-planning-2.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>If you choose the option to Transpose the data, it will then look something like the below:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-3.png');" src="images/financial-planning-3.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>Next, if you merge all the columns in the data as it stands, from Column 1, horizontally, all the way up to the column just before where the actual amounts start, the data should look something like, in the example below, where the ‘Delimiter’, ‘~^~’ has been used to separate the Column Names from one another.</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-4.png');" src="images/financial-planning-4.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>After transposing the data back again, the data should then look something like this:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-5.png');" src="images/financial-planning-5.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>Then after promoting the headers, the data should be in the following form, with the names actually promoted to the column headings:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-6.png');" src="images/financial-planning-6.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>The query above has been called: <strong>Fin Costs - Promoted Headers</strong>. 
The following <strong>M:Code</strong> has been used:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="

let
    Source = #&quot;Fin Costs -Source&quot;,
    #&quot;Transposed Table&quot; = Table.Transpose(Source),
    #&quot;Merged First 8 Columns&quot; = Table.CombineColumns(Table.TransformColumnTypes(#&quot;Transposed Table&quot;, {{&quot;Column4&quot;, type text}}, &quot;en-GB&quot;),{&quot;Column1&quot;, &quot;Column2&quot;, &quot;Column3&quot;, &quot;Column4&quot;, &quot;Column5&quot;, &quot;Column6&quot;, &quot;Column7&quot;, &quot;Column8&quot;},Combiner.CombineTextByDelimiter(&quot;~^~&quot;, QuoteStyle.None),&quot;Merged&quot;),
    #&quot;Transposed Table1&quot; = Table.Transpose(#&quot;Merged First 8 Columns&quot;),
    #&quot;Promoted Headers&quot; = Table.PromoteHeaders(#&quot;Transposed Table1&quot;, [PromoteAllScalars=true])
in
    #&quot;Promoted Headers&quot;

">
  </button>
</div>
<pre><code class="language-powerquery-m">
let
    Source = #"Fin Costs -Source",
    #"Transposed Table" = Table.Transpose(Source),
    #"Merged First 8 Columns" = Table.CombineColumns(Table.TransformColumnTypes(#"Transposed Table", {{"Column4", type text}}, "en-GB"),{"Column1", "Column2", "Column3", "Column4", "Column5", "Column6", "Column7", "Column8"},Combiner.CombineTextByDelimiter("~^~", QuoteStyle.None),"Merged"),
    #"Transposed Table1" = Table.Transpose(#"Merged First 8 Columns"),
    #"Promoted Headers" = Table.PromoteHeaders(#"Transposed Table1", [PromoteAllScalars=true])
in
    #"Promoted Headers"

</code></pre>

<h2 id="step-2--importing-the-financial-data-into-the-query-editor">Step 2 – Importing the financial data into the Query Editor</h2>

<h3 id="query-2-fin-costs---after-unpivoting">Query 2 (Fin Costs - AFTER Unpivoting)</h3>

<p>The following query Unpivots the data from the earlier query.</p>

<ul>
  <li>The 2nd step to the query counts how many columns of data there are:</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= List.Count(Table.ColumnNames(Source))
">
  </button>
</div>
<pre><code class="language-powerquery-m">= List.Count(Table.ColumnNames(Source))
</code></pre>

<ul>
  <li>Because it is not needed for this particular query, the fifth column from the end, whose column heading has the names of the different ‘Dimension’ field names, can be removed. This can be done as follows:</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.RemoveColumns(Source,{Table.ColumnNames(Source){#&quot;No. of Columns&quot; - 5}})
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.RemoveColumns(Source,{Table.ColumnNames(Source){#"No. of Columns" - 5}})
</code></pre>

<ul>
  <li>The number of columns can then be counted again, using the following type of code:</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= List.Count(Table.ColumnNames(#&quot;Removed Columns&quot;))
">
  </button>
</div>
<pre><code class="language-powerquery-m">= List.Count(Table.ColumnNames(#"Removed Columns"))
</code></pre>

<ul>
  <li>The last 4 columns can then be unpivoted, like shown in the code below. Referencing to the columns by their position, instead of by their names, creates a more much flexible query,</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.Unpivot(#&quot;Removed Columns&quot;, {Table.ColumnNames(#&quot;Removed Columns&quot;){#&quot;No. of Columns 2&quot; - 1}, Table.ColumnNames(#&quot;Removed Columns&quot;){#&quot;No. of Columns 2&quot; - 2}, Table.ColumnNames(#&quot;Removed Columns&quot;){#&quot;No. of Columns 2&quot; - 3}, Table.ColumnNames(#&quot;Removed Columns&quot;){#&quot;No. of Columns 2&quot; - 4}}, &quot;Attribute&quot;, &quot;Value&quot;)
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.Unpivot(#"Removed Columns", {Table.ColumnNames(#"Removed Columns"){#"No. of Columns 2" - 1}, Table.ColumnNames(#"Removed Columns"){#"No. of Columns 2" - 2}, Table.ColumnNames(#"Removed Columns"){#"No. of Columns 2" - 3}, Table.ColumnNames(#"Removed Columns"){#"No. of Columns 2" - 4}}, "Attribute", "Value")
</code></pre>

<ul>
  <li>The data should then look something like this, with the ‘Dimension’ properties (not their names) all shown in one column, called ‘<em>Attribute</em>’:</li>
</ul>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-7.png');" src="images/financial-planning-7.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>The ‘<em>Attribute</em>’ column can then be separated back out into separate columns using the following code:</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.SplitColumn(#&quot;Unpivoted Only Selected Columns&quot;, &quot;Attribute&quot;, Splitter.SplitTextByDelimiter(&quot;~^~&quot;, QuoteStyle.Csv))
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.SplitColumn(#"Unpivoted Only Selected Columns", "Attribute", Splitter.SplitTextByDelimiter("~^~", QuoteStyle.Csv))
</code></pre>

<ul>
  <li>This should result in data that looks like the below (with the ‘<em>Dimension</em>’* properties now shown in separate ‘<em>Attribute</em>’ columns):</li>
</ul>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-8.png');" src="images/financial-planning-8.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>The following ‘M’-Code has been used for this query:</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
let
    Source = #&quot;Fin Costs - Promoted Headers&quot;,
    #&quot;No. of Columns&quot; = List.Count(Table.ColumnNames(Source)),
    #&quot;Removed Columns&quot; = Table.RemoveColumns(Source,{Table.ColumnNames(Source){#&quot;No. of Columns&quot; - 5}}),
    #&quot;No. of Columns 2&quot; = List.Count(Table.ColumnNames(#&quot;Removed Columns&quot;)),
    #&quot;Unpivoted Only Selected Columns&quot; = Table.Unpivot(#&quot;Removed Columns&quot;, {Table.ColumnNames(#&quot;Removed Columns&quot;){#&quot;No. of Columns 2&quot; - 1}, Table.ColumnNames(#&quot;Removed Columns&quot;){#&quot;No. of Columns 2&quot; - 2}, Table.ColumnNames(#&quot;Removed Columns&quot;){#&quot;No. of Columns 2&quot; - 3}, Table.ColumnNames(#&quot;Removed Columns&quot;){#&quot;No. of Columns 2&quot; - 4}}, &quot;Attribute&quot;, &quot;Value&quot;),
    #&quot;Split Column by Delimiter&quot; = Table.SplitColumn(#&quot;Unpivoted Only Selected Columns&quot;, &quot;Attribute&quot;, Splitter.SplitTextByDelimiter(&quot;~^~&quot;, QuoteStyle.Csv))
in
    #&quot;Split Column by Delimiter&quot;
">
  </button>
</div>
<pre><code class="language-powerquery-m">let
    Source = #"Fin Costs - Promoted Headers",
    #"No. of Columns" = List.Count(Table.ColumnNames(Source)),
    #"Removed Columns" = Table.RemoveColumns(Source,{Table.ColumnNames(Source){#"No. of Columns" - 5}}),
    #"No. of Columns 2" = List.Count(Table.ColumnNames(#"Removed Columns")),
    #"Unpivoted Only Selected Columns" = Table.Unpivot(#"Removed Columns", {Table.ColumnNames(#"Removed Columns"){#"No. of Columns 2" - 1}, Table.ColumnNames(#"Removed Columns"){#"No. of Columns 2" - 2}, Table.ColumnNames(#"Removed Columns"){#"No. of Columns 2" - 3}, Table.ColumnNames(#"Removed Columns"){#"No. of Columns 2" - 4}}, "Attribute", "Value"),
    #"Split Column by Delimiter" = Table.SplitColumn(#"Unpivoted Only Selected Columns", "Attribute", Splitter.SplitTextByDelimiter("~^~", QuoteStyle.Csv))
in
    #"Split Column by Delimiter"
</code></pre>

<h3 id="query-3-list-of-attribute-names">Query 3 (List of Attribute Names)</h3>

<p>The following query is used to isolate the names of the columns from the earlier query that have the word ‘<em>Attribute</em>’ in the column heading, This is needed for a later step, when these ‘<em>Attribute</em>’ headings need to be given the correct ‘<em>Dimension</em>’ names.</p>

<p>The sequence of steps on how to do this, is described below.</p>

<ul>
  <li>First, all the Column Names can be listed into one list, using the following code:</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.ColumnNames(#&quot;Fin Costs - AFTER Unpivoting&quot;)
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.ColumnNames(#"Fin Costs - AFTER Unpivoting")
</code></pre>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-9.png');" src="images/financial-planning-9.png" alt="" style="width: 100%; max-width: 45%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>The list can then be converted into a Table, as follows:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error)
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error)
</code></pre>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-10.png');" src="images/financial-planning-10.png" alt="" style="width: 100%; max-width: 40%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>The rows can then be filtered using the following code, to only show those rows, with the word ‘<em>Attribute</em>’</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.SelectRows(#&quot;Converted to Table&quot;, each Text.Contains([Column1], &quot;Attribute&quot;))
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.SelectRows(#"Converted to Table", each Text.Contains([Column1], "Attribute"))
</code></pre>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-11.png');" src="images/financial-planning-11.png" alt="" style="width: 100%; max-width: 40%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>Finally, an INDEX column can be added:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.AddIndexColumn(#&quot;Filtered Rows&quot;, &quot;Index&quot;, 1, 1, Int64.Type)
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.AddIndexColumn(#"Filtered Rows", "Index", 1, 1, Int64.Type)
</code></pre>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-12.png');" src="images/financial-planning-12.png" alt="" style="width: 100%; max-width: 65%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>The following ‘M’-Code has been used for this query:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
let
    Source = Table.ColumnNames(#&quot;Fin Costs - AFTER Unpivoting&quot;),
    #&quot;Converted to Table&quot; = Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error),
    #&quot;Filtered Rows&quot; = Table.SelectRows(#&quot;Converted to Table&quot;, each Text.Contains([Column1], &quot;Attribute&quot;)),
    #&quot;Added Index&quot; = Table.AddIndexColumn(#&quot;Filtered Rows&quot;, &quot;Index&quot;, 1, 1, Int64.Type)
in
    #&quot;Added Index&quot;
">
  </button>
</div>
<pre><code class="language-powerquery-m">let
    Source = Table.ColumnNames(#"Fin Costs - AFTER Unpivoting"),
    #"Converted to Table" = Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error),
    #"Filtered Rows" = Table.SelectRows(#"Converted to Table", each Text.Contains([Column1], "Attribute")),
    #"Added Index" = Table.AddIndexColumn(#"Filtered Rows", "Index", 1, 1, Int64.Type)
in
    #"Added Index"
</code></pre>

<h3 id="query-4-list-of-dimension-names">Query 4 (List of Dimension Names)</h3>

<p>The following query is used to list all the ‘<em>Dimension</em>’ Names, onto separate rows. The sequence of steps that show how to do this are described below:</p>

<ul>
  <li>First, list all the column names from the very first query created that ended with Promoting the column names into the Headers (So, not the second query that Unpivoted the data – as the fifth last column, which held the ‘<em>Dimension</em>’ names was removed)</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.ColumnNames(#&quot;Fin Costs - Promoted Headers&quot;)
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.ColumnNames(#"Fin Costs - Promoted Headers")
</code></pre>

<p>The list should look something like this:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-13.png');" src="images/financial-planning-13.png" alt="" style="width: 100%; max-width: 65%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>Then convert the list into a table, using the following code:</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error)
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error)
</code></pre>

<ul>
  <li>Then filter for the row that has the ‘<em>Dimension</em>’ names in them. Here because, ‘<em>Financial Scearnio</em>’ is very likely to be at least one of the ‘<em>Dimensions</em>’, this is what has been used to filter to the correct row.</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.SelectRows(#”Converted to Table”, each Text.Contains([Column1], “Financial Scenario”))
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.SelectRows(#”Converted to Table”, each Text.Contains([Column1], “Financial Scenario”))
</code></pre>

<p>The data should then show the different ‘Dimension’ names as separate columns:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-14.png');" src="images/financial-planning-14.png" alt="" style="width: 100%; max-width: 40%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>The column can then be split out into its separate columns, using the Delimiter “~^~”, using the following code:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.SplitColumn(#&quot;Filtered Rows&quot;, &quot;Column1&quot;, Splitter.SplitTextByDelimiter(&quot;~^~&quot;, QuoteStyle.Csv))
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.SplitColumn(#"Filtered Rows", "Column1", Splitter.SplitTextByDelimiter("~^~", QuoteStyle.Csv))
</code></pre>

<p>The data should then look something like this:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-15.png');" src="images/financial-planning-15.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>After Transposing the data, and adding an INDEX column, the ‘Dimension’ names should then look as follows:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-16.png');" src="images/financial-planning-16.png" alt="" style="width: 100%; max-width: 60%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>The following ‘M’-Code has been used for this query:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
let
    Source = Table.ColumnNames(#&quot;Fin Costs - Promoted Headers&quot;),
    #&quot;Converted to Table&quot; = Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error),
    #&quot;Filtered Rows&quot; = Table.SelectRows(#&quot;Converted to Table&quot;, each Text.Contains([Column1], &quot;Financial Scenario&quot;)),
    #&quot;Split Column by Delimiter&quot; = Table.SplitColumn(#&quot;Filtered Rows&quot;, &quot;Column1&quot;, Splitter.SplitTextByDelimiter(&quot;~^~&quot;, QuoteStyle.Csv)),
    #&quot;Transposed Table&quot; = Table.Transpose(#&quot;Split Column by Delimiter&quot;),
    #&quot;Added Index&quot; = Table.AddIndexColumn(#&quot;Transposed Table&quot;, &quot;Index&quot;, 1, 1, Int64.Type)
in
    #&quot;Added Index&quot;
">
  </button>
</div>
<pre><code class="language-powerquery-m">let
    Source = Table.ColumnNames(#"Fin Costs - Promoted Headers"),
    #"Converted to Table" = Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error),
    #"Filtered Rows" = Table.SelectRows(#"Converted to Table", each Text.Contains([Column1], "Financial Scenario")),
    #"Split Column by Delimiter" = Table.SplitColumn(#"Filtered Rows", "Column1", Splitter.SplitTextByDelimiter("~^~", QuoteStyle.Csv)),
    #"Transposed Table" = Table.Transpose(#"Split Column by Delimiter"),
    #"Added Index" = Table.AddIndexColumn(#"Transposed Table", "Index", 1, 1, Int64.Type)
in
    #"Added Index"
</code></pre>

<div class="alert alert-danger alerts-font" role="alert">
  <p><i class="fa fa-exclamation-circle"></i> <b>Warning: </b>
<br />
There may be an upper limit to the column name fields in Power Query.
This may be upto 1020 characters. So please check that the Query works fully for you first.</p>

</div>

<h3 id="query-5-mapping-of-attributes-to-dimensions">Query 5 (Mapping of Attributes to Dimensions)</h3>

<p>The query creates a small mapping table that can be used to rename the column headings, from the earlier Unpivoted Dataset.</p>

<ul>
  <li>The query first references back to the step that showed the ‘list of attributes’</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= #&quot;List of Attribute Names&quot;
">
  </button>
</div>
<pre><code class="language-powerquery-m">= #"List of Attribute Names"
</code></pre>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-17.png');" src="images/financial-planning-17.png" alt="" style="width: 100%; max-width: 60%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>This is then merged with the ‘list of dimensions’ created earlier through the INDEX column</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.NestedJoin(Source, {&quot;Index&quot;}, #&quot;List of Dimension Names&quot;, {&quot;Index&quot;}, &quot;List of Dimension Names&quot;, JoinKind.LeftOuter)
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.NestedJoin(Source, {"Index"}, #"List of Dimension Names", {"Index"}, "List of Dimension Names", JoinKind.LeftOuter)
</code></pre>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-18.png');" src="images/financial-planning-18.png" alt="" style="width: 100%; max-width: 85%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>The Index column itself can then be removed after the merge, as it is no longer needed</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.RemoveColumns(#&quot;Expanded List of Dimension Names&quot;,{&quot;Index&quot;})
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.RemoveColumns(#"Expanded List of Dimension Names",{"Index"})
</code></pre>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-19.png');" src="images/financial-planning-19.png" alt="" style="width: 100%; max-width: 60%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>The data can then be transposed</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.Transpose(#&quot;Removed Columns&quot;)
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.Transpose(#"Removed Columns")
</code></pre>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-20.png');" src="images/financial-planning-20.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>Then finally, a list of lists created</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.ToColumns(#&quot;Transposed Table&quot;)
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.ToColumns(#"Transposed Table")
</code></pre>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-21.png');" src="images/financial-planning-21.png" alt="" style="width: 100%; max-width: 25%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>The M: Code for this query can be found here:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
let
    Source = #&quot;List of Attribute Names&quot;,
    #&quot;Merged Queries&quot; = Table.NestedJoin(Source, {&quot;Index&quot;}, #&quot;List of Dimension Names&quot;, {&quot;Index&quot;}, &quot;List of Dimension Names&quot;, JoinKind.LeftOuter),
    #&quot;Expanded List of Dimension Names&quot; = Table.ExpandTableColumn(#&quot;Merged Queries&quot;, &quot;List of Dimension Names&quot;, {&quot;Column1&quot;}, {&quot;Column1.1&quot;}),
    #&quot;Removed Columns&quot; = Table.RemoveColumns(#&quot;Expanded List of Dimension Names&quot;,{&quot;Index&quot;}),
    #&quot;Transposed Table&quot; = Table.Transpose(#&quot;Removed Columns&quot;),
    #&quot;List of Lists&quot; = Table.ToColumns(#&quot;Transposed Table&quot;)
in
    #&quot;List of Lists&quot;
">
  </button>
</div>
<pre><code class="language-powerquery-m">let
    Source = #"List of Attribute Names",
    #"Merged Queries" = Table.NestedJoin(Source, {"Index"}, #"List of Dimension Names", {"Index"}, "List of Dimension Names", JoinKind.LeftOuter),
    #"Expanded List of Dimension Names" = Table.ExpandTableColumn(#"Merged Queries", "List of Dimension Names", {"Column1"}, {"Column1.1"}),
    #"Removed Columns" = Table.RemoveColumns(#"Expanded List of Dimension Names",{"Index"}),
    #"Transposed Table" = Table.Transpose(#"Removed Columns"),
    #"List of Lists" = Table.ToColumns(#"Transposed Table")
in
    #"List of Lists"
</code></pre>

<h3 id="query-6-fin-costs---after-attr-renaming">Query 6 (Fin Costs - AFTER ATTR Renaming)</h3>

<p>This query uses the mapping table created earlier, to give the column headers in the query: ‘<strong>Fin Costs – AFTER Unpivoting</strong>’ the correct ‘<em>Dimension</em>’ names</p>

<ul>
  <li>The query first references back to the query with the unpivoted data, as shown below:</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= #&quot;Fin Costs - AFTER Unpivoting&quot;
">
  </button>
</div>
<pre><code class="language-powerquery-m">= #"Fin Costs - AFTER Unpivoting"
</code></pre>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-22.png');" src="images/financial-planning-22.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>The following step then uses the information in the Mapping table, to give each column the correct name:</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.RenameColumns(Source, #&quot;Mapping of Attribute to Dimensions&quot;)
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.RenameColumns(Source, #"Mapping of Attribute to Dimensions")
</code></pre>

<p>The resulting query is shown below:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-23.png');" src="images/financial-planning-23.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
let
    Source = #&quot;Fin Costs - AFTER Unpivoting&quot;,
    Custom1 = Table.RenameColumns(Source, #&quot;Mapping of Attribute to Dimensions&quot;)
in
    Custom1
">
  </button>
</div>
<pre><code class="language-powerquery-m">let
    Source = #"Fin Costs - AFTER Unpivoting",
    Custom1 = Table.RenameColumns(Source, #"Mapping of Attribute to Dimensions")
in
    Custom1
</code></pre>

<h2 id="step-3--importing-the-financial-data-into-the-query-editor">Step 3 – Importing the financial data into the Query Editor</h2>

<h3 id="query-7-list-of-columns-with-dms-names">Query 7 (List of Columns with DMS Names)</h3>

<p>This and the next two queries are created in case the preparer of the report wants to user their own ‘User-defined’ versions of the ‘Dimension’ Names.</p>

<ul>
  <li>This shows a list of the column names, from the query, after the columns had been given their correct ‘Dimension’ names.</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.ColumnNames(#&quot;Fin Costs - AFTER ATTR Renaming&quot;)
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.ColumnNames(#"Fin Costs - AFTER ATTR Renaming")
</code></pre>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-24.png');" src="images/financial-planning-24.png" alt="" style="width: 100%; max-width: 50%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>The list can then be converted into a Table, like in the one shown below:</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error)
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error)
</code></pre>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-25.png');" src="images/financial-planning-25.png" alt="" style="width: 100%; max-width: 50%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>The table column can then be given the appropriate column name. Below we have changed the text ‘Column1’ to ‘Column Headings’</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="

= Table.RenameColumns(#&quot;Converted to Table&quot;,{{&quot;Column1&quot;, &quot;Column Headings&quot;}})

">
  </button>
</div>
<pre><code class="language-powerquery-m">
= Table.RenameColumns(#"Converted to Table",{{"Column1", "Column Headings"}})

</code></pre>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-26.png');" src="images/financial-planning-26.png" alt="" style="width: 100%; max-width: 50%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>At this step in the Query, the query can then be exported out back into an MS Excel worksheet. When it is, the table should look something like this:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-27.png');" src="images/financial-planning-27.png" alt="" style="width: 100%; max-width: 50%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>A column can then be added adjacent to it, and the user defined columns then given the desired names.</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-28.png');" src="images/financial-planning-28.png" alt="" style="width: 100%; max-width: 80%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>At this point, the table, with both columns can then be re-imported into the Query Editor, as a new Query (this is separate to Query 7 which was the Query that exported the Table back out into MS Excel), like shown below:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-29.png');" src="images/financial-planning-29.png" alt="" style="width: 100%; max-width: 100%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>The Table in this query then needs to be logically linked back to the earlier step in Query 7, where the column Name had been renamed to ‘Column Headings’, like shown below:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-30.png');" src="images/financial-planning-30.png" alt="" style="width: 100%; max-width: 80%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>The user defined column names can then be merged back to the correct row, based on the text descriptions in the column, ‘Column Headings’</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-31.png');" src="images/financial-planning-31.png" alt="" style="width: 100%; max-width: 80%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>The following M:Code has been used for this Query:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="

let
    Source = Table.ColumnNames(#&quot;Fin Costs - AFTER ATTR Renaming&quot;),
    #&quot;Converted to Table&quot; = Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error),
    #&quot;Renamed Columns&quot; = Table.RenameColumns(#&quot;Converted to Table&quot;,{{&quot;Column1&quot;, &quot;Column Headings&quot;}}),
    #&quot;Merged Queries&quot; = Table.NestedJoin(#&quot;Renamed Columns&quot;, {&quot;Column Headings&quot;}, #&quot;List of Columns with FTXT Names&quot;, {&quot;Column Headings&quot;}, &quot;List of Columns with FTXT Names&quot;, JoinKind.LeftOuter),
    #&quot;Expanded List of Columns with FTXT Names&quot; = Table.ExpandTableColumn(#&quot;Merged Queries&quot;, &quot;List of Columns with FTXT Names&quot;, {&quot;User Defined Headings&quot;}, {&quot;User Defined Headings&quot;})
in
    #&quot;Expanded List of Columns with FTXT Names&quot;

">
  </button>
</div>
<pre><code class="language-powerquery-m">
let
    Source = Table.ColumnNames(#"Fin Costs - AFTER ATTR Renaming"),
    #"Converted to Table" = Table.FromList(Source, Splitter.SplitByNothing(), null, null, ExtraValues.Error),
    #"Renamed Columns" = Table.RenameColumns(#"Converted to Table",{{"Column1", "Column Headings"}}),
    #"Merged Queries" = Table.NestedJoin(#"Renamed Columns", {"Column Headings"}, #"List of Columns with FTXT Names", {"Column Headings"}, "List of Columns with FTXT Names", JoinKind.LeftOuter),
    #"Expanded List of Columns with FTXT Names" = Table.ExpandTableColumn(#"Merged Queries", "List of Columns with FTXT Names", {"User Defined Headings"}, {"User Defined Headings"})
in
    #"Expanded List of Columns with FTXT Names"

</code></pre>

<h3 id="query-8-list-of-columns-with-ftxt-names">Query 8 (List of Columns with FTXT Names)</h3>

<p>See the earlier Query, Query 7</p>

<h3 id="query-9-mapping-of-dms-names-to-ftxt-names">Query 9 (Mapping of DMS Names to FTXT Names)</h3>

<p>This query creates a small mapping table that can be used to rename the columns of data from the original ‘Dimension’ names, to the ‘User-defined’ names.</p>

<ul>
  <li>It first references back to last step of Query 7</li>
</ul>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-32.png');" src="images/financial-planning-32.png" alt="" style="width: 100%; max-width: 80%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>A conditional column has then been added to show what the final names to all the Column Headings should be:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-33.png');" src="images/financial-planning-33.png" alt="" style="width: 100%; max-width: 100%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>The middle column can then be removed, and remaining two columns transposed, so the data looks like this:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-34.png');" src="images/financial-planning-34.png" alt="" style="width: 100%; max-width: 100%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>And finally, these columns can be converted into a list of lists, using the <em>Table.ToColumns</em> function – that will be used to do the final renamings</li>
</ul>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
= Table.ToColumns(#&quot;Transposed Table&quot;)
">
  </button>
</div>
<pre><code class="language-powerquery-m">= Table.ToColumns(#"Transposed Table")
</code></pre>

<p>The final M-Code to this query can be found here:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
let
    Source = #&quot;List of Columns with FTXT Names&quot;,
    #&quot;Added Conditional Column&quot; = Table.AddColumn(Source, &quot;Custom&quot;, each if [User Defined Headings] = null then [Column Headings] else [User Defined Headings]),
    #&quot;Removed Columns&quot; = Table.RemoveColumns(#&quot;Added Conditional Column&quot;,{&quot;User Defined Headings&quot;}),
    #&quot;Transposed Table&quot; = Table.Transpose(#&quot;Removed Columns&quot;),
    #&quot;List of Lists&quot; = Table.ToColumns(#&quot;Transposed Table&quot;)
in
    #&quot;List of Lists&quot;
">
  </button>
</div>
<pre><code class="language-powerquery-m">let
    Source = #"List of Columns with FTXT Names",
    #"Added Conditional Column" = Table.AddColumn(Source, "Custom", each if [User Defined Headings] = null then [Column Headings] else [User Defined Headings]),
    #"Removed Columns" = Table.RemoveColumns(#"Added Conditional Column",{"User Defined Headings"}),
    #"Transposed Table" = Table.Transpose(#"Removed Columns"),
    #"List of Lists" = Table.ToColumns(#"Transposed Table")
in
    #"List of Lists"
</code></pre>

<h3 id="query-10-fin-costs---after-ftxt-renaming">Query 10 (Fin Costs - AFTER FTXT Renaming)</h3>

<ul>
  <li>This query references back to the query that renamed the columns that had the text ‘Attribute’ in them, and which then gave them the correct ‘Dimension’ name</li>
</ul>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-35.png');" src="images/financial-planning-35.png" alt="" style="width: 100%; max-width: 100%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<ul>
  <li>It then overwrites the column headings for any user-defined names, using the ‘DMS to FTXT’ mapping table, created earlier</li>
</ul>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-36.png');" src="images/financial-planning-36.png" alt="" style="width: 100%; max-width: 100%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>The final M-Code to this Query can be found here:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="

let
    Source = Excel.CurrentWorkbook(){[Name=&quot;HR_HeadCount___AFTER_FTXT_Renaming&quot;]}[Content],
    #&quot;Set Data Type to HeadCount&quot; = Table.TransformColumnTypes(Source,{{Table.ColumnNames(Source){List.Count(Table.ColumnNames(Source))-1}, type number}})
in
    #&quot;Set Data Type to HeadCount&quot;

">
  </button>
</div>
<pre><code class="language-powerquery-m">
let
    Source = Excel.CurrentWorkbook(){[Name="HR_HeadCount___AFTER_FTXT_Renaming"]}[Content],
    #"Set Data Type to HeadCount" = Table.TransformColumnTypes(Source,{{Table.ColumnNames(Source){List.Count(Table.ColumnNames(Source))-1}, type number}})
in
    #"Set Data Type to HeadCount"

</code></pre>

<h3 id="final-fact-table">Final FACT Table</h3>

<p>The final transformed Dataset when loaded back to a worksheet in MS Excel, should then be in the following form, which can be more easily examined, and from which insights can be more easily drawn.</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-37.png');" src="images/financial-planning-37.png" alt="" style="width: 100%; max-width: 100%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<h2 id="step-4--creating-the-relevant-dimension-tables">Step 4 – Creating the relevant Dimension Tables</h2>

<p>For the Data Model needed to show the required Financial Information, in addition to the FACT table just created, the DIMENSION tables also need to be created – in this case, a Dimension table that shows a list of all ‘Cost Centers’, and another Dimension table that shows a list of all ‘Financial Quarters’</p>

<h3 id="list-of-all-cost-centers">List of all Cost Centers</h3>

<p>This can be created by referencing to the earlier FACT table, like shown below:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-38.png');" src="images/financial-planning-38.png" alt="" style="width: 100%; max-width: 100%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>To this you might have similar data from other FACT tables, showing things such as numbers of actual Staff, i.e. HeadCounts, like the example FACT table shown below:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-39.png');" src="images/financial-planning-39.png" alt="" style="width: 100%; max-width: 100%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>Appending various FACT tables together ensures that the list of ‘Cost Centers’ is a complete list, and not just those from one particular FACT table.</p>

<p>After the two FACT tables have been appended (the one on Financial Costs, and the other on HeadCounts), the ‘Cost Center’ column can then be isolated, like shown below:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-40.png');" src="images/financial-planning-40.png" alt="" style="width: 100%; max-width: 40%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>Duplicates can then be removed:</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-41.png');" src="images/financial-planning-41.png" alt="" style="width: 100%; max-width: 40%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<p>This can then be exported back out into a worksheet in MS Excel.</p>

<h3 id="list-of-all-quarters">List of all Quarters</h3>

<p>For creating a list of Quarters, a separate query does not have to be created, as these can just be defined by the user, directly as a separate table in an Excel worksheet, that lists all the Financial Quarters in the year, like the one shown below. (Also shown are the list of Cost Centers from the query that was created earlier).</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-42.png');" src="images/financial-planning-42.png" alt="" style="width: 100%; max-width: 60%" />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<h2 id="step-5--fact-and-dimension-tables-into-the-data-model">Step 5 – FACT and DIMENSION tables into the DATA MODEL</h2>

<p>After the FACT, and DIMENSION tables have been created, these can then be imported into the DATA MODEL, so the relevant KPI calculations can then be created. The picture below shows what this Data Model could look like, along with how the Data fields connect from the DIMENSION tables to the two main FACT tables</p>

<h3 id="diagram-of-data-model">Diagram of Data Model</h3>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-43.png');" src="images/financial-planning-43.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<h3 id="kpi-measures">KPI Measures</h3>

<p>Three measures have also been created to show, example KPI measures, such as:</p>
<ul>
  <li>Total People Costs (e.g. Salaries, Pensions, Tax Payments, Bonuses, etc.)</li>
  <li>Total Head Count (e.g. Full Time, Part Time, Intern, etc.)</li>
  <li>People Costs / Head Count (an example of a cost-efficiency ratio)</li>
</ul>

<p>The DAX formulas used to create these measures are shown below:</p>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Total People Costs :=
CALCULATE (
    SUM ( &#39;Fin Costs - AFTER FTXT Renaming&#39;[Amount] ),
    &#39;Fin Costs - AFTER FTXT Renaming&#39;[Cost Category 2] = &quot;People Costs&quot;
)
">
  </button>
</div>
<pre><code class="language-powerquery-m">Total People Costs :=
CALCULATE (
    SUM ( 'Fin Costs - AFTER FTXT Renaming'[Amount] ),
    'Fin Costs - AFTER FTXT Renaming'[Cost Category 2] = "People Costs"
)
</code></pre>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
Total HeadCount :=
VAR HeadCount =
    CALCULATE ( SUM ( &#39;Head Count - AFTER FTXT Renaming&#39;[HeadCount] ) )
RETURN
    IF (
        ISFILTERED ( List_of_Financial_Quarters[Financial Quarter] ),
        HeadCount,
        AVERAGEX (
            ADDCOLUMNS (
                GROUPBY (
                    &#39;Head Count - AFTER FTXT Renaming&#39;,
                    List_of_Financial_Quarters[Financial Quarter]
                ),
                &quot;HeadCount&quot;, CALCULATE ( SUM ( &#39;Head Count - AFTER FTXT Renaming&#39;[HeadCount] ) )
            ),
            [HeadCount]
        )
    )
">
  </button>
</div>
<pre><code class="language-powerquery-m">Total HeadCount :=
VAR HeadCount =
    CALCULATE ( SUM ( 'Head Count - AFTER FTXT Renaming'[HeadCount] ) )
RETURN
    IF (
        ISFILTERED ( List_of_Financial_Quarters[Financial Quarter] ),
        HeadCount,
        AVERAGEX (
            ADDCOLUMNS (
                GROUPBY (
                    'Head Count - AFTER FTXT Renaming',
                    List_of_Financial_Quarters[Financial Quarter]
                ),
                "HeadCount", CALCULATE ( SUM ( 'Head Count - AFTER FTXT Renaming'[HeadCount] ) )
            ),
            [HeadCount]
        )
    )
</code></pre>

<div class="copy-code-container">
  <span class="language-name" aria-label="Language name: M-Code">M-Code</span>
  <button class="copy-code-button" aria-label="Copy code block to your clipboard" data-code="
People Cost per HeadCount:=DIVIDE([Total People Costs], [Total HeadCount], 0)
">
  </button>
</div>
<pre><code class="language-powerquery-m">People Cost per HeadCount:=DIVIDE([Total People Costs], [Total HeadCount], 0)
</code></pre>

<h2 id="step-6--creating-the-appropriate-financial-planning-tables-in-an-excel-worksheet">Step 6 – Creating the appropriate Financial Planning Tables in an Excel Worksheet</h2>

<p>Once the Data Model has been created to connect all the FACT and DIMENSION tables, and create the relevant Key Performance Indicators, a Financial Planning Report like the one shown below can then be created, one that shows an aggregated view of the P&amp;L (the relevant Financial Cost Lines), filterable for different Cost Centers, or specific Quarters.</p>

<div class="img-wrap">
  <figure>
    
        <img class="docimage" onclick="showImage('financial-planning-44.png');" src="images/financial-planning-44.png" alt="" style="width: 100%; max-width: " />
    

    
    <figcaption style="text-align: center; color: #5e5e5e; font-size: 0.9rem;">
        <i></i>
    </figcaption>
    
</figure>
  <div class="img-hover-description-layer">
    <p class="img-hover-description">Click to view large-sized image</p>
  </div>
</div>

<h3 id="further-ideas">Further Ideas</h3>

<p>One possible improvement to this Report might be to also show Financial Costs, at an aggregated view, by Business Areas (instead of just by the categories: Fixed, Variable, and Other Costs). A more meaningful categorisation could be obtained from the listed <em>Supporting</em> and/or <em>Primary</em> activities shown in <strong>Porter’s Value Chain</strong> (a popular Business Framework that shows the various subsystems an organisation uses to create a product or service).</p>

<p>This would give a clearer, and more detailed view of how Financial Costs compare across departments (e.g. by Marketing, Product Development, Finance, Technology Development, In Bound Logistics, Procurement and so on), and hopefully a better understanding to Executives of how well different areas of the business are performing.</p>

<h3 id="file-to-download">File to Download</h3>

<p>The full file just described in this article can be found here: <a href="https://1drv.ms/x/s!Ahu8OSSAtOMzmGIMoUsIJm6xHPqJ?e=nHxmCf">Finance - Financial Planning</a></p>


                        
                            <div id="mainNavBottom">
    <a class="no_icon" href="">
        <span id="previousPage" class="">
            <span class="iconify medium" data-icon="ic-sharp-arrow-back" data-inline="false"></span>
        </span>
    </a>
    <a class="no_icon" href="">
        <span id="nextPage" class="">
            <span class="iconify medium" data-icon="ic-sharp-arrow-forward" data-inline="false"></span>					
        </span>
    </a>
</div>
                        
                    </main>	
                    
                        <!-- Start of Feedback section -->
<section class="feedback-section is-relative">
    <h2 id="feedback" class="is-size-2 has-margin-top-large has-padding-top-medium"> Feedback </h2>
    <div class="feedback has-margin-top-small has-margin-bottom-none">
        <p id="send-feedback-about" class="has-margin-top-none has-margin-bottom-none">
            Submit and view feedback
        </p>
        <div id="feedback-section-link" class="has-margin-top-large has-margin-bottom-none">
            <a class="button has-margin-bottom-small" href="" target="_blank">
                <span class="icon">
                    <span class=github>
                        <i class="fab fa-github"></i>
                    </span>
                </span>
                <span>This page</span>
            </a>
        </div>
    </div>
    <div id="viewallfeedback-section-link" class="is-flex has-flex-justify-content-end has-margin-top-small has-margin-bottom-medium">
        <a class="view-on-github" href="" target="_blank">
            <span class="icon">
                <span class=github>
                    <i class="fab fa-github"></i>
                </span>
            </span><span>View all page feedback</span>
        </a>
    </div>
</section>

<!-- End of Feedback section -->
                    
                </div>

                
                 <!-- Right Hand Side Toc-->
                 <div class="right-sidebar column is-one-quarter is-one-fifth-desktop is-hidden-mobile is-hidden-tablet-only">
                    <nav class="doc-outline is-fixed is-vertically-scrollable", id="affixed-right-sidebar">
                        <nav id="side-doc-outline">
                            <header id="side-doc-title" class = "is-flex is-flex-row">
                                <div>
                                    <a href="#top">
                                        <h3 title="Go to Top of Page">
                                            <i class="fas fa-file-alt" style="color:#e82127;">&nbsp;</i>
                                            In this article
                                        </h3>
                                    </a>
                                </div>
                            </header>
                            <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#overview">Overview</a></li>
<li class="toc-entry toc-h2"><a href="#transforming-this-financial-data-from-its-raw-form-to-final-report-involves-several-key-steps">Transforming this financial data from its raw form to final report, involves several key steps:</a></li>
<li class="toc-entry toc-h2"><a href="#step-1--importing-the-financial-data-into-the-query-editor">Step 1 – Importing the financial data into the Query Editor</a>
<ul>
<li class="toc-entry toc-h3"><a href="#query-1-fin-costs---promoted-headers">Query 1 (Fin Costs - Promoted Headers)</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#step-2--importing-the-financial-data-into-the-query-editor">Step 2 – Importing the financial data into the Query Editor</a>
<ul>
<li class="toc-entry toc-h3"><a href="#query-2-fin-costs---after-unpivoting">Query 2 (Fin Costs - AFTER Unpivoting)</a></li>
<li class="toc-entry toc-h3"><a href="#query-3-list-of-attribute-names">Query 3 (List of Attribute Names)</a></li>
<li class="toc-entry toc-h3"><a href="#query-4-list-of-dimension-names">Query 4 (List of Dimension Names)</a></li>
<li class="toc-entry toc-h3"><a href="#query-5-mapping-of-attributes-to-dimensions">Query 5 (Mapping of Attributes to Dimensions)</a></li>
<li class="toc-entry toc-h3"><a href="#query-6-fin-costs---after-attr-renaming">Query 6 (Fin Costs - AFTER ATTR Renaming)</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#step-3--importing-the-financial-data-into-the-query-editor">Step 3 – Importing the financial data into the Query Editor</a>
<ul>
<li class="toc-entry toc-h3"><a href="#query-7-list-of-columns-with-dms-names">Query 7 (List of Columns with DMS Names)</a></li>
<li class="toc-entry toc-h3"><a href="#query-8-list-of-columns-with-ftxt-names">Query 8 (List of Columns with FTXT Names)</a></li>
<li class="toc-entry toc-h3"><a href="#query-9-mapping-of-dms-names-to-ftxt-names">Query 9 (Mapping of DMS Names to FTXT Names)</a></li>
<li class="toc-entry toc-h3"><a href="#query-10-fin-costs---after-ftxt-renaming">Query 10 (Fin Costs - AFTER FTXT Renaming)</a></li>
<li class="toc-entry toc-h3"><a href="#final-fact-table">Final FACT Table</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#step-4--creating-the-relevant-dimension-tables">Step 4 – Creating the relevant Dimension Tables</a>
<ul>
<li class="toc-entry toc-h3"><a href="#list-of-all-cost-centers">List of all Cost Centers</a></li>
<li class="toc-entry toc-h3"><a href="#list-of-all-quarters">List of all Quarters</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#step-5--fact-and-dimension-tables-into-the-data-model">Step 5 – FACT and DIMENSION tables into the DATA MODEL</a>
<ul>
<li class="toc-entry toc-h3"><a href="#diagram-of-data-model">Diagram of Data Model</a></li>
<li class="toc-entry toc-h3"><a href="#kpi-measures">KPI Measures</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#step-6--creating-the-appropriate-financial-planning-tables-in-an-excel-worksheet">Step 6 – Creating the appropriate Financial Planning Tables in an Excel Worksheet</a>
<ul>
<li class="toc-entry toc-h3"><a href="#further-ideas">Further Ideas</a></li>
<li class="toc-entry toc-h3"><a href="#file-to-download">File to Download</a></li>
</ul>
</li>
</ul>
                        </nav>

                        <!-- Fixed Element-->
                        <div>
                            <a class="top-link hide" href="" id="js-top" title="Go to Top of Page">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6"><path d="M12 6H0l6-6z"/></svg>
                            </a>
                        </div>
                    </nav>
                </div>
                
            </div>
            <!-- end of /.columns -->
        </div>	
        <!-- end of /primary holder -->

    </div>
    <!-- end of /.columns -->
</div>
<!-- end of /.mainContainer -->
			<!-- Footer Container --> 
<div class="footerContainer">

    
    

    <footer id="footer" class=" footer-layout   uhf-container has-padding">
        <div class="">
            <a href="https://startech-enterprises.github.io/docs/">
                <img src="/../docs/assets/images/starbase_logo.png" class="footer-bar-logo">
            </a>
        </div>
        <div class="is-flex is-full-height has-padding-right-extra-large-desktop has-padding-left-extra-large-desktop">
            <a class="locale-selector-link has-flex-shrink-none" href="/../">
                <span class="icon">
                    <span><i class="fas fa-globe"></i></span>
                </span>
                <span class="locale-selector-link-text">English (United Kingdom)</span>
            </a>
        </div>
        <ul class="links">
            <li>
                <a href="/docs/">Docs</a>
            </li>
            <li>
                <a href="/docs/">Guides</a>
            </li>
            <li>
                <a href="/docs/articles-and-blogs/article-search.html">Articles & Blogs</a>
            </li>
            <li>
                <a href="/docs/videos/">Videos</a>
            </li>
            <li>
                <a href="/docs/about/about.html">About</a>
            </li>
            <li>
                <a href="https://www.linkedin.com/company/startech-enterprises/" target="_blank">LinkedIn</a>
            </li>
            <li style="color: #e82127;">
                <span class="icon">
                    <span> <i class="fas fa-star"></i></span>
                </span>Star Base 2020
            </li>
        </ul>
    </footer>
</div>
<!-- end of / footerContainer -->
	</body>
		<!-- Reference to main JavaScript Files -->
<script src="/../docs/assets/js/library.js" type="application/javascript"></script>
<script src="/../docs/assets/js/breadCrumb.js" type="application/javascript"></script>
<script src="/../docs/assets/js/navbar.js" type="application/javascript"></script>
<script src="/../docs/assets/js/affix.js" type="application/javascript"></script>
<script src="/../docs/assets/js/rhsToc.js" type="application/javascript"></script>


    <script src="/../docs/assets/js/lhsTree.js" type="application/javascript"></script>
    <script src="/../docs/assets/js/searchFilter.js" type="application/javascript"></script>


<script src="/../docs/assets/js/scrollTop.js" type="application/javascript"></script>
<script src="/../docs/assets/js/gitFeedback.js" type="application/javascript"></script>
<script src="/../docs/assets/js/copyCode.js" type="application/javascript"></script>
</html>
